165  [main] INFO  kkm.UnitTests - Starting test: KKM_makeCheckNoCashier()
3069 [main] INFO  kkm.UnitTests - End test

3079 [main] INFO  kkm.UnitTests - Starting test: KKM_SendMessageEmail()
278852 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/esb-test-2020.07.24/_search?q=%20message:%20%22CID=3a70d527-e88c-405c-9ae4-6b66b6dc64e311%22%20
278920 [main] INFO  kkm.UnitTests - Response message : {"took":3,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":8,"relation":"eq"},"max_score":39.4247,"hits":[{"_index":"esb-test-2020.07.24","_type":"_doc","_id":"9zl_f3MBtD96ebe8B1vz","_score":39.4247,"_source":{"level":"trace","@timestamp":"2020-07-24T06:24:37.789Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST response Operation 'SendMessage' was complete with body: ReceiptResponse{correlationId='null', checkId='fca9d9c0-a68e-4e92-a710-25e9acb2c073', error=null} | exid=ID-esb-test01-34476-1595563114155-71-1737 CID=3a70d527-e88c-405c-9ae4-6b66b6dc64e311","thread":"qtp1688034375-14939","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38101","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-24T09:24:37,789","input":{"type":"log"},"offset":6206078,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.24","_type":"_doc","_id":"ljl-f3MBtD96ebe8zC7v","_score":39.255424,"_source":{"level":"trace","@timestamp":"2020-07-24T06:24:37.766Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST request  Operation 'SendMessage' was call with body: SendMessageRequest{checkId='fca9d9c0-a68e-4e92-a710-25e9acb2c073', messageType='email', messageAddress='EPolikarpova@VSK.RU'} | exid=ID-esb-test01-34476-1595563114155-71-1737 CID=3a70d527-e88c-405c-9ae4-6b66b6dc64e311","thread":"qtp1688034375-14939","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38101","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-24T09:24:37,766","input":{"type":"log"},"offset":6201732,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.24","_type":"_doc","_id":"lTl-f3MBtD96ebe8zC7v","_score":37.485004,"_source":{"level":"debug","@timestamp":"2020-07-24T06:24:37.765Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST request  Operation 'SendMessage' was call with headers: {breadcrumbId=ID-esb-test01-34476-1595563114155-71-1736, JMSCorrelationID=3a70d527-e88c-405c-9ae4-6b66b6dc64e311, operationName=SendMessage, X-VSK-CorrelationId=3a70d527-e88c-405c-9ae4-6b66b6dc64e311} | exid=ID-esb-test01-34476-1595563114155-71-1737 CID=3a70d527-e88c-405c-9ae4-6b66b6dc64e311","thread":"qtp1688034375-14939","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38101","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-24T09:24:37,765","input":{"type":"log"},"offset":6201254,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.24","_type":"_doc","_id":"lzl-f3MBtD96ebe8zC7v","_score":34.908733,"_source":{"level":"debug","@timestamp":"2020-07-24T06:24:37.767Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'SendMessage' calling REST service  with headers: {breadcrumbId=ID-esb-test01-34476-1595563114155-71-1736, CamelHttpMethod=GET, JMSCorrelationID=3a70d527-e88c-405c-9ae4-6b66b6dc64e311, operationName=SendMessage, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/fca9d9c0-a68e-4e92-a710-25e9acb2c073/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=3a70d527-e88c-405c-9ae4-6b66b6dc64e311} | exId=ID-esb-test01-34476-1595563114155-71-1739 CID=3a70d527-e88c-405c-9ae4-6b66b6dc64e311","thread":"thread #4094 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38101","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-24T09:24:37,767","input":{"type":"log"},"offset":6202132,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.24","_type":"_doc","_id":"mDl-f3MBtD96ebe8zC7v","_score":34.908733,"_source":{"level":"trace","@timestamp":"2020-07-24T06:24:37.767Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'SendMessage' calling REST service  with headers: {breadcrumbId=ID-esb-test01-34476-1595563114155-71-1736, CamelHttpMethod=GET, JMSCorrelationID=3a70d527-e88c-405c-9ae4-6b66b6dc64e311, operationName=SendMessage, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/fca9d9c0-a68e-4e92-a710-25e9acb2c073/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=3a70d527-e88c-405c-9ae4-6b66b6dc64e311} | exId=ID-esb-test01-34476-1595563114155-71-1739 CID=3a70d527-e88c-405c-9ae4-6b66b6dc64e311 |\n ","thread":"thread #4094 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38101","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"},"flags":["multiline"]},"@version":"1","environment":"test","timestamp":"2020-07-24T09:24:37,767","input":{"type":"log"},"offset":6202763,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.24","_type":"_doc","_id":"mTl-f3MBtD96ebe8zS4F","_score":31.107876,"_source":{"level":"debug","@timestamp":"2020-07-24T06:24:37.788Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'SendMessage' service responded with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-34476-1595563114155-71-1736, CamelHttpMethod=GET, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Disposition=inline;filename=f.txt, Content-Type=application/json;charset=utf-8, Date=Fri, 24 Jul 2020 06:24:37 GMT, JMSCorrelationID=3a70d527-e88c-405c-9ae4-6b66b6dc64e311, operationName=SendMessage, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/fca9d9c0-a68e-4e92-a710-25e9acb2c073/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=3a70d527-e88c-405c-9ae4-6b66b6dc64e311} | exid=ID-esb-test01-34476-1595563114155-71-1739 CID=3a70d527-e88c-405c-9ae4-6b66b6dc64e311","thread":"thread #4094 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38101","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-24T09:24:37,788","input":{"type":"log"},"offset":6203398,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.24","_type":"_doc","_id":"mzl-f3MBtD96ebe8zS4F","_score":31.107876,"_source":{"level":"debug","@timestamp":"2020-07-24T06:24:37.788Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST response Operation 'SendMessage' was complete with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-34476-1595563114155-71-1736, CamelHttpMethod=GET, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Disposition=inline;filename=f.txt, Content-Type=application/json;charset=utf-8, Date=Fri, 24 Jul 2020 06:24:37 GMT, JMSCorrelationID=3a70d527-e88c-405c-9ae4-6b66b6dc64e311, operationName=SendMessage, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/fca9d9c0-a68e-4e92-a710-25e9acb2c073/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=3a70d527-e88c-405c-9ae4-6b66b6dc64e311} | exid=ID-esb-test01-34476-1595563114155-71-1737 CID=3a70d527-e88c-405c-9ae4-6b66b6dc64e311","thread":"qtp1688034375-14939","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38101","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-24T09:24:37,788","input":{"type":"log"},"offset":6205190,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.24","_type":"_doc","_id":"mjl-f3MBtD96ebe8zS4F","_score":30.283562,"_source":{"level":"trace","@timestamp":"2020-07-24T06:24:37.788Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'SendMessage' service responded with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-34476-1595563114155-71-1736, CamelHttpMethod=GET, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Disposition=inline;filename=f.txt, Content-Type=application/json;charset=utf-8, Date=Fri, 24 Jul 2020 06:24:37 GMT, JMSCorrelationID=3a70d527-e88c-405c-9ae4-6b66b6dc64e311, operationName=SendMessage, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/fca9d9c0-a68e-4e92-a710-25e9acb2c073/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=3a70d527-e88c-405c-9ae4-6b66b6dc64e311} | exid=ID-esb-test01-34476-1595563114155-71-1739 CID=3a70d527-e88c-405c-9ae4-6b66b6dc64e311 |\n {\"checkId\":\"fca9d9c0-a68e-4e92-a710-25e9acb2c073\"}","thread":"thread #4094 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38101","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"},"flags":["multiline"]},"@version":"1","environment":"test","timestamp":"2020-07-24T09:24:37,788","input":{"type":"log"},"offset":6204267,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}}]}}
278920 [main] INFO  kkm.UnitTests - End test

278921 [main] INFO  kkm.UnitTests - Starting test: KKM_WAcheckStatus()
279119 [main] INFO  kkm.UnitTests - End test

279124 [main] INFO  kkm.UnitTests - Starting test: KKM_getStatus()
281711 [main] INFO  kkm.UnitTests - End test

281713 [main] INFO  kkm.UnitTests - Starting test: KKM_CanceledAlredy()
286930 [main] INFO  kkm.UnitTests - End test

286935 [main] INFO  kkm.UnitTests - Starting test: KKM_getDocCustomer()
287216 [main] INFO  kkm.UnitTests - End test

287220 [main] INFO  kkm.UnitTests - Starting test: KKM_makeCheckCashier()
291516 [main] INFO  kkm.UnitTests - End test

291518 [main] INFO  kkm.UnitTests - Starting test: KKM_DB1()
292045 [main] INFO  kkm.UnitTests - Script is: SELECT TOP 1 * FROM ProcessStatus Where fiscGateCheckStatusCode = 'ERROR'
292052 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000902849
292054 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000902849
292586 [main] INFO  kkm.UnitTests - update dbo.Customer set inn = '1' where srcID = 'ЖПлато_000902849'
update ProcessStatus set fiscGateCheckStatusCode = null where srcID = 'ЖПлато_000902849'
select * from ProcessStatus where srcID = 'ЖПлато_000902849'
292587 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, null, VALIDATION_ERROR, ЖПлато_000902849]
292588 [main] INFO  kkm.UnitTests - Status is: [AXAPTA, PaymentOrder, null, VALIDATION_ERROR, ЖПлато_000902849]
352988 [main] INFO  kkm.UnitTests - select * from ProcessStatus where srcID = 'ЖПлато_000902849'
352989 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, ERROR, VALIDATION_ERROR, ЖПлато_000902849]
412993 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.24/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%22ЖПлато_000902849%22%20&size=500
413165 [main] INFO  kkm.UnitTests - Response message : {"took":39,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":2,"relation":"eq"},"max_score":11.634422,"hits":[{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"KiQ_f3MBtD96ebe8QFdL","_score":11.634422,"_source":{"@timestamp":"2020-07-24T05:15:18.078Z","stream":"stdout","message":"{\"ts\":\"2020-07-24T05:15:18.076+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"64c9742138f48305\",\"spanId\":\"64c9742138f48305\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"64c9742138f48305\",\"X-B3-TraceId\":\"64c9742138f48305\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000902849\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","docker":{"container":{"labels":{"com_docker_swarm_task_id":"ybkqchxa9pxcag2nfnnfrnkpb","com_docker_stack_namespace":"kkm-commutator","Description":"KKM Commutator Service","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb"}}},"container":{"name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e"},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"},"json":{"ts":"2020-07-24T05:15:18.076+00:00","level":"INFO","thread":"scheduling-1","X-Span-Export":"true","X-B3-TraceId":"64c9742138f48305","X-VSK-ReceiptKeys":[{"entityCode":"PaymentOrder","srcID":"ЖПлато_000902849","systemCode":"AXAPTA"}],"msg":"ReadyForSendingReceiptKeys selected ","method":"getReadyForSendingReceiptKeys","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_line_number":84,"spanId":"64c9742138f48305","spanExportable":"true","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_file_name":"KkmCommutatorService.java","traceId":"64c9742138f48305","X-B3-SpanId":"64c9742138f48305"},"log":{"offset":2985286,"file":{"path":"/var/lib/docker/containers/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e-json.log"}},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"},"input":{"type":"container"}}},{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"7TuCf3MBtD96ebe8_TnF","_score":11.634422,"_source":{"@timestamp":"2020-07-24T06:29:18.976Z","container":{"id":"d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e","name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"host":{"name":"44fcff07405a"},"log":{"offset":4887647,"file":{"path":"/var/lib/docker/containers/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e-json.log"}},"stream":"stdout","message":"{\"ts\":\"2020-07-24T06:29:18.976+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"2d7ee473ccc200b8\",\"spanId\":\"2d7ee473ccc200b8\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"2d7ee473ccc200b8\",\"X-B3-TraceId\":\"2d7ee473ccc200b8\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000902849\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_task_name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","Description":"KKM Commutator Service","com_docker_swarm_task_id":"ybkqchxa9pxcag2nfnnfrnkpb"}}},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"},"ecs":{"version":"1.0.1"},"json":{"ts":"2020-07-24T06:29:18.976+00:00","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys","traceId":"2d7ee473ccc200b8","spanExportable":"true","caller_file_name":"KkmCommutatorService.java","caller_line_number":84,"spanId":"2d7ee473ccc200b8","X-B3-SpanId":"2d7ee473ccc200b8","X-B3-TraceId":"2d7ee473ccc200b8","level":"INFO","thread":"scheduling-1","X-VSK-ReceiptKeys":[{"systemCode":"AXAPTA","entityCode":"PaymentOrder","srcID":"ЖПлато_000902849"}],"X-Span-Export":"true","msg":"ReadyForSendingReceiptKeys selected "}}}]}}
413169 [main] INFO  kkm.UnitTests - End test

413172 [main] INFO  kkm.UnitTests - Starting test: KKM_DB2()
413316 [main] INFO  kkm.UnitTests - Script is: SELECT TOP 1 * FROM ProcessStatus Where fiscGateCheckStatusCode = 'DONE'
413317 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000898541
413318 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000898541
414411 [main] INFO  kkm.UnitTests - update alertPeriod set finishTime = '00:00:00' where FilialCode = '--filialCode--'
update alertPeriod set startTime = '00:00:00' where FilialCode = '--filialCode--'
update customer set Phone = '70000000000' where srcID = 'ЖПлато_000898541'
update customer set email = '' where srcId = 'ЖПлато_000898541'
update processStatus set fiscGateCheckStatusCode = null where srcID = 'ЖПлато_000898541'
select * from processStatus where srcID = 'ЖПлато_000898541'
414411 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, null, nothing, ЖПлато_000898541]
414413 [main] INFO  kkm.UnitTests - Status is: [AXAPTA, PaymentOrder, null, nothing, ЖПлато_000898541]
474677 [main] INFO  kkm.UnitTests - select * from ProcessStatus where srcID = 'ЖПлато_000898541'
474677 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, DONE, nothing, ЖПлато_000898541]
534683 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.24/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%22ЖПлато_000898541%22%20&size=500
534761 [main] INFO  kkm.UnitTests - Response message : {"took":21,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":2,"relation":"eq"},"max_score":10.871597,"hits":[{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"vCRBf3MBtD96ebe8FckU","_score":10.871597,"_source":{"@timestamp":"2020-07-24T05:17:18.590Z","agent":{"type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1"},"log":{"offset":3050221,"file":{"path":"/var/lib/docker/containers/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e-json.log"}},"message":"{\"ts\":\"2020-07-24T05:17:18.590+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"1f121a5ea8237c40\",\"spanId\":\"1f121a5ea8237c40\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"1f121a5ea8237c40\",\"X-B3-TraceId\":\"1f121a5ea8237c40\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000898541\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","input":{"type":"container"},"ecs":{"version":"1.0.1"},"json":{"logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","level":"INFO","spanExportable":"true","ts":"2020-07-24T05:17:18.590+00:00","thread":"scheduling-1","msg":"ReadyForSendingReceiptKeys selected ","method":"getReadyForSendingReceiptKeys","caller_file_name":"KkmCommutatorService.java","caller_line_number":84,"spanId":"1f121a5ea8237c40","X-B3-TraceId":"1f121a5ea8237c40","X-VSK-ReceiptKeys":[{"systemCode":"AXAPTA","entityCode":"PaymentOrder","srcID":"ЖПлато_000898541"}],"class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","traceId":"1f121a5ea8237c40","X-Span-Export":"true","X-B3-SpanId":"1f121a5ea8237c40"},"stream":"stdout","container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e","name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb"},"docker":{"container":{"labels":{"com_docker_swarm_task":"","Description":"KKM Commutator Service","com_docker_swarm_task_id":"ybkqchxa9pxcag2nfnnfrnkpb","Version":"97","com_docker_swarm_task_name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"host":{"name":"44fcff07405a"}}},{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"CzuEf3MBtD96ebe80rOf","_score":10.871597,"_source":{"@timestamp":"2020-07-24T06:31:18.894Z","agent":{"id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a"},"message":"{\"ts\":\"2020-07-24T06:31:18.894+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"7432218d90f469a2\",\"spanId\":\"7432218d90f469a2\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"7432218d90f469a2\",\"X-B3-TraceId\":\"7432218d90f469a2\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000898541\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e","name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb"},"ecs":{"version":"1.0.1"},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_stack_namespace":"kkm-commutator","Version":"97","com_docker_swarm_task_name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_id":"ybkqchxa9pxcag2nfnnfrnkpb","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9"}}},"host":{"name":"44fcff07405a"},"json":{"caller_file_name":"KkmCommutatorService.java","X-VSK-ReceiptKeys":[{"systemCode":"AXAPTA","entityCode":"PaymentOrder","srcID":"ЖПлато_000898541"}],"ts":"2020-07-24T06:31:18.894+00:00","level":"INFO","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","X-B3-SpanId":"7432218d90f469a2","msg":"ReadyForSendingReceiptKeys selected ","method":"getReadyForSendingReceiptKeys","thread":"scheduling-1","traceId":"7432218d90f469a2","spanExportable":"true","X-B3-TraceId":"7432218d90f469a2","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_line_number":84,"spanId":"7432218d90f469a2","X-Span-Export":"true"},"log":{"offset":4958044,"file":{"path":"/var/lib/docker/containers/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e-json.log"}},"stream":"stdout","input":{"type":"container"}}}]}}
534763 [main] INFO  kkm.UnitTests - End test

534764 [main] INFO  kkm.UnitTests - Starting test: KKM_DB3()
534889 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-qcePDNb6q8pD', '7704924768', '2019-07-12 00:00:00.000', '7710026574', '0031');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-qcePDNb6q8pD','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-qcePDNb6q8pD', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-qcePDNb6q8pD', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-qcePDNb6q8pD'

update alertPeriod set finishTime = '23:59:59' where FilialCode = '0031'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0031'
update fiscalCheck set filialCode = '0031' where srcId = '9SD0C9DZ-9289-4A09-qcePDNb6q8pD'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-qcePDNb6q8pD'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-qcePDNb6q8pD'
645795 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-qcePDNb6q8pD'
645796 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, DONE, , , 9SD0C9DZ-9289-4A09-qcePDNb6q8pD, 4a60f5fb-86c3-4cda-89ac-b1b39fa519f2]
645800 [main] INFO  kkm.UnitTests - Status: DONE
645800 [main] INFO  kkm.UnitTests - fiscGateErrorCode: 
645801 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: 
666907 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.24/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%229SD0C9DZ-9289-4A09-qcePDNb6q8pD%22%20&size=500
667087 [main] INFO  kkm.UnitTests - Response message : {"took":44,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":26.276155,"hits":[{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"qDyHf3MBtD96ebe8mZeq","_score":26.276155,"_source":{"@timestamp":"2020-07-24T06:34:20.272Z","input":{"type":"container"},"agent":{"type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1"},"message":"{\"ts\":\"2020-07-24T06:34:20.272+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"4d48820ccb440236\",\"spanId\":\"4d48820ccb440236\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"4d48820ccb440236\",\"X-B3-TraceId\":\"4d48820ccb440236\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-qcePDNb6q8pD\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-WekPzbjeFX4i\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","stream":"stdout","container":{"name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e"},"docker":{"container":{"labels":{"com_docker_swarm_task_name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb","com_docker_swarm_task_id":"ybkqchxa9pxcag2nfnnfrnkpb","com_docker_swarm_task":"","Description":"KKM Commutator Service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","Version":"97","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service"}}},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"},"json":{"level":"INFO","thread":"scheduling-1","X-Span-Export":"true","msg":"ReadyForSendingReceiptKeys selected ","ts":"2020-07-24T06:34:20.272+00:00","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","spanExportable":"true","caller_line_number":84,"traceId":"4d48820ccb440236","X-B3-SpanId":"4d48820ccb440236","X-B3-TraceId":"4d48820ccb440236","caller_file_name":"KkmCommutatorService.java","spanId":"4d48820ccb440236","X-VSK-ReceiptKeys":[{"srcID":"9SD0C9DZ-9289-4A09-qcePDNb6q8pD","systemCode":"ADINSURE","entityCode":"Payment"},{"systemCode":"ADINSURE","entityCode":"Payment","srcID":"9SD0C9DZ-9289-4A09-WekPzbjeFX4i"}],"class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys"},"log":{"offset":5049215,"file":{"path":"/var/lib/docker/containers/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e-json.log"}}}}]}}
667203 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0031'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0031'
667226 [main] INFO  kkm.UnitTests - End test

667227 [main] INFO  kkm.UnitTests - Starting test: KKM_DB4()
667340 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-D2e45s2n8oaK', '2481616080', '2019-07-12 00:00:00.000', '7725327863', '0067');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-D2e45s2n8oaK','Фамилия Имя Отчество', '7725327863', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-D2e45s2n8oaK', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-D2e45s2n8oaK', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-D2e45s2n8oaK'

update alertPeriod set finishTime = '23:59:59' where FilialCode = '0067'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0067'
update fiscalCheck set filialCode = '0067' where srcId = '9SD0C9DZ-9289-4A09-D2e45s2n8oaK'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-D2e45s2n8oaK'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-D2e45s2n8oaK'
778515 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-D2e45s2n8oaK'
778516 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, FAIL, BAD_REQUEST, Bad request: {
  "errors": [
    "Передача данных автомата недоступна для указанной группы"
  ]
}, 9SD0C9DZ-9289-4A09-D2e45s2n8oaK, b049d314-9d50-4b1d-a84a-ed81d797fc16]
778520 [main] INFO  kkm.UnitTests - Status: FAIL
778520 [main] INFO  kkm.UnitTests - fiscGateErrorCode: BAD_REQUEST
778521 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: Bad request: {
  "errors": [
    "Передача данных автомата недоступна для указанной группы"
  ]
}
799045 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.24/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%229SD0C9DZ-9289-4A09-D2e45s2n8oaK%22%20&size=500
799141 [main] INFO  kkm.UnitTests - Response message : {"took":43,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":25.881996,"hits":[{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"NT2Jf3MBtD96ebe8akyZ","_score":25.881996,"_source":{"@timestamp":"2020-07-24T06:36:19.049Z","input":{"type":"container"},"container":{"id":"d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e","name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","Version":"97","com_docker_swarm_task_id":"ybkqchxa9pxcag2nfnnfrnkpb","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_task_name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb"}}},"ecs":{"version":"1.0.1"},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"},"json":{"level":"INFO","method":"getReadyForSendingReceiptKeys","spanId":"4cf00b353b5949d5","X-B3-TraceId":"4cf00b353b5949d5","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_file_name":"KkmCommutatorService.java","X-Span-Export":"true","X-B3-SpanId":"4cf00b353b5949d5","X-VSK-ReceiptKeys":[{"systemCode":"ADINSURE","entityCode":"Payment","srcID":"9SD0C9DZ-9289-4A09-D2e45s2n8oaK"},{"systemCode":"ADINSURE","entityCode":"Payment","srcID":"9SD0C9DZ-9289-4A09-2PGB9WGQ4EiD"}],"ts":"2020-07-24T06:36:19.049+00:00","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","traceId":"4cf00b353b5949d5","spanExportable":"true","msg":"ReadyForSendingReceiptKeys selected ","caller_line_number":84,"thread":"scheduling-1"},"message":"{\"ts\":\"2020-07-24T06:36:19.049+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"4cf00b353b5949d5\",\"spanId\":\"4cf00b353b5949d5\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"4cf00b353b5949d5\",\"X-B3-TraceId\":\"4cf00b353b5949d5\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-D2e45s2n8oaK\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-2PGB9WGQ4EiD\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","stream":"stdout","log":{"offset":5148907,"file":{"path":"/var/lib/docker/containers/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e-json.log"}},"host":{"name":"44fcff07405a"}}}]}}
799262 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0067'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0067'
799287 [main] INFO  kkm.UnitTests - End test

799289 [main] INFO  kkm.UnitTests - Starting test: KKM_DB5()
799409 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-Uj5wocMkXopq', '6831211160', '2019-07-12 00:00:00.000', '7710026574', 'NOFILIAL');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-Uj5wocMkXopq','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-Uj5wocMkXopq', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-Uj5wocMkXopq', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-Uj5wocMkXopq'

update alertPeriod set finishTime = '23:59:59' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '00:00:00' where FilialCode = 'NOFILIAL'
update fiscalCheck set filialCode = 'NOFILIAL' where srcId = '9SD0C9DZ-9289-4A09-Uj5wocMkXopq'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-Uj5wocMkXopq'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-Uj5wocMkXopq'
910442 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-Uj5wocMkXopq'
910443 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, DONE, , , 9SD0C9DZ-9289-4A09-Uj5wocMkXopq, 1e2ad682-66e7-4075-b291-2ed756aeec1c]
910447 [main] INFO  kkm.UnitTests - Status: DONE
910448 [main] INFO  kkm.UnitTests - fiscGateErrorCode: 
910448 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: 
930592 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.24/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%229SD0C9DZ-9289-4A09-Uj5wocMkXopq%22%20&size=500
930680 [main] INFO  kkm.UnitTests - Response message : {"took":34,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":25.546127,"hits":[{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"QD6Lf3MBtD96ebe8P35p","_score":25.546127,"_source":{"@timestamp":"2020-07-24T06:38:19.334Z","stream":"stdout","docker":{"container":{"labels":{"com_docker_swarm_task_id":"ybkqchxa9pxcag2nfnnfrnkpb","com_docker_stack_namespace":"kkm-commutator","Description":"KKM Commutator Service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_task_name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":""}}},"container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e","name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb"},"json":{"ts":"2020-07-24T06:38:19.334+00:00","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","traceId":"6918d81dd6ee7fbe","spanExportable":"true","X-Span-Export":"true","method":"getReadyForSendingReceiptKeys","caller_file_name":"KkmCommutatorService.java","spanId":"6918d81dd6ee7fbe","caller_line_number":84,"thread":"scheduling-1","X-B3-TraceId":"6918d81dd6ee7fbe","X-VSK-ReceiptKeys":[{"entityCode":"Payment","srcID":"9SD0C9DZ-9289-4A09-4I7sZtGvA4o6","systemCode":"ADINSURE"},{"systemCode":"ADINSURE","entityCode":"Payment","srcID":"9SD0C9DZ-9289-4A09-Uj5wocMkXopq"}],"logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","level":"INFO","X-B3-SpanId":"6918d81dd6ee7fbe","msg":"ReadyForSendingReceiptKeys selected "},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"},"log":{"offset":5255908,"file":{"path":"/var/lib/docker/containers/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e-json.log"}},"message":"{\"ts\":\"2020-07-24T06:38:19.334+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"6918d81dd6ee7fbe\",\"spanId\":\"6918d81dd6ee7fbe\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"6918d81dd6ee7fbe\",\"X-B3-TraceId\":\"6918d81dd6ee7fbe\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-4I7sZtGvA4o6\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-Uj5wocMkXopq\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","input":{"type":"container"},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"}}}]}}
930806 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = 'NOFILIAL'
930829 [main] INFO  kkm.UnitTests - End test

930830 [main] INFO  kkm.UnitTests - Starting test: KKM_DB6()
930947 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-OqF3182v404Y', '1453703678', '2019-07-12 00:00:00.000', '7710026574', '0031');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-OqF3182v404Y','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-OqF3182v404Y', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-OqF3182v404Y', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-OqF3182v404Y'

update alertPeriod set finishTime = '00:00:00' where FilialCode = '0031'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0031'
update fiscalCheck set filialCode = '0031' where srcId = '9SD0C9DZ-9289-4A09-OqF3182v404Y'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-OqF3182v404Y'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-OqF3182v404Y'
1042123 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-OqF3182v404Y'
1042123 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-OqF3182v404Y, null]
1042128 [main] INFO  kkm.UnitTests - Status: null
1042128 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
1042128 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
1062132 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.24/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
1062348 [main] INFO  kkm.UnitTests - Response message : {"took":158,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":399,"relation":"eq"},"max_score":5.993006,"hits":[{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"PRPzfnMBtD96ebe8CIMi","_score":5.993006,"_source":{"@timestamp":"2020-07-24T03:52:04.331Z","log":{"offset":774748,"file":{"path":"/var/lib/docker/containers/cb361a4a875e945c156e9e24dd0e6756f8a88c4c806d622dee37da4f0b598a45/cb361a4a875e945c156e9e24dd0e6756f8a88c4c806d622dee37da4f0b598a45-json.log"}},"message":"{\"ts\":\"2020-07-24T03:52:04.331+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","input":{"type":"container"},"host":{"name":"44fcff07405a"},"stream":"stdout","container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"cb361a4a875e945c156e9e24dd0e6756f8a88c4c806d622dee37da4f0b598a45","name":"kkm-commutator_service.1.2816xjilipeh810b18qu7m63u"},"docker":{"container":{"labels":{"Version":"97","com_docker_swarm_task":"","com_docker_swarm_task_id":"2816xjilipeh810b18qu7m63u","Description":"KKM Commutator Service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_name":"kkm-commutator_service.1.2816xjilipeh810b18qu7m63u","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_stack_namespace":"kkm-commutator"}}},"agent":{"id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a"},"ecs":{"version":"1.0.1"},"json":{"logger":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","caller_line_number":52,"thread":"main","msg":"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}","ts":"2020-07-24T03:52:04.331+00:00","class":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","method":"combine","caller_file_name":"DefaultRequestHandlerCombiner.java","level":"DEBUG"}}},{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"8BPwfnMBtD96ebe80EQs","_score":5.993006,"_source":{"@timestamp":"2020-07-24T03:49:39.220Z","message":"{\"ts\":\"2020-07-24T03:49:39.220+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","container":{"name":"kkm-commutator_service.1.fzuidu6zkuex4q357tmei353n","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"02c15325be0bc401a2a6a88792427ed20a8c535e11da66458bb4bef38147cd5a"},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_stack_namespace":"kkm-commutator","Version":"97","com_docker_swarm_task_name":"kkm-commutator_service.1.fzuidu6zkuex4q357tmei353n","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"fzuidu6zkuex4q357tmei353n"}}},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"},"json":{"ts":"2020-07-24T03:49:39.220+00:00","caller_line_number":52,"msg":"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}","caller_file_name":"DefaultRequestHandlerCombiner.java","thread":"main","logger":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","level":"DEBUG","class":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","method":"combine"},"log":{"offset":774722,"file":{"path":"/var/lib/docker/containers/02c15325be0bc401a2a6a88792427ed20a8c535e11da66458bb4bef38147cd5a/02c15325be0bc401a2a6a88792427ed20a8c535e11da66458bb4bef38147cd5a-json.log"}},"stream":"stdout","input":{"type":"container"},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"}}},{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"JxT1fnMBtD96ebe8O0Qt","_score":5.993006,"_source":{"@timestamp":"2020-07-24T03:54:29.417Z","message":"{\"ts\":\"2020-07-24T03:54:29.417+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","input":{"type":"container"},"agent":{"type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1"},"json":{"caller_file_name":"DefaultRequestHandlerCombiner.java","thread":"main","logger":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","level":"DEBUG","class":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","method":"combine","caller_line_number":52,"msg":"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}","ts":"2020-07-24T03:54:29.417+00:00"},"stream":"stdout","container":{"id":"12b361def0e460f5d7ce31efa7769d6f92c29d5c414d63c288ef7987a3f7464f","name":"kkm-commutator_service.1.kji1ubcssj6uls58bomed9wcw","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_task_id":"kji1ubcssj6uls58bomed9wcw","Version":"97","com_docker_swarm_task_name":"kkm-commutator_service.1.kji1ubcssj6uls58bomed9wcw","com_docker_swarm_task":"","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"},"log":{"offset":774737,"file":{"path":"/var/lib/docker/containers/12b361def0e460f5d7ce31efa7769d6f92c29d5c414d63c288ef7987a3f7464f/12b361def0e460f5d7ce31efa7769d6f92c29d5c414d63c288ef7987a3f7464f-json.log"}}}},{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"4RT3fnMBtD96ebe8dKNT","_score":5.993006,"_source":{"@timestamp":"2020-07-24T03:56:54.290Z","ecs":{"version":"1.0.1"},"agent":{"type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1"},"log":{"offset":774704,"file":{"path":"/var/lib/docker/containers/25c0476092831090894bace94b04b3998c89ac6a88be6bc06ccd542447a2ef9c/25c0476092831090894bace94b04b3998c89ac6a88be6bc06ccd542447a2ef9c-json.log"}},"stream":"stdout","message":"{\"ts\":\"2020-07-24T03:56:54.290+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","container":{"id":"25c0476092831090894bace94b04b3998c89ac6a88be6bc06ccd542447a2ef9c","name":"kkm-commutator_service.1.r0gdoestxri2guz1qseg9x9za","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","Version":"97","Description":"KKM Commutator Service","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_task_name":"kkm-commutator_service.1.r0gdoestxri2guz1qseg9x9za","com_docker_swarm_task_id":"r0gdoestxri2guz1qseg9x9za","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":""}}},"input":{"type":"container"},"host":{"name":"44fcff07405a"},"json":{"msg":"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}","ts":"2020-07-24T03:56:54.290+00:00","level":"DEBUG","class":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","caller_file_name":"DefaultRequestHandlerCombiner.java","logger":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","method":"combine","caller_line_number":52,"thread":"main"}}},{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"MBT5fnMBtD96ebe8qeYQ","_score":5.993006,"_source":{"@timestamp":"2020-07-24T03:59:19.402Z","log":{"file":{"path":"/var/lib/docker/containers/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e-json.log"},"offset":774710},"message":"{\"ts\":\"2020-07-24T03:59:19.402+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","Description":"KKM Commutator Service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task":"","com_docker_swarm_task_id":"ybkqchxa9pxcag2nfnnfrnkpb","com_docker_stack_namespace":"kkm-commutator","Version":"97","com_docker_swarm_task_name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb"}}},"ecs":{"version":"1.0.1"},"json":{"logger":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","level":"DEBUG","class":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","msg":"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}","ts":"2020-07-24T03:59:19.402+00:00","method":"combine","caller_file_name":"DefaultRequestHandlerCombiner.java","caller_line_number":52,"thread":"main"},"stream":"stdout","container":{"id":"d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e","name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"agent":{"id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a"},"host":{"name":"44fcff07405a"}}}]}}
1062480 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0031'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0031'
1062504 [main] INFO  kkm.UnitTests - End test

1062505 [main] INFO  kkm.UnitTests - Starting test: KKM_DB7()
1062637 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-k5Sl1P9if4ke', '9335679197', '2019-07-12 00:00:00.000', '7725327863', '0067');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-k5Sl1P9if4ke','Фамилия Имя Отчество', '7725327863', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-k5Sl1P9if4ke', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-k5Sl1P9if4ke', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-k5Sl1P9if4ke'

update alertPeriod set finishTime = '00:00:00' where FilialCode = '0067'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0067'
update fiscalCheck set filialCode = '0067' where srcId = '9SD0C9DZ-9289-4A09-k5Sl1P9if4ke'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-k5Sl1P9if4ke'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-k5Sl1P9if4ke'
1173461 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-k5Sl1P9if4ke'
1173461 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-k5Sl1P9if4ke, null]
1173466 [main] INFO  kkm.UnitTests - Status: null
1173466 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
1173466 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
1193469 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.24/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
1193568 [main] INFO  kkm.UnitTests - Response message : {"took":31,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":401,"relation":"eq"},"max_score":5.9899726,"hits":[{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"PRPzfnMBtD96ebe8CIMi","_score":5.9899726,"_source":{"@timestamp":"2020-07-24T03:52:04.331Z","log":{"offset":774748,"file":{"path":"/var/lib/docker/containers/cb361a4a875e945c156e9e24dd0e6756f8a88c4c806d622dee37da4f0b598a45/cb361a4a875e945c156e9e24dd0e6756f8a88c4c806d622dee37da4f0b598a45-json.log"}},"message":"{\"ts\":\"2020-07-24T03:52:04.331+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","input":{"type":"container"},"host":{"name":"44fcff07405a"},"stream":"stdout","container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"cb361a4a875e945c156e9e24dd0e6756f8a88c4c806d622dee37da4f0b598a45","name":"kkm-commutator_service.1.2816xjilipeh810b18qu7m63u"},"docker":{"container":{"labels":{"Version":"97","com_docker_swarm_task":"","com_docker_swarm_task_id":"2816xjilipeh810b18qu7m63u","Description":"KKM Commutator Service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_name":"kkm-commutator_service.1.2816xjilipeh810b18qu7m63u","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_stack_namespace":"kkm-commutator"}}},"agent":{"id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a"},"ecs":{"version":"1.0.1"},"json":{"logger":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","caller_line_number":52,"thread":"main","msg":"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}","ts":"2020-07-24T03:52:04.331+00:00","class":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","method":"combine","caller_file_name":"DefaultRequestHandlerCombiner.java","level":"DEBUG"}}},{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"8BPwfnMBtD96ebe80EQs","_score":5.9899726,"_source":{"@timestamp":"2020-07-24T03:49:39.220Z","message":"{\"ts\":\"2020-07-24T03:49:39.220+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","container":{"name":"kkm-commutator_service.1.fzuidu6zkuex4q357tmei353n","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"02c15325be0bc401a2a6a88792427ed20a8c535e11da66458bb4bef38147cd5a"},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_stack_namespace":"kkm-commutator","Version":"97","com_docker_swarm_task_name":"kkm-commutator_service.1.fzuidu6zkuex4q357tmei353n","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"fzuidu6zkuex4q357tmei353n"}}},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"},"json":{"ts":"2020-07-24T03:49:39.220+00:00","caller_line_number":52,"msg":"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}","caller_file_name":"DefaultRequestHandlerCombiner.java","thread":"main","logger":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","level":"DEBUG","class":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","method":"combine"},"log":{"offset":774722,"file":{"path":"/var/lib/docker/containers/02c15325be0bc401a2a6a88792427ed20a8c535e11da66458bb4bef38147cd5a/02c15325be0bc401a2a6a88792427ed20a8c535e11da66458bb4bef38147cd5a-json.log"}},"stream":"stdout","input":{"type":"container"},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"}}},{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"JxT1fnMBtD96ebe8O0Qt","_score":5.9899726,"_source":{"@timestamp":"2020-07-24T03:54:29.417Z","message":"{\"ts\":\"2020-07-24T03:54:29.417+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","input":{"type":"container"},"agent":{"type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1"},"json":{"caller_file_name":"DefaultRequestHandlerCombiner.java","thread":"main","logger":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","level":"DEBUG","class":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","method":"combine","caller_line_number":52,"msg":"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}","ts":"2020-07-24T03:54:29.417+00:00"},"stream":"stdout","container":{"id":"12b361def0e460f5d7ce31efa7769d6f92c29d5c414d63c288ef7987a3f7464f","name":"kkm-commutator_service.1.kji1ubcssj6uls58bomed9wcw","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_task_id":"kji1ubcssj6uls58bomed9wcw","Version":"97","com_docker_swarm_task_name":"kkm-commutator_service.1.kji1ubcssj6uls58bomed9wcw","com_docker_swarm_task":"","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"},"log":{"offset":774737,"file":{"path":"/var/lib/docker/containers/12b361def0e460f5d7ce31efa7769d6f92c29d5c414d63c288ef7987a3f7464f/12b361def0e460f5d7ce31efa7769d6f92c29d5c414d63c288ef7987a3f7464f-json.log"}}}},{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"4RT3fnMBtD96ebe8dKNT","_score":5.9899726,"_source":{"@timestamp":"2020-07-24T03:56:54.290Z","ecs":{"version":"1.0.1"},"agent":{"type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1"},"log":{"offset":774704,"file":{"path":"/var/lib/docker/containers/25c0476092831090894bace94b04b3998c89ac6a88be6bc06ccd542447a2ef9c/25c0476092831090894bace94b04b3998c89ac6a88be6bc06ccd542447a2ef9c-json.log"}},"stream":"stdout","message":"{\"ts\":\"2020-07-24T03:56:54.290+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","container":{"id":"25c0476092831090894bace94b04b3998c89ac6a88be6bc06ccd542447a2ef9c","name":"kkm-commutator_service.1.r0gdoestxri2guz1qseg9x9za","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","Version":"97","Description":"KKM Commutator Service","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_task_name":"kkm-commutator_service.1.r0gdoestxri2guz1qseg9x9za","com_docker_swarm_task_id":"r0gdoestxri2guz1qseg9x9za","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":""}}},"input":{"type":"container"},"host":{"name":"44fcff07405a"},"json":{"msg":"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}","ts":"2020-07-24T03:56:54.290+00:00","level":"DEBUG","class":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","caller_file_name":"DefaultRequestHandlerCombiner.java","logger":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","method":"combine","caller_line_number":52,"thread":"main"}}},{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"MBT5fnMBtD96ebe8qeYQ","_score":5.9899726,"_source":{"@timestamp":"2020-07-24T03:59:19.402Z","log":{"file":{"path":"/var/lib/docker/containers/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e-json.log"},"offset":774710},"message":"{\"ts\":\"2020-07-24T03:59:19.402+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","Description":"KKM Commutator Service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task":"","com_docker_swarm_task_id":"ybkqchxa9pxcag2nfnnfrnkpb","com_docker_stack_namespace":"kkm-commutator","Version":"97","com_docker_swarm_task_name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb"}}},"ecs":{"version":"1.0.1"},"json":{"logger":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","level":"DEBUG","class":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","msg":"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}","ts":"2020-07-24T03:59:19.402+00:00","method":"combine","caller_file_name":"DefaultRequestHandlerCombiner.java","caller_line_number":52,"thread":"main"},"stream":"stdout","container":{"id":"d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e","name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"agent":{"id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a"},"host":{"name":"44fcff07405a"}}}]}}
1193691 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0067'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0067'
1193715 [main] INFO  kkm.UnitTests - End test

1193716 [main] INFO  kkm.UnitTests - Starting test: KKM_DB8()
1193840 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-Msa4Iv6ICN8k', '0716242371', '2019-07-12 00:00:00.000', '7710026574', 'NOFILIAL');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-Msa4Iv6ICN8k','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-Msa4Iv6ICN8k', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-Msa4Iv6ICN8k', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-Msa4Iv6ICN8k'

update alertPeriod set finishTime = '00:00:00' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '00:00:00' where FilialCode = 'NOFILIAL'
update fiscalCheck set filialCode = 'NOFILIAL' where srcId = '9SD0C9DZ-9289-4A09-Msa4Iv6ICN8k'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-Msa4Iv6ICN8k'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-Msa4Iv6ICN8k'
1304956 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-Msa4Iv6ICN8k'
1304957 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-Msa4Iv6ICN8k, null]
1304962 [main] INFO  kkm.UnitTests - Status: null
1304962 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
1304962 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
1324966 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.24/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
1325106 [main] INFO  kkm.UnitTests - Response message : {"took":18,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":403,"relation":"eq"},"max_score":5.9869614,"hits":[{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"PRPzfnMBtD96ebe8CIMi","_score":5.9869614,"_source":{"@timestamp":"2020-07-24T03:52:04.331Z","log":{"offset":774748,"file":{"path":"/var/lib/docker/containers/cb361a4a875e945c156e9e24dd0e6756f8a88c4c806d622dee37da4f0b598a45/cb361a4a875e945c156e9e24dd0e6756f8a88c4c806d622dee37da4f0b598a45-json.log"}},"message":"{\"ts\":\"2020-07-24T03:52:04.331+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","input":{"type":"container"},"host":{"name":"44fcff07405a"},"stream":"stdout","container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"cb361a4a875e945c156e9e24dd0e6756f8a88c4c806d622dee37da4f0b598a45","name":"kkm-commutator_service.1.2816xjilipeh810b18qu7m63u"},"docker":{"container":{"labels":{"Version":"97","com_docker_swarm_task":"","com_docker_swarm_task_id":"2816xjilipeh810b18qu7m63u","Description":"KKM Commutator Service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_name":"kkm-commutator_service.1.2816xjilipeh810b18qu7m63u","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_stack_namespace":"kkm-commutator"}}},"agent":{"id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a"},"ecs":{"version":"1.0.1"},"json":{"logger":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","caller_line_number":52,"thread":"main","msg":"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}","ts":"2020-07-24T03:52:04.331+00:00","class":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","method":"combine","caller_file_name":"DefaultRequestHandlerCombiner.java","level":"DEBUG"}}},{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"8BPwfnMBtD96ebe80EQs","_score":5.9869614,"_source":{"@timestamp":"2020-07-24T03:49:39.220Z","message":"{\"ts\":\"2020-07-24T03:49:39.220+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","container":{"name":"kkm-commutator_service.1.fzuidu6zkuex4q357tmei353n","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"02c15325be0bc401a2a6a88792427ed20a8c535e11da66458bb4bef38147cd5a"},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_stack_namespace":"kkm-commutator","Version":"97","com_docker_swarm_task_name":"kkm-commutator_service.1.fzuidu6zkuex4q357tmei353n","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"fzuidu6zkuex4q357tmei353n"}}},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"},"json":{"ts":"2020-07-24T03:49:39.220+00:00","caller_line_number":52,"msg":"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}","caller_file_name":"DefaultRequestHandlerCombiner.java","thread":"main","logger":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","level":"DEBUG","class":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","method":"combine"},"log":{"offset":774722,"file":{"path":"/var/lib/docker/containers/02c15325be0bc401a2a6a88792427ed20a8c535e11da66458bb4bef38147cd5a/02c15325be0bc401a2a6a88792427ed20a8c535e11da66458bb4bef38147cd5a-json.log"}},"stream":"stdout","input":{"type":"container"},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"}}},{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"JxT1fnMBtD96ebe8O0Qt","_score":5.9869614,"_source":{"@timestamp":"2020-07-24T03:54:29.417Z","message":"{\"ts\":\"2020-07-24T03:54:29.417+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","input":{"type":"container"},"agent":{"type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1"},"json":{"caller_file_name":"DefaultRequestHandlerCombiner.java","thread":"main","logger":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","level":"DEBUG","class":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","method":"combine","caller_line_number":52,"msg":"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}","ts":"2020-07-24T03:54:29.417+00:00"},"stream":"stdout","container":{"id":"12b361def0e460f5d7ce31efa7769d6f92c29d5c414d63c288ef7987a3f7464f","name":"kkm-commutator_service.1.kji1ubcssj6uls58bomed9wcw","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_task_id":"kji1ubcssj6uls58bomed9wcw","Version":"97","com_docker_swarm_task_name":"kkm-commutator_service.1.kji1ubcssj6uls58bomed9wcw","com_docker_swarm_task":"","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"},"log":{"offset":774737,"file":{"path":"/var/lib/docker/containers/12b361def0e460f5d7ce31efa7769d6f92c29d5c414d63c288ef7987a3f7464f/12b361def0e460f5d7ce31efa7769d6f92c29d5c414d63c288ef7987a3f7464f-json.log"}}}},{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"4RT3fnMBtD96ebe8dKNT","_score":5.9869614,"_source":{"@timestamp":"2020-07-24T03:56:54.290Z","ecs":{"version":"1.0.1"},"agent":{"type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1"},"log":{"offset":774704,"file":{"path":"/var/lib/docker/containers/25c0476092831090894bace94b04b3998c89ac6a88be6bc06ccd542447a2ef9c/25c0476092831090894bace94b04b3998c89ac6a88be6bc06ccd542447a2ef9c-json.log"}},"stream":"stdout","message":"{\"ts\":\"2020-07-24T03:56:54.290+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","container":{"id":"25c0476092831090894bace94b04b3998c89ac6a88be6bc06ccd542447a2ef9c","name":"kkm-commutator_service.1.r0gdoestxri2guz1qseg9x9za","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","Version":"97","Description":"KKM Commutator Service","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_task_name":"kkm-commutator_service.1.r0gdoestxri2guz1qseg9x9za","com_docker_swarm_task_id":"r0gdoestxri2guz1qseg9x9za","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":""}}},"input":{"type":"container"},"host":{"name":"44fcff07405a"},"json":{"msg":"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}","ts":"2020-07-24T03:56:54.290+00:00","level":"DEBUG","class":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","caller_file_name":"DefaultRequestHandlerCombiner.java","logger":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","method":"combine","caller_line_number":52,"thread":"main"}}},{"_index":"kkm-commutator-test-2020.07.24","_type":"_doc","_id":"MBT5fnMBtD96ebe8qeYQ","_score":5.9869614,"_source":{"@timestamp":"2020-07-24T03:59:19.402Z","log":{"file":{"path":"/var/lib/docker/containers/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e/d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e-json.log"},"offset":774710},"message":"{\"ts\":\"2020-07-24T03:59:19.402+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","Description":"KKM Commutator Service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task":"","com_docker_swarm_task_id":"ybkqchxa9pxcag2nfnnfrnkpb","com_docker_stack_namespace":"kkm-commutator","Version":"97","com_docker_swarm_task_name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb"}}},"ecs":{"version":"1.0.1"},"json":{"logger":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","level":"DEBUG","class":"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner","msg":"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}","ts":"2020-07-24T03:59:19.402+00:00","method":"combine","caller_file_name":"DefaultRequestHandlerCombiner.java","caller_line_number":52,"thread":"main"},"stream":"stdout","container":{"id":"d792f86ee5402f06c65da50416cc3b7e085449e096baf5335f5b42785bd7d65e","name":"kkm-commutator_service.1.ybkqchxa9pxcag2nfnnfrnkpb","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"agent":{"id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a"},"host":{"name":"44fcff07405a"}}}]}}
1325252 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = 'NOFILIAL'
1325276 [main] INFO  kkm.UnitTests - End test

1325278 [main] INFO  kkm.UnitTests - Starting test: KKM_SendMessageWasCanceled()
1328070 [main] INFO  kkm.UnitTests - End test

1328072 [main] INFO  kkm.UnitTests - Starting test: KKM_CanceleNotFound()
1328103 [main] INFO  kkm.UnitTests - End test

1328105 [main] INFO  kkm.UnitTests - Starting test: KKM_makeAndCancelCheckCashier()
1571025 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/esb-test-2020.07.24/_search?q=%20message:%20%22CID=31096771-c4b1-4a70-a700-cad9e1a4ea9a2%22%20
1571131 [main] INFO  kkm.UnitTests - Response message : {"took":52,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":8,"relation":"eq"},"max_score":46.17395,"hits":[{"_index":"esb-test-2020.07.24","_type":"_doc","_id":"oUKSf3MBtD96ebe8bAyO","_score":46.17395,"_source":{"level":"trace","@timestamp":"2020-07-24T06:46:10.010Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST request  Operation 'CancelReceipt' was call with body: 1c2fefdf-e1e9-4d8a-8753-b1914ff12886 | exid=ID-esb-test01-34476-1595563114155-71-2937 CID=31096771-c4b1-4a70-a700-cad9e1a4ea9a2","thread":"qtp1688034375-20057","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38101","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-24T09:46:10,010","input":{"type":"log"},"offset":8669061,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.24","_type":"_doc","_id":"jEKSf3MBtD96ebe8pzJP","_score":43.890335,"_source":{"level":"trace","@timestamp":"2020-07-24T06:46:10.041Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST response Operation 'CancelReceipt' was complete with body: CancelReceiptResponse{correlationId='null', checkId='1c2fefdf-e1e9-4d8a-8753-b1914ff12886', canceledCheckId='46b2fac6-e795-4d53-955e-268ab224a39d', error=null} | exid=ID-esb-test01-34476-1595563114155-71-2937 CID=31096771-c4b1-4a70-a700-cad9e1a4ea9a2","thread":"qtp1688034375-20057","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38101","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-24T09:46:10,041","input":{"type":"log"},"offset":8673148,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.24","_type":"_doc","_id":"oEKSf3MBtD96ebe8bAyO","_score":42.831184,"_source":{"level":"debug","@timestamp":"2020-07-24T06:46:10.010Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST request  Operation 'CancelReceipt' was call with headers: {breadcrumbId=ID-esb-test01-34476-1595563114155-71-2936, JMSCorrelationID=31096771-c4b1-4a70-a700-cad9e1a4ea9a2, operationName=CancelReceipt, X-VSK-CorrelationId=31096771-c4b1-4a70-a700-cad9e1a4ea9a2} | exid=ID-esb-test01-34476-1595563114155-71-2937 CID=31096771-c4b1-4a70-a700-cad9e1a4ea9a2","thread":"qtp1688034375-20057","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38101","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-24T09:46:10,010","input":{"type":"log"},"offset":8668582,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.24","_type":"_doc","_id":"okKSf3MBtD96ebe8bAyO","_score":40.548035,"_source":{"level":"debug","@timestamp":"2020-07-24T06:46:10.011Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'CancelReceipt' calling REST service  with headers: {breadcrumbId=ID-esb-test01-34476-1595563114155-71-2936, CamelHttpMethod=PUT, JMSCorrelationID=31096771-c4b1-4a70-a700-cad9e1a4ea9a2, operationName=CancelReceipt, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/1c2fefdf-e1e9-4d8a-8753-b1914ff12886/cancel, X-VSK-CorrelationId=31096771-c4b1-4a70-a700-cad9e1a4ea9a2} | exId=ID-esb-test01-34476-1595563114155-71-2939 CID=31096771-c4b1-4a70-a700-cad9e1a4ea9a2","thread":"thread #4055 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38101","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-24T09:46:10,011","input":{"type":"log"},"offset":8669373,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.24","_type":"_doc","_id":"o0KSf3MBtD96ebe8bAyO","_score":39.349434,"_source":{"level":"trace","@timestamp":"2020-07-24T06:46:10.011Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'CancelReceipt' calling REST service  with headers: {breadcrumbId=ID-esb-test01-34476-1595563114155-71-2936, CamelHttpMethod=PUT, JMSCorrelationID=31096771-c4b1-4a70-a700-cad9e1a4ea9a2, operationName=CancelReceipt, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/1c2fefdf-e1e9-4d8a-8753-b1914ff12886/cancel, X-VSK-CorrelationId=31096771-c4b1-4a70-a700-cad9e1a4ea9a2} | exId=ID-esb-test01-34476-1595563114155-71-2939 CID=31096771-c4b1-4a70-a700-cad9e1a4ea9a2 |\n 1c2fefdf-e1e9-4d8a-8753-b1914ff12886","thread":"thread #4055 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38101","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"},"flags":["multiline"]},"@version":"1","environment":"test","timestamp":"2020-07-24T09:46:10,011","input":{"type":"log"},"offset":8669977,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.24","_type":"_doc","_id":"pEKSf3MBtD96ebe8bAyO","_score":36.641617,"_source":{"level":"debug","@timestamp":"2020-07-24T06:46:10.040Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'CancelReceipt' service responded with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-34476-1595563114155-71-2936, CamelHttpMethod=PUT, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Type=application/json;charset=utf-8, Date=Fri, 24 Jul 2020 06:46:09 GMT, JMSCorrelationID=31096771-c4b1-4a70-a700-cad9e1a4ea9a2, operationName=CancelReceipt, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/1c2fefdf-e1e9-4d8a-8753-b1914ff12886/cancel, X-VSK-CorrelationId=31096771-c4b1-4a70-a700-cad9e1a4ea9a2} | exid=ID-esb-test01-34476-1595563114155-71-2939 CID=31096771-c4b1-4a70-a700-cad9e1a4ea9a2","thread":"thread #4055 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38101","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-24T09:46:10,040","input":{"type":"log"},"offset":8670621,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.24","_type":"_doc","_id":"pkKSf3MBtD96ebe8bAyO","_score":36.641617,"_source":{"level":"debug","@timestamp":"2020-07-24T06:46:10.041Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST response Operation 'CancelReceipt' was complete with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-34476-1595563114155-71-2936, CamelHttpMethod=PUT, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Type=application/json;charset=utf-8, Date=Fri, 24 Jul 2020 06:46:09 GMT, JMSCorrelationID=31096771-c4b1-4a70-a700-cad9e1a4ea9a2, operationName=CancelReceipt, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/1c2fefdf-e1e9-4d8a-8753-b1914ff12886/cancel, X-VSK-CorrelationId=31096771-c4b1-4a70-a700-cad9e1a4ea9a2} | exid=ID-esb-test01-34476-1595563114155-71-2937 CID=31096771-c4b1-4a70-a700-cad9e1a4ea9a2","thread":"qtp1688034375-20057","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38101","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-24T09:46:10,041","input":{"type":"log"},"offset":8672330,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.24","_type":"_doc","_id":"pUKSf3MBtD96ebe8bAyO","_score":35.66004,"_source":{"level":"trace","@timestamp":"2020-07-24T06:46:10.040Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'CancelReceipt' service responded with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-34476-1595563114155-71-2936, CamelHttpMethod=PUT, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Type=application/json;charset=utf-8, Date=Fri, 24 Jul 2020 06:46:09 GMT, JMSCorrelationID=31096771-c4b1-4a70-a700-cad9e1a4ea9a2, operationName=CancelReceipt, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/1c2fefdf-e1e9-4d8a-8753-b1914ff12886/cancel, X-VSK-CorrelationId=31096771-c4b1-4a70-a700-cad9e1a4ea9a2} | exid=ID-esb-test01-34476-1595563114155-71-2939 CID=31096771-c4b1-4a70-a700-cad9e1a4ea9a2 |\n {\"checkId\":\"1c2fefdf-e1e9-4d8a-8753-b1914ff12886\",\"canceledCheckId\":\"46b2fac6-e795-4d53-955e-268ab224a39d\"}","thread":"thread #4055 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38101","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"},"flags":["multiline"]},"@version":"1","environment":"test","timestamp":"2020-07-24T09:46:10,040","input":{"type":"log"},"offset":8671420,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}}]}}
1571131 [main] INFO  kkm.UnitTests - End test

1571132 [main] INFO  kkm.UnitTests - Starting test: KKM_SIPheckStatus()
1573712 [main] INFO  kkm.UnitTests - End test

1573715 [main] INFO  kkm.UnitTests - Starting test: KKM_SendMessageNotFound()
1573988 [main] INFO  kkm.UnitTests - End test

1573991 [main] INFO  kkm.UnitTests - Starting test: KKM_PostCorrectionReceipt_negative()
1574108 [main] INFO  kkm.UnitTests - End test

1574111 [main] INFO  kkm.UnitTests - Starting test: KKM_PostCorrectionReceipt()
1576695 [main] INFO  kkm.UnitTests - End test

