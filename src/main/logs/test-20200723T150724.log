213  [main] INFO  kkm.UnitTests - Starting test: KKM_DB3()
915  [main] INFO  kkm.UnitTests - Script is: --Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-oEOik03WqGuL', '1482630527', '2019-07-12 00:00:00.000', '7710026574', '0031');
--
--Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-oEOik03WqGuL','Фамилия Имя Отчество', '7710026574', '71000000000' );
--
--Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-oEOik03WqGuL', '1522756', 'INCOME');
--
--Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-oEOik03WqGuL', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');
--
--insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
--select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
--from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
--where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-oEOik03WqGuL'
--
--
--update alertPeriod set finishTime = '23:59:59' where FilialCode = '0031'
--
--update alertPeriod set startTime = '00:00:00' where FilialCode = '0031'
--
--update fiscalCheck set filialCode = '0031' where srcId = '9SD0C9DZ-9289-4A09-oEOik03WqGuL'
--
--update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-oEOik03WqGuL'
--




Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-oEOik03WqGuL', '1482630527', '2019-07-12 00:00:00.000', '7710026574', '0031');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-oEOik03WqGuL','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-oEOik03WqGuL', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-oEOik03WqGuL', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-oEOik03WqGuL'

update alertPeriod set finishTime = '23:59:59' where FilialCode = '0031'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0031'
update fiscalCheck set filialCode = '0031' where srcId = '9SD0C9DZ-9289-4A09-oEOik03WqGuL'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-oEOik03WqGuL'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-oEOik03WqGuL'
