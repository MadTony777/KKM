139  [main] INFO  kkm.UnitTests - Starting test: KKM_makeCheckNoCashier()
2907 [main] INFO  kkm.UnitTests - End test

2914 [main] INFO  kkm.UnitTests - Starting test: KKM_SendMessageEmail()
35213 [main] INFO  kkm.UnitTests - {"checkId":"0945bdc8-e593-4f73-b833-ace278e06bb6"}
275273 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/esb-stage-2020.07.29/_search?q=%20message:%20%22CID=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11%22%20
275342 [main] INFO  kkm.UnitTests - Response message : {"took":7,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":8,"relation":"eq"},"max_score":58.455322,"hits":[{"_index":"esb-stage-2020.07.29","_type":"_doc","_id":"UTmOmXMBfrYj4vM9hkkx","_score":58.455322,"_source":{"level":"trace","input":{"type":"log"},"tags":["beats_input_codec_plain_applied"],"application":"esb","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"offset":1892650,"@timestamp":"2020-07-29T07:51:39.562Z","beat":{"name":"esb-stage","hostname":"esb-stage","version":"6.8.6"},"timestamp":"2020-07-29T10:51:39,562","thread":"qtp524044206-1522","message":"KkmService: REST response Operation 'SendMessage' was complete with body: ReceiptResponse{correlationId='null', checkId='0945bdc8-e593-4f73-b833-ace278e06bb6', error=null} | exid=ID-esb-stage-42112-1596001282592-55-10847 CID=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11","environment":"stage","source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log","@version":"1","bundleid":"27766","host":{"name":"esb-stage"},"prospector":{"type":"log"},"package":"servicemix.esb.kkm"}},{"_index":"esb-stage-2020.07.29","_type":"_doc","_id":"KzmOmXMBfrYj4vM9STHY","_score":58.228313,"_source":{"level":"trace","input":{"type":"log"},"tags":["beats_input_codec_plain_applied"],"application":"esb","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"offset":1888259,"beat":{"name":"esb-stage","hostname":"esb-stage","version":"6.8.6"},"@timestamp":"2020-07-29T07:51:39.525Z","timestamp":"2020-07-29T10:51:39,525","thread":"qtp524044206-1522","message":"KkmService: REST request  Operation 'SendMessage' was call with body: SendMessageRequest{checkId='0945bdc8-e593-4f73-b833-ace278e06bb6', messageType='email', messageAddress='EPolikarpova@VSK.RU'} | exid=ID-esb-stage-42112-1596001282592-55-10847 CID=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11","environment":"stage","source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log","@version":"1","bundleid":"27766","host":{"name":"esb-stage"},"prospector":{"type":"log"},"package":"servicemix.esb.kkm"}},{"_index":"esb-stage-2020.07.29","_type":"_doc","_id":"HTmOmXMBfrYj4vM9SjJI","_score":55.842834,"_source":{"level":"debug","input":{"type":"log"},"tags":["beats_input_codec_plain_applied"],"application":"esb","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"offset":1887781,"beat":{"name":"esb-stage","hostname":"esb-stage","version":"6.8.6"},"@timestamp":"2020-07-29T07:51:39.524Z","timestamp":"2020-07-29T10:51:39,524","thread":"qtp524044206-1522","message":"KkmService: REST request  Operation 'SendMessage' was call with headers: {breadcrumbId=ID-esb-stage-42112-1596001282592-55-10846, JMSCorrelationID=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11, operationName=SendMessage, X-VSK-CorrelationId=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11} | exid=ID-esb-stage-42112-1596001282592-55-10847 CID=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11","environment":"stage","source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log","@version":"1","bundleid":"27766","host":{"name":"esb-stage"},"prospector":{"type":"log"},"package":"servicemix.esb.kkm"}},{"_index":"esb-stage-2020.07.29","_type":"_doc","_id":"oDmOmXMBfrYj4vM9STH-","_score":52.334435,"_source":{"level":"trace","input":{"type":"log"},"tags":["beats_input_codec_plain_applied"],"application":"esb","log":{"flags":["multiline"],"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"offset":1889299,"@timestamp":"2020-07-29T07:51:39.526Z","beat":{"name":"esb-stage","hostname":"esb-stage","version":"6.8.6"},"timestamp":"2020-07-29T10:51:39,526","thread":"thread #1823 - seda://kkmRestAPI","message":"KkmService: 'SendMessage' calling REST service  with headers: {breadcrumbId=ID-esb-stage-42112-1596001282592-55-10846, CamelHttpMethod=GET, JMSCorrelationID=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11, operationName=SendMessage, UnitariusServiceUri=http://rcptss-api-tst.vsk.ru/master-system/api/v1/receipts/0945bdc8-e593-4f73-b833-ace278e06bb6/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11} | exId=ID-esb-stage-42112-1596001282592-55-10849 CID=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11 |\n ","environment":"stage","source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log","@version":"1","bundleid":"27766","host":{"name":"esb-stage"},"prospector":{"type":"log"},"package":"servicemix.esb.kkm"}},{"_index":"esb-stage-2020.07.29","_type":"_doc","_id":"mjmOmXMBfrYj4vM9SjJI","_score":52.334435,"_source":{"level":"debug","input":{"type":"log"},"tags":["beats_input_codec_plain_applied"],"application":"esb","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"offset":1888659,"beat":{"name":"esb-stage","hostname":"esb-stage","version":"6.8.6"},"@timestamp":"2020-07-29T07:51:39.526Z","timestamp":"2020-07-29T10:51:39,526","thread":"thread #1823 - seda://kkmRestAPI","message":"KkmService: 'SendMessage' calling REST service  with headers: {breadcrumbId=ID-esb-stage-42112-1596001282592-55-10846, CamelHttpMethod=GET, JMSCorrelationID=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11, operationName=SendMessage, UnitariusServiceUri=http://rcptss-api-tst.vsk.ru/master-system/api/v1/receipts/0945bdc8-e593-4f73-b833-ace278e06bb6/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11} | exId=ID-esb-stage-42112-1596001282592-55-10849 CID=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11","environment":"stage","source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log","@version":"1","bundleid":"27766","host":{"name":"esb-stage"},"prospector":{"type":"log"},"package":"servicemix.esb.kkm"}},{"_index":"esb-stage-2020.07.29","_type":"_doc","_id":"HjmOmXMBfrYj4vM9SjJI","_score":47.076412,"_source":{"level":"debug","input":{"type":"log"},"tags":["beats_input_codec_plain_applied"],"application":"esb","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"offset":1889943,"beat":{"name":"esb-stage","hostname":"esb-stage","version":"6.8.6"},"@timestamp":"2020-07-29T07:51:39.562Z","timestamp":"2020-07-29T10:51:39,562","thread":"thread #1823 - seda://kkmRestAPI","message":"KkmService: 'SendMessage' service responded with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-stage-42112-1596001282592-55-10846, CamelHttpMethod=GET, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Disposition=inline;filename=f.txt, Content-Type=application/json;charset=utf-8, Date=Wed, 29 Jul 2020 07:51:41 GMT, JMSCorrelationID=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11, operationName=SendMessage, Transfer-Encoding=chunked, UnitariusServiceUri=http://rcptss-api-tst.vsk.ru/master-system/api/v1/receipts/0945bdc8-e593-4f73-b833-ace278e06bb6/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11} | exid=ID-esb-stage-42112-1596001282592-55-10849 CID=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11","environment":"stage","source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log","@version":"1","bundleid":"27766","host":{"name":"esb-stage"},"prospector":{"type":"log"},"package":"servicemix.esb.kkm"}},{"_index":"esb-stage-2020.07.29","_type":"_doc","_id":"mzmOmXMBfrYj4vM9SjJI","_score":47.076412,"_source":{"level":"debug","input":{"type":"log"},"tags":["beats_input_codec_plain_applied"],"application":"esb","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"offset":1891753,"@timestamp":"2020-07-29T07:51:39.562Z","beat":{"name":"esb-stage","hostname":"esb-stage","version":"6.8.6"},"timestamp":"2020-07-29T10:51:39,562","thread":"qtp524044206-1522","message":"KkmService: REST response Operation 'SendMessage' was complete with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-stage-42112-1596001282592-55-10846, CamelHttpMethod=GET, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Disposition=inline;filename=f.txt, Content-Type=application/json;charset=utf-8, Date=Wed, 29 Jul 2020 07:51:41 GMT, JMSCorrelationID=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11, operationName=SendMessage, Transfer-Encoding=chunked, UnitariusServiceUri=http://rcptss-api-tst.vsk.ru/master-system/api/v1/receipts/0945bdc8-e593-4f73-b833-ace278e06bb6/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11} | exid=ID-esb-stage-42112-1596001282592-55-10847 CID=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11","environment":"stage","source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log","@version":"1","bundleid":"27766","host":{"name":"esb-stage"},"prospector":{"type":"log"},"package":"servicemix.esb.kkm"}},{"_index":"esb-stage-2020.07.29","_type":"_doc","_id":"LDmOmXMBfrYj4vM9STHY","_score":45.922943,"_source":{"level":"trace","input":{"type":"log"},"tags":["beats_input_codec_plain_applied"],"application":"esb","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"},"flags":["multiline"]},"offset":1890821,"beat":{"name":"esb-stage","hostname":"esb-stage","version":"6.8.6"},"@timestamp":"2020-07-29T07:51:39.562Z","timestamp":"2020-07-29T10:51:39,562","thread":"thread #1823 - seda://kkmRestAPI","message":"KkmService: 'SendMessage' service responded with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-stage-42112-1596001282592-55-10846, CamelHttpMethod=GET, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Disposition=inline;filename=f.txt, Content-Type=application/json;charset=utf-8, Date=Wed, 29 Jul 2020 07:51:41 GMT, JMSCorrelationID=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11, operationName=SendMessage, Transfer-Encoding=chunked, UnitariusServiceUri=http://rcptss-api-tst.vsk.ru/master-system/api/v1/receipts/0945bdc8-e593-4f73-b833-ace278e06bb6/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11} | exid=ID-esb-stage-42112-1596001282592-55-10849 CID=4c3eefe3-9bcd-4606-ab8f-4db8a901472f11 |\n {\"checkId\":\"0945bdc8-e593-4f73-b833-ace278e06bb6\"}","environment":"stage","source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log","@version":"1","bundleid":"27766","host":{"name":"esb-stage"},"prospector":{"type":"log"},"package":"servicemix.esb.kkm"}}]}}
275343 [main] INFO  kkm.UnitTests - End test

275345 [main] INFO  kkm.UnitTests - Starting test: KKM_WAcheckStatus()
277767 [main] INFO  kkm.UnitTests - End test

277772 [main] INFO  kkm.UnitTests - Starting test: KKM_getStatus()
280229 [main] INFO  kkm.UnitTests - End test

280231 [main] INFO  kkm.UnitTests - Starting test: KKM_CanceledAlredy()
284072 [main] INFO  kkm.UnitTests - End test

284074 [main] INFO  kkm.UnitTests - Starting test: KKM_getDocCustomer()
284250 [main] INFO  kkm.UnitTests - {"requestInfo":{"customerName":"?????? ???? ????????","customerDocSerial":"1000","customerDocNum":"111000","customerPhone":"+79257777777","customerEmail":"test@gmail.com","paymentType":"INCOME","paymentDatetime":"2019.05.31T16:45:45","systemId":"SHOP","amount":2000.5},"receiptInfo":{"id":"e0188ab9-66cd-45cf-b0da-284e1bb0cb50","datetimeRequest":"2019.05.31T16:45:45","datetimeReceipt":"2019.05.31T16:45:45","receiptStatus":"NEW","documentIndex":0,"paymentMethod":"PREPAYMENT","terminal":"112344256"},"positions":[{"name":"????????? ?????? ? ?????????????","price":1000.25,"quantity":2,"tax":"VAT20","taxSum":1000.25,"paymentMethod":"PREPAYMENT","subjectType":"PRODUCT"}]}
284250 [main] INFO  kkm.UnitTests - End test

284252 [main] INFO  kkm.UnitTests - Starting test: KKM_makeCheckCashier()
294856 [main] INFO  kkm.UnitTests - End test

294858 [main] INFO  kkm.UnitTests - Starting test: KKM_DB1()
295117 [main] INFO  kkm.UnitTests - Script is: SELECT TOP 1 * FROM ProcessStatus Where fiscGateCheckStatusCode = 'ERROR'
295126 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000901797
295132 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000901797
295753 [main] INFO  kkm.UnitTests - update dbo.Customer set inn = '1' where srcID = 'ЖПлато_000901797'
update ProcessStatus set fiscGateCheckStatusCode = null where srcID = 'ЖПлато_000901797'
select * from ProcessStatus where srcID = 'ЖПлато_000901797'
295755 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, null, VALIDATION_ERROR, ЖПлато_000901797]
295760 [main] INFO  kkm.UnitTests - Status is: [AXAPTA, PaymentOrder, null, VALIDATION_ERROR, ЖПлато_000901797]
356053 [main] INFO  kkm.UnitTests - select * from ProcessStatus where srcID = 'ЖПлато_000901797'
356054 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, ERROR, VALIDATION_ERROR, ЖПлато_000901797]
416060 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-stage-2020.07.29/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%22ЖПлато_000901797%22%20&size=500
416318 [main] INFO  kkm.UnitTests - Response message : {"took":198,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":3,"relation":"eq"},"max_score":11.61558,"hits":[{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"XRRRmXMBfrYj4vM9ZnI7","_score":11.61558,"_source":{"@timestamp":"2020-07-29T06:45:09.390Z","log":{"offset":3895481,"file":{"path":"/var/lib/docker/containers/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91-json.log"}},"message":"{\"ts\":\"2020-07-29T06:45:09.387+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"6e2f6498be95a5b7\",\"spanId\":\"6e2f6498be95a5b7\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"6e2f6498be95a5b7\",\"X-B3-TraceId\":\"6e2f6498be95a5b7\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000901797\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_task_name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","Description":"KKM Commutator Service","Version":"97","com_docker_swarm_task_id":"wsunza2qrd02kzp8b2jcnhwz4","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_task":""}}},"ecs":{"version":"1.0.1"},"host":{"name":"25805977eece"},"stream":"stdout","container":{"id":"10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91","name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"}}},{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"Bi53mXMBfrYj4vM918FF","_score":11.61558,"_source":{"@timestamp":"2020-07-29T07:27:09.329Z","stream":"stdout","message":"{\"ts\":\"2020-07-29T07:27:09.328+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"7493a7b1b6ee66ea\",\"spanId\":\"7493a7b1b6ee66ea\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"7493a7b1b6ee66ea\",\"X-B3-TraceId\":\"7493a7b1b6ee66ea\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000901797\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","container":{"id":"10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91","name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_task_id":"wsunza2qrd02kzp8b2jcnhwz4","com_docker_swarm_task_name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","Description":"KKM Commutator Service","Version":"97","com_docker_swarm_task":"","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd"}}},"host":{"name":"25805977eece"},"agent":{"version":"7.3.1","type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876"},"log":{"file":{"path":"/var/lib/docker/containers/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91-json.log"},"offset":5891430},"input":{"type":"container"},"ecs":{"version":"1.0.1"}}},{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"jTqSmXMBfrYj4vM9ZbwI","_score":11.61558,"_source":{"@timestamp":"2020-07-29T07:56:09.478Z","message":"{\"ts\":\"2020-07-29T07:56:09.478+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"051e676c9fe82d31\",\"spanId\":\"051e676c9fe82d31\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"051e676c9fe82d31\",\"X-B3-TraceId\":\"051e676c9fe82d31\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000901797\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","input":{"type":"container"},"docker":{"container":{"labels":{"Version":"97","com_docker_swarm_task_id":"wsunza2qrd02kzp8b2jcnhwz4","com_docker_swarm_task_name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","Description":"KKM Commutator Service","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_task":"","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_stack_namespace":"kkm-commutator"}}},"container":{"id":"10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91","name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"agent":{"hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792"},"log":{"offset":7306807,"file":{"path":"/var/lib/docker/containers/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91-json.log"}},"stream":"stdout","host":{"name":"25805977eece"}}}]}}
416319 [main] INFO  kkm.UnitTests - End test

416320 [main] INFO  kkm.UnitTests - Starting test: KKM_DB2()
416500 [main] INFO  kkm.UnitTests - Script is: SELECT TOP 1 * FROM ProcessStatus Where fiscGateCheckStatusCode = 'DONE'
416500 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000898541
416502 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000898541
417151 [main] INFO  kkm.UnitTests - update alertPeriod set finishTime = '00:00:00' where FilialCode = '--filialCode--'
update alertPeriod set startTime = '00:00:00' where FilialCode = '--filialCode--'
update customer set Phone = '70000000000' where srcID = 'ЖПлато_000898541'
update customer set email = '' where srcId = 'ЖПлато_000898541'
update processStatus set fiscGateCheckStatusCode = null where srcID = 'ЖПлато_000898541'
select * from processStatus where srcID = 'ЖПлато_000898541'
417152 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, null, nothing, ЖПлато_000898541]
417157 [main] INFO  kkm.UnitTests - Status is: [AXAPTA, PaymentOrder, null, nothing, ЖПлато_000898541]
477460 [main] INFO  kkm.UnitTests - select * from ProcessStatus where srcID = 'ЖПлато_000898541'
477460 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, SENDED, nothing, ЖПлато_000898541]
537463 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-stage-2020.07.29/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%22ЖПлато_000898541%22%20&size=500
537618 [main] INFO  kkm.UnitTests - Response message : {"took":34,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":3,"relation":"eq"},"max_score":10.801271,"hits":[{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"YRVTmXMBfrYj4vM9Ny8j","_score":10.801271,"_source":{"@timestamp":"2020-07-29T06:47:09.261Z","host":{"name":"25805977eece"},"agent":{"id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece"},"log":{"offset":3997905,"file":{"path":"/var/lib/docker/containers/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91-json.log"}},"stream":"stdout","input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","Description":"KKM Commutator Service","Version":"97","com_docker_swarm_task_id":"wsunza2qrd02kzp8b2jcnhwz4"}}},"message":"{\"ts\":\"2020-07-29T06:47:09.261+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"1a1aed4ace483f60\",\"spanId\":\"1a1aed4ace483f60\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"1a1aed4ace483f60\",\"X-B3-TraceId\":\"1a1aed4ace483f60\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000898541\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","container":{"id":"10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91","name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"}}},{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"li95mXMBfrYj4vM9rPQT","_score":10.801271,"_source":{"@timestamp":"2020-07-29T07:29:09.370Z","input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_task":"","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_task_id":"wsunza2qrd02kzp8b2jcnhwz4","com_docker_swarm_task_name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","Description":"KKM Commutator Service","Version":"97"}}},"agent":{"type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1"},"stream":"stdout","message":"{\"ts\":\"2020-07-29T07:29:09.370+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"e3f35a6d7ec23a6e\",\"spanId\":\"e3f35a6d7ec23a6e\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"e3f35a6d7ec23a6e\",\"X-B3-TraceId\":\"e3f35a6d7ec23a6e\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000898541\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","log":{"offset":5993845,"file":{"path":"/var/lib/docker/containers/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91-json.log"}},"container":{"name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91"},"ecs":{"version":"1.0.1"},"host":{"name":"25805977eece"}}},{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"_TuUmXMBfrYj4vM9NXHu","_score":10.801271,"_source":{"@timestamp":"2020-07-29T07:58:09.212Z","container":{"id":"10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91","name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"host":{"name":"25805977eece"},"log":{"offset":7409233,"file":{"path":"/var/lib/docker/containers/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91-json.log"}},"stream":"stdout","message":"{\"ts\":\"2020-07-29T07:58:09.212+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"0389b458e1f69281\",\"spanId\":\"0389b458e1f69281\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"0389b458e1f69281\",\"X-B3-TraceId\":\"0389b458e1f69281\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000898541\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","Description":"KKM Commutator Service","Version":"97","com_docker_swarm_task_id":"wsunza2qrd02kzp8b2jcnhwz4"}}}}}]}}
537619 [main] INFO  kkm.UnitTests - End test

537620 [main] INFO  kkm.UnitTests - Starting test: KKM_DB3()
537822 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-Sw2XID8y80PD', '6963835713', '2019-07-12 00:00:00.000', '7710026574', '0031');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-Sw2XID8y80PD','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-Sw2XID8y80PD', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-Sw2XID8y80PD', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-Sw2XID8y80PD'

update alertPeriod set finishTime = '23:59:59' where FilialCode = '0031'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0031'
update fiscalCheck set filialCode = '0031' where srcId = '9SD0C9DZ-9289-4A09-Sw2XID8y80PD'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-Sw2XID8y80PD'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-Sw2XID8y80PD'
648581 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-Sw2XID8y80PD'
648582 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, DONE, , , 9SD0C9DZ-9289-4A09-Sw2XID8y80PD, 8165c3f7-83f4-4cc2-9f87-55dd6567a600]
648583 [main] INFO  kkm.UnitTests - Status: DONE
648584 [main] INFO  kkm.UnitTests - fiscGateErrorCode: 
648584 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: 
668795 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-stage-2020.07.29/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%229SD0C9DZ-9289-4A09-Sw2XID8y80PD%22%20&size=500
668884 [main] INFO  kkm.UnitTests - Response message : {"took":38,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":27.143747,"hits":[{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"AjyWmXMBfrYj4vM9DiOm","_score":27.143747,"_source":{"@timestamp":"2020-07-29T08:00:09.361Z","host":{"name":"25805977eece"},"stream":"stdout","log":{"offset":7519236,"file":{"path":"/var/lib/docker/containers/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91-json.log"}},"input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_task":"","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","Description":"KKM Commutator Service","Version":"97","com_docker_swarm_task_id":"wsunza2qrd02kzp8b2jcnhwz4","com_docker_swarm_task_name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4"}}},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"message":"{\"ts\":\"2020-07-29T08:00:09.361+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"818729a4adfd7663\",\"spanId\":\"818729a4adfd7663\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"818729a4adfd7663\",\"X-B3-TraceId\":\"818729a4adfd7663\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-NLSmxjvP8F4V\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-Sw2XID8y80PD\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","container":{"id":"10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91","name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"}}}]}}
669038 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0031'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0031'
669065 [main] INFO  kkm.UnitTests - End test

669067 [main] INFO  kkm.UnitTests - Starting test: KKM_DB4()
669225 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-5R37rDDBBwC9', '2364115422', '2019-07-12 00:00:00.000', '7725327863', '0067');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-5R37rDDBBwC9','Фамилия Имя Отчество', '7725327863', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-5R37rDDBBwC9', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-5R37rDDBBwC9', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-5R37rDDBBwC9'

update alertPeriod set finishTime = '23:59:59' where FilialCode = '0067'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0067'
update fiscalCheck set filialCode = '0067' where srcId = '9SD0C9DZ-9289-4A09-5R37rDDBBwC9'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-5R37rDDBBwC9'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-5R37rDDBBwC9'
779917 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-5R37rDDBBwC9'
779917 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, FAIL, BAD_REQUEST, Bad request: {
  "errors": [
    "Передача данных автомата недоступна для указанной группы"
  ]
}, 9SD0C9DZ-9289-4A09-5R37rDDBBwC9, 7453a106-6528-4be4-898f-b3a959e1c54e]
779919 [main] INFO  kkm.UnitTests - Status: FAIL
779919 [main] INFO  kkm.UnitTests - fiscGateErrorCode: BAD_REQUEST
779919 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: Bad request: {
  "errors": [
    "Передача данных автомата недоступна для указанной группы"
  ]
}
800174 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-stage-2020.07.29/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%229SD0C9DZ-9289-4A09-5R37rDDBBwC9%22%20&size=500
800323 [main] INFO  kkm.UnitTests - Response message : {"took":50,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":26.869059,"hits":[{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"xj2YmXMBfrYj4vM9NTiE","_score":26.869059,"_source":{"@timestamp":"2020-07-29T08:02:31.144Z","stream":"stdout","message":"{\"ts\":\"2020-07-29T08:02:31.144+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"7d94c4c5d7a988c6\",\"spanId\":\"7d94c4c5d7a988c6\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"7d94c4c5d7a988c6\",\"X-B3-TraceId\":\"7d94c4c5d7a988c6\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-Cvz7s2MQW1zF\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-5R37rDDBBwC9\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","container":{"id":"10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91","name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","Version":"97","com_docker_swarm_task_id":"wsunza2qrd02kzp8b2jcnhwz4","com_docker_swarm_task_name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_task":"","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service"}}},"log":{"offset":7669325,"file":{"path":"/var/lib/docker/containers/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91-json.log"}},"input":{"type":"container"},"ecs":{"version":"1.0.1"},"host":{"name":"25805977eece"},"agent":{"type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1"}}}]}}
800479 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0067'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0067'
800503 [main] INFO  kkm.UnitTests - End test

800504 [main] INFO  kkm.UnitTests - Starting test: KKM_DB5()
800651 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-wiOWK3sjnnZK', '8503113902', '2019-07-12 00:00:00.000', '7710026574', 'NOFILIAL');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-wiOWK3sjnnZK','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-wiOWK3sjnnZK', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-wiOWK3sjnnZK', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-wiOWK3sjnnZK'

update alertPeriod set finishTime = '23:59:59' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '00:00:00' where FilialCode = 'NOFILIAL'
update fiscalCheck set filialCode = 'NOFILIAL' where srcId = '9SD0C9DZ-9289-4A09-wiOWK3sjnnZK'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-wiOWK3sjnnZK'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-wiOWK3sjnnZK'
911253 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-wiOWK3sjnnZK'
911254 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, DONE, , , 9SD0C9DZ-9289-4A09-wiOWK3sjnnZK, a7cefae8-52cc-47d0-af22-6cd69b2e4c50]
911261 [main] INFO  kkm.UnitTests - Status: DONE
911261 [main] INFO  kkm.UnitTests - fiscGateErrorCode: 
911262 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: 
931363 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-stage-2020.07.29/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%229SD0C9DZ-9289-4A09-wiOWK3sjnnZK%22%20&size=500
931577 [main] INFO  kkm.UnitTests - Response message : {"took":160,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":26.62887,"hits":[{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"oj6amXMBfrYj4vM9DHX5","_score":26.62887,"_source":{"@timestamp":"2020-07-29T08:04:31.133Z","log":{"offset":7813802,"file":{"path":"/var/lib/docker/containers/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91-json.log"}},"stream":"stdout","message":"{\"ts\":\"2020-07-29T08:04:31.133+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"d4b3dbdcd0592621\",\"spanId\":\"d4b3dbdcd0592621\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"d4b3dbdcd0592621\",\"X-B3-TraceId\":\"d4b3dbdcd0592621\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-Ume2KIvJd9lE\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-wiOWK3sjnnZK\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","container":{"id":"10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91","name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_task_name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","Description":"KKM Commutator Service","Version":"97","com_docker_swarm_task_id":"wsunza2qrd02kzp8b2jcnhwz4","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_task":""}}},"host":{"name":"25805977eece"},"agent":{"type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1"}}}]}}
931756 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = 'NOFILIAL'
931780 [main] INFO  kkm.UnitTests - End test

931781 [main] INFO  kkm.UnitTests - Starting test: KKM_DB6()
931928 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-ha91F21cmWJs', '7928393039', '2019-07-12 00:00:00.000', '7710026574', '0031');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-ha91F21cmWJs','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-ha91F21cmWJs', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-ha91F21cmWJs', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-ha91F21cmWJs'

update alertPeriod set finishTime = '00:00:00' where FilialCode = '0031'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0031'
update fiscalCheck set filialCode = '0031' where srcId = '9SD0C9DZ-9289-4A09-ha91F21cmWJs'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-ha91F21cmWJs'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-ha91F21cmWJs'
1042631 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-ha91F21cmWJs'
1042631 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-ha91F21cmWJs, null]
1042634 [main] INFO  kkm.UnitTests - Status: null
1042634 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
1042634 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
1062635 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-stage-2020.07.29/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
1062861 [main] INFO  kkm.UnitTests - Response message : {"took":164,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":973,"relation":"eq"},"max_score":5.377054,"hits":[{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"rf0XmXMBfrYj4vM9eFm9","_score":5.377054,"_source":{"@timestamp":"2020-07-29T05:41:54.776Z","stream":"stdout","container":{"id":"10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91","name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","Version":"97","com_docker_swarm_task_id":"wsunza2qrd02kzp8b2jcnhwz4","com_docker_swarm_task_name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_task":"","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service"}}},"ecs":{"version":"1.0.1"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"message":"{\"ts\":\"2020-07-29T05:41:54.776+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","log":{"file":{"path":"/var/lib/docker/containers/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91-json.log"},"offset":774733},"input":{"type":"container"},"host":{"name":"25805977eece"}}},{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"B_sTmXMBfrYj4vM9CvsN","_score":5.377054,"_source":{"@timestamp":"2020-07-29T05:37:04.465Z","stream":"stdout","message":"{\"ts\":\"2020-07-29T05:37:04.465+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","container":{"id":"62e2d31dcb80d736173fb7e85934038ac76ec61c312962d9634bd58d365f0c62","name":"kkm-commutator_service.1.2pbd7jxr2c7wllzbjwsph1jut","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"Version":"97","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"2pbd7jxr2c7wllzbjwsph1jut","com_docker_swarm_task":"","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task_name":"kkm-commutator_service.1.2pbd7jxr2c7wllzbjwsph1jut","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n"}}},"ecs":{"version":"1.0.1"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"log":{"offset":774748,"file":{"path":"/var/lib/docker/containers/62e2d31dcb80d736173fb7e85934038ac76ec61c312962d9634bd58d365f0c62/62e2d31dcb80d736173fb7e85934038ac76ec61c312962d9634bd58d365f0c62-json.log"}},"input":{"type":"container"},"host":{"name":"25805977eece"}}},{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"TfwVmXMBfrYj4vM9QrzI","_score":5.377054,"_source":{"@timestamp":"2020-07-29T05:39:29.651Z","log":{"offset":774726,"file":{"path":"/var/lib/docker/containers/9d280eb0a36e4977eabf56abd3c9c5ffb708b06d0d6538bafa1fa41060ad38ea/9d280eb0a36e4977eabf56abd3c9c5ffb708b06d0d6538bafa1fa41060ad38ea-json.log"}},"message":"{\"ts\":\"2020-07-29T05:39:29.651+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","docker":{"container":{"labels":{"com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_task_id":"m7ssfcwmousg94nnggw1yhb7u","com_docker_swarm_task_name":"kkm-commutator_service.1.m7ssfcwmousg94nnggw1yhb7u","Version":"97"}}},"ecs":{"version":"1.0.1"},"agent":{"type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1"},"stream":"stdout","input":{"type":"container"},"container":{"id":"9d280eb0a36e4977eabf56abd3c9c5ffb708b06d0d6538bafa1fa41060ad38ea","name":"kkm-commutator_service.1.m7ssfcwmousg94nnggw1yhb7u","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"host":{"name":"25805977eece"}}},{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"iLTul3MBfrYj4vM9J2qE","_score":3.7100828,"_source":{"@timestamp":"2020-07-29T00:17:09.132Z","message":"{\"ts\":\"2020-07-29T00:17:09.132+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"c08269c3925bea42\",\"spanId\":\"c08269c3925bea42\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"c08269c3925bea42\",\"X-B3-TraceId\":\"c08269c3925bea42\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","Version":"97","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","com_docker_swarm_task_id":"tfc8zap7xda72td18pqja05sp","com_docker_swarm_task_name":"kkm-commutator_service.1.tfc8zap7xda72td18pqja05sp","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_name":"kkm-commutator_service"}}},"host":{"name":"25805977eece"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"log":{"offset":41901711,"file":{"path":"/var/lib/docker/containers/c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5/c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5-json.log"}},"stream":"stdout","container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5","name":"kkm-commutator_service.1.tfc8zap7xda72td18pqja05sp"},"ecs":{"version":"1.0.1"}}},{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"QrTul3MBfrYj4vM9fXF2","_score":3.7100828,"_source":{"@timestamp":"2020-07-29T00:17:31.137Z","container":{"id":"c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5","name":"kkm-commutator_service.1.tfc8zap7xda72td18pqja05sp","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_stack_namespace":"kkm-commutator","Description":"KKM Commutator Service","Version":"97","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_id":"tfc8zap7xda72td18pqja05sp","com_docker_swarm_task_name":"kkm-commutator_service.1.tfc8zap7xda72td18pqja05sp"}}},"host":{"name":"25805977eece"},"stream":"stdout","message":"{\"ts\":\"2020-07-29T00:17:31.137+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"6dee41e4d13328a5\",\"spanId\":\"6dee41e4d13328a5\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"6dee41e4d13328a5\",\"X-B3-TraceId\":\"6dee41e4d13328a5\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","ecs":{"version":"1.0.1"},"agent":{"hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792"},"log":{"offset":41916611,"file":{"path":"/var/lib/docker/containers/c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5/c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5-json.log"}},"input":{"type":"container"}}}]}}
1063032 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0031'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0031'
1063055 [main] INFO  kkm.UnitTests - End test

1063056 [main] INFO  kkm.UnitTests - Starting test: KKM_DB7()
1063201 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-bXY8e1zsFU1c', '7186578659', '2019-07-12 00:00:00.000', '7725327863', '0067');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-bXY8e1zsFU1c','Фамилия Имя Отчество', '7725327863', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-bXY8e1zsFU1c', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-bXY8e1zsFU1c', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-bXY8e1zsFU1c'

update alertPeriod set finishTime = '00:00:00' where FilialCode = '0067'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0067'
update fiscalCheck set filialCode = '0067' where srcId = '9SD0C9DZ-9289-4A09-bXY8e1zsFU1c'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-bXY8e1zsFU1c'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-bXY8e1zsFU1c'
1173820 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-bXY8e1zsFU1c'
1173820 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-bXY8e1zsFU1c, null]
1173822 [main] INFO  kkm.UnitTests - Status: null
1173822 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
1173822 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
1193827 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-stage-2020.07.29/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
1193961 [main] INFO  kkm.UnitTests - Response message : {"took":74,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":977,"relation":"eq"},"max_score":5.376225,"hits":[{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"rf0XmXMBfrYj4vM9eFm9","_score":5.376225,"_source":{"@timestamp":"2020-07-29T05:41:54.776Z","stream":"stdout","container":{"id":"10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91","name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","Version":"97","com_docker_swarm_task_id":"wsunza2qrd02kzp8b2jcnhwz4","com_docker_swarm_task_name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_task":"","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service"}}},"ecs":{"version":"1.0.1"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"message":"{\"ts\":\"2020-07-29T05:41:54.776+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","log":{"file":{"path":"/var/lib/docker/containers/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91-json.log"},"offset":774733},"input":{"type":"container"},"host":{"name":"25805977eece"}}},{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"B_sTmXMBfrYj4vM9CvsN","_score":5.376225,"_source":{"@timestamp":"2020-07-29T05:37:04.465Z","stream":"stdout","message":"{\"ts\":\"2020-07-29T05:37:04.465+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","container":{"id":"62e2d31dcb80d736173fb7e85934038ac76ec61c312962d9634bd58d365f0c62","name":"kkm-commutator_service.1.2pbd7jxr2c7wllzbjwsph1jut","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"Version":"97","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"2pbd7jxr2c7wllzbjwsph1jut","com_docker_swarm_task":"","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task_name":"kkm-commutator_service.1.2pbd7jxr2c7wllzbjwsph1jut","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n"}}},"ecs":{"version":"1.0.1"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"log":{"offset":774748,"file":{"path":"/var/lib/docker/containers/62e2d31dcb80d736173fb7e85934038ac76ec61c312962d9634bd58d365f0c62/62e2d31dcb80d736173fb7e85934038ac76ec61c312962d9634bd58d365f0c62-json.log"}},"input":{"type":"container"},"host":{"name":"25805977eece"}}},{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"TfwVmXMBfrYj4vM9QrzI","_score":5.376225,"_source":{"@timestamp":"2020-07-29T05:39:29.651Z","log":{"offset":774726,"file":{"path":"/var/lib/docker/containers/9d280eb0a36e4977eabf56abd3c9c5ffb708b06d0d6538bafa1fa41060ad38ea/9d280eb0a36e4977eabf56abd3c9c5ffb708b06d0d6538bafa1fa41060ad38ea-json.log"}},"message":"{\"ts\":\"2020-07-29T05:39:29.651+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","docker":{"container":{"labels":{"com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_task_id":"m7ssfcwmousg94nnggw1yhb7u","com_docker_swarm_task_name":"kkm-commutator_service.1.m7ssfcwmousg94nnggw1yhb7u","Version":"97"}}},"ecs":{"version":"1.0.1"},"agent":{"type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1"},"stream":"stdout","input":{"type":"container"},"container":{"id":"9d280eb0a36e4977eabf56abd3c9c5ffb708b06d0d6538bafa1fa41060ad38ea","name":"kkm-commutator_service.1.m7ssfcwmousg94nnggw1yhb7u","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"host":{"name":"25805977eece"}}},{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"iLTul3MBfrYj4vM9J2qE","_score":3.7095509,"_source":{"@timestamp":"2020-07-29T00:17:09.132Z","message":"{\"ts\":\"2020-07-29T00:17:09.132+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"c08269c3925bea42\",\"spanId\":\"c08269c3925bea42\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"c08269c3925bea42\",\"X-B3-TraceId\":\"c08269c3925bea42\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","Version":"97","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","com_docker_swarm_task_id":"tfc8zap7xda72td18pqja05sp","com_docker_swarm_task_name":"kkm-commutator_service.1.tfc8zap7xda72td18pqja05sp","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_name":"kkm-commutator_service"}}},"host":{"name":"25805977eece"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"log":{"offset":41901711,"file":{"path":"/var/lib/docker/containers/c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5/c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5-json.log"}},"stream":"stdout","container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5","name":"kkm-commutator_service.1.tfc8zap7xda72td18pqja05sp"},"ecs":{"version":"1.0.1"}}},{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"QrTul3MBfrYj4vM9fXF2","_score":3.7095509,"_source":{"@timestamp":"2020-07-29T00:17:31.137Z","container":{"id":"c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5","name":"kkm-commutator_service.1.tfc8zap7xda72td18pqja05sp","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_stack_namespace":"kkm-commutator","Description":"KKM Commutator Service","Version":"97","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_id":"tfc8zap7xda72td18pqja05sp","com_docker_swarm_task_name":"kkm-commutator_service.1.tfc8zap7xda72td18pqja05sp"}}},"host":{"name":"25805977eece"},"stream":"stdout","message":"{\"ts\":\"2020-07-29T00:17:31.137+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"6dee41e4d13328a5\",\"spanId\":\"6dee41e4d13328a5\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"6dee41e4d13328a5\",\"X-B3-TraceId\":\"6dee41e4d13328a5\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","ecs":{"version":"1.0.1"},"agent":{"hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792"},"log":{"offset":41916611,"file":{"path":"/var/lib/docker/containers/c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5/c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5-json.log"}},"input":{"type":"container"}}}]}}
1194122 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0067'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0067'
1194144 [main] INFO  kkm.UnitTests - End test

1194145 [main] INFO  kkm.UnitTests - Starting test: KKM_DB8()
1194318 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-RRCBKF3EG5uk', '2937664815', '2019-07-12 00:00:00.000', '7710026574', 'NOFILIAL');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-RRCBKF3EG5uk','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-RRCBKF3EG5uk', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-RRCBKF3EG5uk', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-RRCBKF3EG5uk'

update alertPeriod set finishTime = '00:00:00' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '00:00:00' where FilialCode = 'NOFILIAL'
update fiscalCheck set filialCode = 'NOFILIAL' where srcId = '9SD0C9DZ-9289-4A09-RRCBKF3EG5uk'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-RRCBKF3EG5uk'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-RRCBKF3EG5uk'
1305143 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-RRCBKF3EG5uk'
1305143 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-RRCBKF3EG5uk, null]
1305145 [main] INFO  kkm.UnitTests - Status: null
1305145 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
1305145 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
1325146 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-stage-2020.07.29/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
1325483 [main] INFO  kkm.UnitTests - Response message : {"took":285,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":981,"relation":"eq"},"max_score":5.3757167,"hits":[{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"rf0XmXMBfrYj4vM9eFm9","_score":5.3757167,"_source":{"@timestamp":"2020-07-29T05:41:54.776Z","stream":"stdout","container":{"id":"10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91","name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","Version":"97","com_docker_swarm_task_id":"wsunza2qrd02kzp8b2jcnhwz4","com_docker_swarm_task_name":"kkm-commutator_service.1.wsunza2qrd02kzp8b2jcnhwz4","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_task":"","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service"}}},"ecs":{"version":"1.0.1"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"message":"{\"ts\":\"2020-07-29T05:41:54.776+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","log":{"file":{"path":"/var/lib/docker/containers/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91/10e6876b18b8cce75cad33d2b0cccefca9937167396c219db5512a76c2104a91-json.log"},"offset":774733},"input":{"type":"container"},"host":{"name":"25805977eece"}}},{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"B_sTmXMBfrYj4vM9CvsN","_score":5.3757167,"_source":{"@timestamp":"2020-07-29T05:37:04.465Z","stream":"stdout","message":"{\"ts\":\"2020-07-29T05:37:04.465+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","container":{"id":"62e2d31dcb80d736173fb7e85934038ac76ec61c312962d9634bd58d365f0c62","name":"kkm-commutator_service.1.2pbd7jxr2c7wllzbjwsph1jut","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"Version":"97","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"2pbd7jxr2c7wllzbjwsph1jut","com_docker_swarm_task":"","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task_name":"kkm-commutator_service.1.2pbd7jxr2c7wllzbjwsph1jut","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n"}}},"ecs":{"version":"1.0.1"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"log":{"offset":774748,"file":{"path":"/var/lib/docker/containers/62e2d31dcb80d736173fb7e85934038ac76ec61c312962d9634bd58d365f0c62/62e2d31dcb80d736173fb7e85934038ac76ec61c312962d9634bd58d365f0c62-json.log"}},"input":{"type":"container"},"host":{"name":"25805977eece"}}},{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"TfwVmXMBfrYj4vM9QrzI","_score":5.3757167,"_source":{"@timestamp":"2020-07-29T05:39:29.651Z","log":{"offset":774726,"file":{"path":"/var/lib/docker/containers/9d280eb0a36e4977eabf56abd3c9c5ffb708b06d0d6538bafa1fa41060ad38ea/9d280eb0a36e4977eabf56abd3c9c5ffb708b06d0d6538bafa1fa41060ad38ea-json.log"}},"message":"{\"ts\":\"2020-07-29T05:39:29.651+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","docker":{"container":{"labels":{"com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_task_id":"m7ssfcwmousg94nnggw1yhb7u","com_docker_swarm_task_name":"kkm-commutator_service.1.m7ssfcwmousg94nnggw1yhb7u","Version":"97"}}},"ecs":{"version":"1.0.1"},"agent":{"type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1"},"stream":"stdout","input":{"type":"container"},"container":{"id":"9d280eb0a36e4977eabf56abd3c9c5ffb708b06d0d6538bafa1fa41060ad38ea","name":"kkm-commutator_service.1.m7ssfcwmousg94nnggw1yhb7u","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"host":{"name":"25805977eece"}}},{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"iLTul3MBfrYj4vM9J2qE","_score":3.7092214,"_source":{"@timestamp":"2020-07-29T00:17:09.132Z","message":"{\"ts\":\"2020-07-29T00:17:09.132+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"c08269c3925bea42\",\"spanId\":\"c08269c3925bea42\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"c08269c3925bea42\",\"X-B3-TraceId\":\"c08269c3925bea42\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","Version":"97","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","com_docker_swarm_task_id":"tfc8zap7xda72td18pqja05sp","com_docker_swarm_task_name":"kkm-commutator_service.1.tfc8zap7xda72td18pqja05sp","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_name":"kkm-commutator_service"}}},"host":{"name":"25805977eece"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"log":{"offset":41901711,"file":{"path":"/var/lib/docker/containers/c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5/c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5-json.log"}},"stream":"stdout","container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5","name":"kkm-commutator_service.1.tfc8zap7xda72td18pqja05sp"},"ecs":{"version":"1.0.1"}}},{"_index":"kkm-commutator-stage-2020.07.29","_type":"_doc","_id":"QrTul3MBfrYj4vM9fXF2","_score":3.7092214,"_source":{"@timestamp":"2020-07-29T00:17:31.137Z","container":{"id":"c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5","name":"kkm-commutator_service.1.tfc8zap7xda72td18pqja05sp","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_stack_namespace":"kkm-commutator","Description":"KKM Commutator Service","Version":"97","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_id":"tfc8zap7xda72td18pqja05sp","com_docker_swarm_task_name":"kkm-commutator_service.1.tfc8zap7xda72td18pqja05sp"}}},"host":{"name":"25805977eece"},"stream":"stdout","message":"{\"ts\":\"2020-07-29T00:17:31.137+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"6dee41e4d13328a5\",\"spanId\":\"6dee41e4d13328a5\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"6dee41e4d13328a5\",\"X-B3-TraceId\":\"6dee41e4d13328a5\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","ecs":{"version":"1.0.1"},"agent":{"hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792"},"log":{"offset":41916611,"file":{"path":"/var/lib/docker/containers/c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5/c87b0cb3741001705e46f06100dcbb96f6873150512bc54b78c6b2e3515bf8e5-json.log"}},"input":{"type":"container"}}}]}}
1325646 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = 'NOFILIAL'
1325669 [main] INFO  kkm.UnitTests - End test

1325671 [main] INFO  kkm.UnitTests - Starting test: KKM_SendMessageWasCanceled()
1328383 [main] INFO  kkm.UnitTests - 
Sending 'GET' request to URL : http://esb-stage:8501/cxf/rest/api/v1/kkm/receipts/ddfea0c2-c381-4860-bcd8-df2516314ffd/messages/email/EPolikarpova@VSK.RU
1328383 [main] INFO  kkm.UnitTests - Response Code : 400
1328383 [main] INFO  kkm.UnitTests - {"checkId":"ddfea0c2-c381-4860-bcd8-df2516314ffd","error":{"code":"CHECK_WAS_CANCELLED","message":"Receipt was already cancelled"}}
1328384 [main] INFO  kkm.UnitTests - End test

1328386 [main] INFO  kkm.UnitTests - Starting test: KKM_CanceleNotFound()
1328585 [main] INFO  kkm.UnitTests - End test

1328586 [main] INFO  kkm.UnitTests - Starting test: KKM_makeAndCancelCheckCashier()
1585471 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/esb-stage-2020.07.29/_search?q=%20message:%20%22CID=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72%22%20
1585609 [main] INFO  kkm.UnitTests - Response message : {"took":13,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":8,"relation":"eq"},"max_score":47.80521,"hits":[{"_index":"esb-stage-2020.07.29","_type":"_doc","_id":"ckOimXMBfrYj4vM9SanO","_score":47.80521,"_source":{"level":"trace","input":{"type":"log"},"tags":["beats_input_codec_plain_applied"],"application":"esb","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"offset":2545932,"beat":{"name":"esb-stage","hostname":"esb-stage","version":"6.8.6"},"@timestamp":"2020-07-29T08:13:29.697Z","timestamp":"2020-07-29T11:13:29,697","thread":"qtp524044206-7071","message":"KkmService: REST request  Operation 'CancelReceipt' was call with body: 9b386d47-efb8-4245-978d-a24c1422f1a2 | exid=ID-esb-stage-42112-1596001282592-55-14157 CID=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72","environment":"stage","source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log","@version":"1","bundleid":"27766","host":{"name":"esb-stage"},"prospector":{"type":"log"},"package":"servicemix.esb.kkm"}},{"_index":"esb-stage-2020.07.29","_type":"_doc","_id":"lEOimXMBfrYj4vM9hML1","_score":45.56524,"_source":{"level":"trace","input":{"type":"log"},"tags":["beats_input_codec_plain_applied"],"application":"esb","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"offset":2550064,"@timestamp":"2020-07-29T08:13:29.770Z","beat":{"version":"6.8.6","name":"esb-stage","hostname":"esb-stage"},"timestamp":"2020-07-29T11:13:29,770","thread":"qtp524044206-7071","message":"KkmService: REST response Operation 'CancelReceipt' was complete with body: CancelReceiptResponse{correlationId='null', checkId='9b386d47-efb8-4245-978d-a24c1422f1a2', canceledCheckId='ee13660f-3922-4cfe-a456-223d6d1ad49c', error=null} | exid=ID-esb-stage-42112-1596001282592-55-14157 CID=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72","environment":"stage","source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log","@version":"1","bundleid":"27766","host":{"name":"esb-stage"},"prospector":{"type":"log"},"package":"servicemix.esb.kkm"}},{"_index":"esb-stage-2020.07.29","_type":"_doc","_id":"0UOimXMBfrYj4vM9Sang","_score":44.522167,"_source":{"level":"debug","input":{"type":"log"},"tags":["beats_input_codec_plain_applied"],"application":"esb","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"offset":2545453,"beat":{"name":"esb-stage","hostname":"esb-stage","version":"6.8.6"},"@timestamp":"2020-07-29T08:13:29.697Z","timestamp":"2020-07-29T11:13:29,697","thread":"qtp524044206-7071","message":"KkmService: REST request  Operation 'CancelReceipt' was call with headers: {breadcrumbId=ID-esb-stage-42112-1596001282592-55-14156, JMSCorrelationID=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72, operationName=CancelReceipt, X-VSK-CorrelationId=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72} | exid=ID-esb-stage-42112-1596001282592-55-14157 CID=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72","environment":"stage","source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log","@version":"1","bundleid":"27766","host":{"name":"esb-stage"},"prospector":{"type":"log"},"package":"servicemix.esb.kkm"}},{"_index":"esb-stage-2020.07.29","_type":"_doc","_id":"fUOimXMBfrYj4vM9SanS","_score":42.264633,"_source":{"level":"debug","input":{"type":"log"},"tags":["beats_input_codec_plain_applied"],"application":"esb","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"offset":2546244,"beat":{"hostname":"esb-stage","version":"6.8.6","name":"esb-stage"},"@timestamp":"2020-07-29T08:13:29.698Z","timestamp":"2020-07-29T11:13:29,698","thread":"thread #1896 - seda://kkmRestAPI","message":"KkmService: 'CancelReceipt' calling REST service  with headers: {breadcrumbId=ID-esb-stage-42112-1596001282592-55-14156, CamelHttpMethod=PUT, JMSCorrelationID=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72, operationName=CancelReceipt, UnitariusServiceUri=http://rcptss-api-tst.vsk.ru/master-system/api/v1/receipts/9b386d47-efb8-4245-978d-a24c1422f1a2/cancel, X-VSK-CorrelationId=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72} | exId=ID-esb-stage-42112-1596001282592-55-14159 CID=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72","environment":"stage","source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log","@version":"1","bundleid":"27766","host":{"name":"esb-stage"},"prospector":{"type":"log"},"package":"servicemix.esb.kkm"}},{"_index":"esb-stage-2020.07.29","_type":"_doc","_id":"iUOimXMBfrYj4vM9SanV","_score":41.074512,"_source":{"level":"trace","input":{"type":"log"},"tags":["beats_input_codec_plain_applied"],"application":"esb","log":{"flags":["multiline"],"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"offset":2546857,"beat":{"name":"esb-stage","hostname":"esb-stage","version":"6.8.6"},"@timestamp":"2020-07-29T08:13:29.698Z","timestamp":"2020-07-29T11:13:29,698","thread":"thread #1896 - seda://kkmRestAPI","message":"KkmService: 'CancelReceipt' calling REST service  with headers: {breadcrumbId=ID-esb-stage-42112-1596001282592-55-14156, CamelHttpMethod=PUT, JMSCorrelationID=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72, operationName=CancelReceipt, UnitariusServiceUri=http://rcptss-api-tst.vsk.ru/master-system/api/v1/receipts/9b386d47-efb8-4245-978d-a24c1422f1a2/cancel, X-VSK-CorrelationId=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72} | exId=ID-esb-stage-42112-1596001282592-55-14159 CID=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72 |\n 9b386d47-efb8-4245-978d-a24c1422f1a2","environment":"stage","source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log","@version":"1","bundleid":"27766","host":{"name":"esb-stage"},"prospector":{"type":"log"},"package":"servicemix.esb.kkm"}},{"_index":"esb-stage-2020.07.29","_type":"_doc","_id":"fkOimXMBfrYj4vM9SanS","_score":38.37315,"_source":{"level":"debug","input":{"type":"log"},"tags":["beats_input_codec_plain_applied"],"application":"esb","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"offset":2549237,"@timestamp":"2020-07-29T08:13:29.770Z","beat":{"name":"esb-stage","hostname":"esb-stage","version":"6.8.6"},"timestamp":"2020-07-29T11:13:29,770","thread":"qtp524044206-7071","message":"KkmService: REST response Operation 'CancelReceipt' was complete with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-stage-42112-1596001282592-55-14156, CamelHttpMethod=PUT, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Type=application/json;charset=utf-8, Date=Wed, 29 Jul 2020 08:13:30 GMT, JMSCorrelationID=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72, operationName=CancelReceipt, Transfer-Encoding=chunked, UnitariusServiceUri=http://rcptss-api-tst.vsk.ru/master-system/api/v1/receipts/9b386d47-efb8-4245-978d-a24c1422f1a2/cancel, X-VSK-CorrelationId=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72} | exid=ID-esb-stage-42112-1596001282592-55-14157 CID=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72","environment":"stage","source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log","@version":"1","bundleid":"27766","host":{"name":"esb-stage"},"prospector":{"type":"log"},"package":"servicemix.esb.kkm"}},{"_index":"esb-stage-2020.07.29","_type":"_doc","_id":"0kOimXMBfrYj4vM9Sang","_score":38.37315,"_source":{"level":"debug","input":{"type":"log"},"tags":["beats_input_codec_plain_applied"],"application":"esb","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"offset":2547510,"@timestamp":"2020-07-29T08:13:29.770Z","beat":{"name":"esb-stage","hostname":"esb-stage","version":"6.8.6"},"timestamp":"2020-07-29T11:13:29,770","thread":"thread #1896 - seda://kkmRestAPI","message":"KkmService: 'CancelReceipt' service responded with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-stage-42112-1596001282592-55-14156, CamelHttpMethod=PUT, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Type=application/json;charset=utf-8, Date=Wed, 29 Jul 2020 08:13:30 GMT, JMSCorrelationID=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72, operationName=CancelReceipt, Transfer-Encoding=chunked, UnitariusServiceUri=http://rcptss-api-tst.vsk.ru/master-system/api/v1/receipts/9b386d47-efb8-4245-978d-a24c1422f1a2/cancel, X-VSK-CorrelationId=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72} | exid=ID-esb-stage-42112-1596001282592-55-14159 CID=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72","environment":"stage","source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log","@version":"1","bundleid":"27766","host":{"name":"esb-stage"},"prospector":{"type":"log"},"package":"servicemix.esb.kkm"}},{"_index":"esb-stage-2020.07.29","_type":"_doc","_id":"c0OimXMBfrYj4vM9SanO","_score":37.38955,"_source":{"level":"trace","input":{"type":"log"},"tags":["beats_input_codec_plain_applied"],"application":"esb","log":{"flags":["multiline"],"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"offset":2548318,"beat":{"name":"esb-stage","hostname":"esb-stage","version":"6.8.6"},"@timestamp":"2020-07-29T08:13:29.770Z","timestamp":"2020-07-29T11:13:29,770","thread":"thread #1896 - seda://kkmRestAPI","message":"KkmService: 'CancelReceipt' service responded with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-stage-42112-1596001282592-55-14156, CamelHttpMethod=PUT, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Type=application/json;charset=utf-8, Date=Wed, 29 Jul 2020 08:13:30 GMT, JMSCorrelationID=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72, operationName=CancelReceipt, Transfer-Encoding=chunked, UnitariusServiceUri=http://rcptss-api-tst.vsk.ru/master-system/api/v1/receipts/9b386d47-efb8-4245-978d-a24c1422f1a2/cancel, X-VSK-CorrelationId=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72} | exid=ID-esb-stage-42112-1596001282592-55-14159 CID=b29fa7cb-cf5a-4f68-b4b7-53b66b8945b72 |\n {\"checkId\":\"9b386d47-efb8-4245-978d-a24c1422f1a2\",\"canceledCheckId\":\"ee13660f-3922-4cfe-a456-223d6d1ad49c\"}","environment":"stage","source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log","@version":"1","bundleid":"27766","host":{"name":"esb-stage"},"prospector":{"type":"log"},"package":"servicemix.esb.kkm"}}]}}
1585610 [main] INFO  kkm.UnitTests - End test

1585612 [main] INFO  kkm.UnitTests - Starting test: KKM_SIPheckStatus()
1590223 [main] INFO  kkm.UnitTests - End test

1590228 [main] INFO  kkm.UnitTests - Starting test: KKM_SendMessageNotFound()
1590376 [main] INFO  kkm.UnitTests - 
Sending 'GET' request to URL : http://esb-stage:8501/cxf/rest/api/v1/kkm/receipts/fa23215b-6994-43db-88dd-fa3a1dc0dfb6/messages/email/EPolikarpova@VSK.RU
1590376 [main] INFO  kkm.UnitTests - Response Code : 400
1590376 [main] INFO  kkm.UnitTests - {"checkId":"fa23215b-6994-43db-88dd-fa3a1dc0dfb6","error":{"code":"RECEIPT_NOTE_FOUND","message":"Receipt with specified ID not found"}}
1590377 [main] INFO  kkm.UnitTests - End test

1590378 [main] INFO  kkm.UnitTests - Starting test: KKM_PostCorrectionReceipt_negative()
1590453 [main] INFO  kkm.UnitTests - End test

1590454 [main] INFO  kkm.UnitTests - Starting test: KKM_PostCorrectionReceipt()
1593155 [main] INFO  kkm.UnitTests - End test

