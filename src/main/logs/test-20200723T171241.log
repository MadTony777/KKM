168  [main] INFO  kkm.UnitTests - Starting test: KKM_makeCheckNoCashier()
4327 [main] INFO  kkm.UnitTests - End test

4342 [main] INFO  kkm.UnitTests - Starting test: KKM_SendMessageEmail()
279137 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/esb-test-2020.07.23/_search?q=%20message:%20%22CID=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611%22%20
279631 [main] INFO  kkm.UnitTests - Response message : {"took":377,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":8,"relation":"eq"},"max_score":54.537125,"hits":[{"_index":"esb-test-2020.07.23","_type":"_doc","_id":"2GfOe3MBtD96ebe8iStU","_score":54.537125,"_source":{"level":"trace","@timestamp":"2020-07-23T13:13:20.753Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST response Operation 'SendMessage' was complete with body: ReceiptResponse{correlationId='null', checkId='4601b7e4-3326-4635-b83c-722fecf9f865', error=null} | exid=ID-esb-test01-40739-1595408253463-71-120054 CID=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611","thread":"qtp1489557672-107375","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"37973","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-23T16:13:20,753","input":{"type":"log"},"offset":338846841,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.23","_type":"_doc","_id":"xGfOe3MBtD96ebe8iStU","_score":54.353924,"_source":{"level":"trace","@timestamp":"2020-07-23T13:13:20.722Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST request  Operation 'SendMessage' was call with body: SendMessageRequest{checkId='4601b7e4-3326-4635-b83c-722fecf9f865', messageType='email', messageAddress='EPolikarpova@VSK.RU'} | exid=ID-esb-test01-40739-1595408253463-71-120054 CID=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611","thread":"qtp1489557672-107375","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"37973","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-23T16:13:20,722","input":{"type":"log"},"offset":338757788,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.23","_type":"_doc","_id":"w2fOe3MBtD96ebe8iStU","_score":52.41705,"_source":{"level":"debug","@timestamp":"2020-07-23T13:13:20.722Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST request  Operation 'SendMessage' was call with headers: {breadcrumbId=ID-esb-test01-40739-1595408253463-71-120053, JMSCorrelationID=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611, operationName=SendMessage, X-VSK-CorrelationId=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611} | exid=ID-esb-test01-40739-1595408253463-71-120054 CID=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611","thread":"qtp1489557672-107375","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"37973","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-23T16:13:20,722","input":{"type":"log"},"offset":338757306,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.23","_type":"_doc","_id":"xWfOe3MBtD96ebe8iStU","_score":49.528976,"_source":{"level":"debug","@timestamp":"2020-07-23T13:13:20.723Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'SendMessage' calling REST service  with headers: {breadcrumbId=ID-esb-test01-40739-1595408253463-71-120053, CamelHttpMethod=GET, JMSCorrelationID=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611, operationName=SendMessage, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/4601b7e4-3326-4635-b83c-722fecf9f865/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611} | exId=ID-esb-test01-40739-1595408253463-71-120056 CID=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611","thread":"thread #4072 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"37973","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-23T16:13:20,723","input":{"type":"log"},"offset":338758190,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.23","_type":"_doc","_id":"xmfOe3MBtD96ebe8iStU","_score":49.528976,"_source":{"level":"trace","@timestamp":"2020-07-23T13:13:20.723Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'SendMessage' calling REST service  with headers: {breadcrumbId=ID-esb-test01-40739-1595408253463-71-120053, CamelHttpMethod=GET, JMSCorrelationID=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611, operationName=SendMessage, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/4601b7e4-3326-4635-b83c-722fecf9f865/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611} | exId=ID-esb-test01-40739-1595408253463-71-120056 CID=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611 |\n ","thread":"thread #4072 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"37973","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"},"flags":["multiline"]},"@version":"1","environment":"test","timestamp":"2020-07-23T16:13:20,723","input":{"type":"log"},"offset":338758825,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.23","_type":"_doc","_id":"1WfOe3MBtD96ebe8iStU","_score":45.110317,"_source":{"level":"debug","@timestamp":"2020-07-23T13:13:20.752Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'SendMessage' service responded with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-40739-1595408253463-71-120053, CamelHttpMethod=GET, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Disposition=inline;filename=f.txt, Content-Type=application/json;charset=utf-8, Date=Thu, 23 Jul 2020 13:13:20 GMT, JMSCorrelationID=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611, operationName=SendMessage, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/4601b7e4-3326-4635-b83c-722fecf9f865/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611} | exid=ID-esb-test01-40739-1595408253463-71-120056 CID=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611","thread":"thread #4072 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"37973","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-23T16:13:20,752","input":{"type":"log"},"offset":338844149,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.23","_type":"_doc","_id":"12fOe3MBtD96ebe8iStU","_score":45.110317,"_source":{"level":"debug","@timestamp":"2020-07-23T13:13:20.753Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST response Operation 'SendMessage' was complete with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-40739-1595408253463-71-120053, CamelHttpMethod=GET, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Disposition=inline;filename=f.txt, Content-Type=application/json;charset=utf-8, Date=Thu, 23 Jul 2020 13:13:20 GMT, JMSCorrelationID=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611, operationName=SendMessage, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/4601b7e4-3326-4635-b83c-722fecf9f865/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611} | exid=ID-esb-test01-40739-1595408253463-71-120054 CID=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611","thread":"qtp1489557672-107375","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"37973","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-23T16:13:20,753","input":{"type":"log"},"offset":338845949,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.23","_type":"_doc","_id":"1mfOe3MBtD96ebe8iStU","_score":44.126156,"_source":{"level":"trace","@timestamp":"2020-07-23T13:13:20.752Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'SendMessage' service responded with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-40739-1595408253463-71-120053, CamelHttpMethod=GET, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Disposition=inline;filename=f.txt, Content-Type=application/json;charset=utf-8, Date=Thu, 23 Jul 2020 13:13:20 GMT, JMSCorrelationID=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611, operationName=SendMessage, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/4601b7e4-3326-4635-b83c-722fecf9f865/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611} | exid=ID-esb-test01-40739-1595408253463-71-120056 CID=c11d3f22-9c93-47a3-a20e-9dbde29ebb5611 |\n {\"checkId\":\"4601b7e4-3326-4635-b83c-722fecf9f865\"}","thread":"thread #4072 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"37973","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"},"flags":["multiline"]},"@version":"1","environment":"test","timestamp":"2020-07-23T16:13:20,752","input":{"type":"log"},"offset":338845022,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}}]}}
279633 [main] INFO  kkm.UnitTests - End test

279636 [main] INFO  kkm.UnitTests - Starting test: KKM_WAcheckStatus()
279865 [main] INFO  kkm.UnitTests - End test

279877 [main] INFO  kkm.UnitTests - Starting test: KKM_getStatus()
282213 [main] INFO  kkm.UnitTests - End test

282217 [main] INFO  kkm.UnitTests - Starting test: KKM_CanceledAlredy()
285519 [main] INFO  kkm.UnitTests - End test

285523 [main] INFO  kkm.UnitTests - Starting test: KKM_getDocCustomer()
285750 [main] INFO  kkm.UnitTests - End test

285754 [main] INFO  kkm.UnitTests - Starting test: KKM_makeCheckCashier()
289553 [main] INFO  kkm.UnitTests - End test

289557 [main] INFO  kkm.UnitTests - Starting test: KKM_DB1()
290046 [main] INFO  kkm.UnitTests - Script is: SELECT TOP 1 * FROM ProcessStatus Where fiscGateCheckStatusCode = 'ERROR'
290051 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000902849
290052 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000902849
290627 [main] INFO  kkm.UnitTests - update dbo.Customer set inn = '1' where srcID = 'ЖПлато_000902849'
update ProcessStatus set fiscGateCheckStatusCode = null where srcID = 'ЖПлато_000902849'
select * from ProcessStatus where srcID = 'ЖПлато_000902849'
290629 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, null, VALIDATION_ERROR, ЖПлато_000902849]
290632 [main] INFO  kkm.UnitTests - Status is: [AXAPTA, PaymentOrder, null, VALIDATION_ERROR, ЖПлато_000902849]
350894 [main] INFO  kkm.UnitTests - select * from ProcessStatus where srcID = 'ЖПлато_000902849'
350895 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, ERROR, VALIDATION_ERROR, ЖПлато_000902849]
410904 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.23/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%22ЖПлато_000902849%22%20&size=500
410977 [main] INFO  kkm.UnitTests - Response message : {"took":10,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":5,"relation":"eq"},"max_score":11.568482,"hits":[{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"jxQBe3MBtD96ebe8DGrF","_score":11.568482,"_source":{"@timestamp":"2020-07-23T09:28:49.823Z","log":{"offset":34575958,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","Description":"KKM Commutator Service","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_swarm_task":""}}},"json":{"X-Span-Export":"true","X-B3-TraceId":"ba9c347a348eedd3","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys","caller_line_number":84,"spanExportable":"true","level":"INFO","caller_file_name":"KkmCommutatorService.java","msg":"ReadyForSendingReceiptKeys selected ","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","traceId":"ba9c347a348eedd3","X-VSK-ReceiptKeys":[{"systemCode":"AXAPTA","entityCode":"PaymentOrder","srcID":"ЖПлато_000902849"}],"ts":"2020-07-23T09:28:49.822+00:00","thread":"scheduling-1","spanId":"ba9c347a348eedd3","X-B3-SpanId":"ba9c347a348eedd3"},"stream":"stdout","message":"{\"ts\":\"2020-07-23T09:28:49.822+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"ba9c347a348eedd3\",\"spanId\":\"ba9c347a348eedd3\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"ba9c347a348eedd3\",\"X-B3-TraceId\":\"ba9c347a348eedd3\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000902849\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","host":{"name":"44fcff07405a"},"agent":{"id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"1uGOenMBtD96ebe8mjkx","_score":11.568482,"_source":{"@timestamp":"2020-07-23T07:23:50.708Z","agent":{"type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1"},"json":{"method":"getReadyForSendingReceiptKeys","msg":"ReadyForSendingReceiptKeys selected ","level":"INFO","thread":"scheduling-1","traceId":"e0a169dc88e9586a","spanId":"e0a169dc88e9586a","X-B3-SpanId":"e0a169dc88e9586a","caller_file_name":"KkmCommutatorService.java","caller_line_number":84,"spanExportable":"true","X-VSK-ReceiptKeys":[{"systemCode":"AXAPTA","entityCode":"PaymentOrder","srcID":"ЖПлато_000902849"}],"ts":"2020-07-23T07:23:50.708+00:00","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","X-Span-Export":"true","X-B3-TraceId":"e0a169dc88e9586a"},"log":{"offset":31378509,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"input":{"type":"container"},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"},"stream":"stdout","message":"{\"ts\":\"2020-07-23T07:23:50.708+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"e0a169dc88e9586a\",\"spanId\":\"e0a169dc88e9586a\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"e0a169dc88e9586a\",\"X-B3-TraceId\":\"e0a169dc88e9586a\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000902849\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_swarm_task":"","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","Description":"KKM Commutator Service","Version":"97"}}}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"PvG0enMBtD96ebe8IahY","_score":11.568482,"_source":{"@timestamp":"2020-07-23T08:04:49.967Z","log":{"offset":32488441,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_swarm_task":"","Description":"KKM Commutator Service","Version":"97"}}},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"},"agent":{"ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat"},"stream":"stdout","message":"{\"ts\":\"2020-07-23T08:04:49.967+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"feec16fc740e2caf\",\"spanId\":\"feec16fc740e2caf\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"feec16fc740e2caf\",\"X-B3-TraceId\":\"feec16fc740e2caf\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000902849\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","json":{"logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_line_number":84,"traceId":"feec16fc740e2caf","X-B3-SpanId":"feec16fc740e2caf","X-B3-TraceId":"feec16fc740e2caf","msg":"ReadyForSendingReceiptKeys selected ","ts":"2020-07-23T08:04:49.967+00:00","X-Span-Export":"true","thread":"scheduling-1","method":"getReadyForSendingReceiptKeys","caller_file_name":"KkmCommutatorService.java","spanId":"feec16fc740e2caf","level":"INFO","X-VSK-ReceiptKeys":[{"srcID":"ЖПлато_000902849","systemCode":"AXAPTA","entityCode":"PaymentOrder"}],"spanExportable":"true"}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"42HFe3MBtD96ebe86cBG","_score":11.568482,"_source":{"@timestamp":"2020-07-23T13:03:50.177Z","agent":{"ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat"},"log":{"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"},"offset":40199153},"host":{"name":"44fcff07405a"},"input":{"type":"container"},"container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3"},"docker":{"container":{"labels":{"com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_swarm_service_name":"kkm-commutator_service","Version":"97","com_docker_swarm_task":""}}},"ecs":{"version":"1.0.1"},"json":{"ts":"2020-07-23T13:03:50.177+00:00","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_file_name":"KkmCommutatorService.java","X-B3-TraceId":"b568ba1e7af35ecd","msg":"ReadyForSendingReceiptKeys selected ","level":"INFO","caller_line_number":84,"spanId":"b568ba1e7af35ecd","spanExportable":"true","method":"getReadyForSendingReceiptKeys","thread":"scheduling-1","traceId":"b568ba1e7af35ecd","X-B3-SpanId":"b568ba1e7af35ecd","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","X-Span-Export":"true","X-VSK-ReceiptKeys":[{"systemCode":"AXAPTA","entityCode":"PaymentOrder","srcID":"ЖПлато_000902849"}]},"stream":"stdout","message":"{\"ts\":\"2020-07-23T13:03:50.177+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"b568ba1e7af35ecd\",\"spanId\":\"b568ba1e7af35ecd\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"b568ba1e7af35ecd\",\"X-B3-TraceId\":\"b568ba1e7af35ecd\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000902849\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}"}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"wWrSe3MBtD96ebe8xiDE","_score":11.568482,"_source":{"@timestamp":"2020-07-23T13:17:50.157Z","json":{"level":"INFO","X-B3-SpanId":"0aaa496655531c95","X-VSK-ReceiptKeys":[{"systemCode":"AXAPTA","entityCode":"PaymentOrder","srcID":"ЖПлато_000902849"}],"ts":"2020-07-23T13:17:50.157+00:00","spanId":"0aaa496655531c95","spanExportable":"true","X-Span-Export":"true","method":"getReadyForSendingReceiptKeys","caller_line_number":84,"thread":"scheduling-1","traceId":"0aaa496655531c95","msg":"ReadyForSendingReceiptKeys selected ","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_file_name":"KkmCommutatorService.java","X-B3-TraceId":"0aaa496655531c95"},"log":{"offset":40615709,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"stream":"stdout","message":"{\"ts\":\"2020-07-23T13:17:50.157+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"0aaa496655531c95\",\"spanId\":\"0aaa496655531c95\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"0aaa496655531c95\",\"X-B3-TraceId\":\"0aaa496655531c95\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000902849\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3"},"docker":{"container":{"labels":{"com_docker_swarm_task":"","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","Version":"97"}}},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"},"input":{"type":"container"},"agent":{"id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a"}}}]}}
410978 [main] INFO  kkm.UnitTests - End test

410979 [main] INFO  kkm.UnitTests - Starting test: KKM_DB2()
411826 [main] INFO  kkm.UnitTests - Script is: SELECT TOP 1 * FROM ProcessStatus Where fiscGateCheckStatusCode = 'DONE'
411826 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000898541
411829 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000898541
412491 [main] INFO  kkm.UnitTests - update alertPeriod set finishTime = '00:00:00' where FilialCode = '--filialCode--'
update alertPeriod set startTime = '00:00:00' where FilialCode = '--filialCode--'
update customer set Phone = '70000000000' where srcID = 'ЖПлато_000898541'
update customer set email = '' where srcId = 'ЖПлато_000898541'
update processStatus set fiscGateCheckStatusCode = null where srcID = 'ЖПлато_000898541'
select * from processStatus where srcID = 'ЖПлато_000898541'
412491 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, null, nothing, ЖПлато_000898541]
412494 [main] INFO  kkm.UnitTests - Status is: [AXAPTA, PaymentOrder, null, nothing, ЖПлато_000898541]
472763 [main] INFO  kkm.UnitTests - select * from ProcessStatus where srcID = 'ЖПлато_000898541'
472764 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, DONE, nothing, ЖПлато_000898541]
532771 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.23/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%22ЖПлато_000898541%22%20&size=500
532836 [main] INFO  kkm.UnitTests - Response message : {"took":6,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":5,"relation":"eq"},"max_score":10.721579,"hits":[{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"6-OUenMBtD96ebe8GMWs","_score":10.721579,"_source":{"@timestamp":"2020-07-23T07:29:50.181Z","log":{"offset":31625793,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"input":{"type":"container"},"agent":{"id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a"},"message":"{\"ts\":\"2020-07-23T07:29:50.180+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"2b794883727bed5a\",\"spanId\":\"2b794883727bed5a\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"2b794883727bed5a\",\"X-B3-TraceId\":\"2b794883727bed5a\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000898541\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_task":"","Version":"97"}}},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"},"json":{"ts":"2020-07-23T07:29:50.180+00:00","X-VSK-ReceiptKeys":[{"systemCode":"AXAPTA","entityCode":"PaymentOrder","srcID":"ЖПлато_000898541"}],"class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys","traceId":"2b794883727bed5a","level":"INFO","caller_line_number":84,"spanExportable":"true","X-B3-SpanId":"2b794883727bed5a","X-B3-TraceId":"2b794883727bed5a","msg":"ReadyForSendingReceiptKeys selected ","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_file_name":"KkmCommutatorService.java","thread":"scheduling-1","spanId":"2b794883727bed5a","X-Span-Export":"true"},"stream":"stdout"}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"rvS6enMBtD96ebe8imgA","_score":10.721579,"_source":{"@timestamp":"2020-07-23T08:11:50.430Z","stream":"stdout","docker":{"container":{"labels":{"com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task":"","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","Version":"97","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator"}}},"host":{"name":"44fcff07405a"},"message":"{\"ts\":\"2020-07-23T08:11:50.430+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"d012804c97f1787f\",\"spanId\":\"d012804c97f1787f\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"d012804c97f1787f\",\"X-B3-TraceId\":\"d012804c97f1787f\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000898541\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","log":{"offset":32784623,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"agent":{"ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat"},"ecs":{"version":"1.0.1"},"json":{"class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","X-B3-SpanId":"d012804c97f1787f","X-B3-TraceId":"d012804c97f1787f","method":"getReadyForSendingReceiptKeys","caller_line_number":84,"traceId":"d012804c97f1787f","spanId":"d012804c97f1787f","ts":"2020-07-23T08:11:50.430+00:00","X-Span-Export":"true","X-VSK-ReceiptKeys":[{"srcID":"ЖПлато_000898541","systemCode":"AXAPTA","entityCode":"PaymentOrder"}],"spanExportable":"true","msg":"ReadyForSendingReceiptKeys selected ","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","level":"INFO","caller_file_name":"KkmCommutatorService.java","thread":"scheduling-1"},"input":{"type":"container"},"container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3"}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"qxcHe3MBtD96ebe8fC0C","_score":10.721579,"_source":{"@timestamp":"2020-07-23T09:35:51.290Z","container":{"name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31"},"docker":{"container":{"labels":{"com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_swarm_task":"","Description":"KKM Commutator Service","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","Version":"97"}}},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"},"stream":"stdout","log":{"offset":34879089,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"input":{"type":"container"},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"},"json":{"class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_file_name":"KkmCommutatorService.java","msg":"ReadyForSendingReceiptKeys selected ","method":"getReadyForSendingReceiptKeys","thread":"scheduling-1","spanExportable":"true","X-Span-Export":"true","spanId":"2afc2c147353c4c9","X-B3-SpanId":"2afc2c147353c4c9","ts":"2020-07-23T09:35:51.289+00:00","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_line_number":84,"traceId":"2afc2c147353c4c9","level":"INFO","X-B3-TraceId":"2afc2c147353c4c9","X-VSK-ReceiptKeys":[{"systemCode":"AXAPTA","entityCode":"PaymentOrder","srcID":"ЖПлато_000898541"}]},"message":"{\"ts\":\"2020-07-23T09:35:51.289+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"2afc2c147353c4c9\",\"spanId\":\"2afc2c147353c4c9\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"2afc2c147353c4c9\",\"X-B3-TraceId\":\"2afc2c147353c4c9\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000898541\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}"}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"ZGLHe3MBtD96ebe8ybnR","_score":10.721579,"_source":{"@timestamp":"2020-07-23T13:05:50.378Z","stream":"stdout","input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service"}}},"agent":{"type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1"},"json":{"spanExportable":"true","X-Span-Export":"true","X-VSK-ReceiptKeys":[{"systemCode":"AXAPTA","entityCode":"PaymentOrder","srcID":"ЖПлато_000898541"}],"msg":"ReadyForSendingReceiptKeys selected ","level":"INFO","traceId":"5da8fcafe48a21db","spanId":"5da8fcafe48a21db","ts":"2020-07-23T13:05:50.378+00:00","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_line_number":84,"X-B3-TraceId":"5da8fcafe48a21db","method":"getReadyForSendingReceiptKeys","thread":"scheduling-1","X-B3-SpanId":"5da8fcafe48a21db","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_file_name":"KkmCommutatorService.java"},"log":{"offset":40265567,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"message":"{\"ts\":\"2020-07-23T13:05:50.378+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"5da8fcafe48a21db\",\"spanId\":\"5da8fcafe48a21db\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"5da8fcafe48a21db\",\"X-B3-TraceId\":\"5da8fcafe48a21db\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000898541\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"EWvUe3MBtD96ebe8m16U","_score":10.721579,"_source":{"@timestamp":"2020-07-23T13:19:50.248Z","log":{"offset":40680654,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"stream":"stdout","container":{"name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31"},"docker":{"container":{"labels":{"com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","Description":"KKM Commutator Service","Version":"97","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_swarm_task":"","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3"}}},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"},"host":{"name":"44fcff07405a"},"json":{"class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","X-Span-Export":"true","ts":"2020-07-23T13:19:50.248+00:00","method":"getReadyForSendingReceiptKeys","caller_file_name":"KkmCommutatorService.java","spanExportable":"true","msg":"ReadyForSendingReceiptKeys selected ","level":"INFO","traceId":"16084691a284e1ee","spanId":"16084691a284e1ee","X-B3-SpanId":"16084691a284e1ee","X-B3-TraceId":"16084691a284e1ee","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","thread":"scheduling-1","X-VSK-ReceiptKeys":[{"systemCode":"AXAPTA","entityCode":"PaymentOrder","srcID":"ЖПлато_000898541"}],"caller_line_number":84},"message":"{\"ts\":\"2020-07-23T13:19:50.248+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"16084691a284e1ee\",\"spanId\":\"16084691a284e1ee\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"16084691a284e1ee\",\"X-B3-TraceId\":\"16084691a284e1ee\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000898541\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","input":{"type":"container"},"ecs":{"version":"1.0.1"}}}]}}
532837 [main] INFO  kkm.UnitTests - End test

532840 [main] INFO  kkm.UnitTests - Starting test: KKM_DB3()
532982 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-dpzCJBsewr3n', '7263558675', '2019-07-12 00:00:00.000', '7710026574', '0031');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-dpzCJBsewr3n','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-dpzCJBsewr3n', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-dpzCJBsewr3n', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-dpzCJBsewr3n'

update alertPeriod set finishTime = '23:59:59' where FilialCode = '0031'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0031'
update fiscalCheck set filialCode = '0031' where srcId = '9SD0C9DZ-9289-4A09-dpzCJBsewr3n'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-dpzCJBsewr3n'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-dpzCJBsewr3n'
623737 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-dpzCJBsewr3n'
623738 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-dpzCJBsewr3n, null]
623741 [main] INFO  kkm.UnitTests - Status: null
623741 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
623741 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
624116 [main] INFO  kkm.UnitTests - End test

624122 [main] INFO  kkm.UnitTests - Starting test: KKM_DB4()
624261 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-nmazWSJP8ZqX', '3709169478', '2019-07-12 00:00:00.000', '7725327863', '0067');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-nmazWSJP8ZqX','Фамилия Имя Отчество', '7725327863', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-nmazWSJP8ZqX', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-nmazWSJP8ZqX', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-nmazWSJP8ZqX'

update alertPeriod set finishTime = '23:59:59' where FilialCode = '0067'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0067'
update fiscalCheck set filialCode = '0067' where srcId = '9SD0C9DZ-9289-4A09-nmazWSJP8ZqX'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-nmazWSJP8ZqX'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-nmazWSJP8ZqX'
715239 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-nmazWSJP8ZqX'
715240 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-nmazWSJP8ZqX, null]
715243 [main] INFO  kkm.UnitTests - Status: null
715244 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
715244 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
715339 [main] INFO  kkm.UnitTests - End test

715345 [main] INFO  kkm.UnitTests - Starting test: KKM_DB5()
715486 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-mWKH19RxFhlW', '1082414445', '2019-07-12 00:00:00.000', '7710026574', 'NOFILIAL');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-mWKH19RxFhlW','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-mWKH19RxFhlW', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-mWKH19RxFhlW', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-mWKH19RxFhlW'

update alertPeriod set finishTime = '23:59:59' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '00:00:00' where FilialCode = 'NOFILIAL'
update fiscalCheck set filialCode = 'NOFILIAL' where srcId = '9SD0C9DZ-9289-4A09-mWKH19RxFhlW'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-mWKH19RxFhlW'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-mWKH19RxFhlW'
806662 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-mWKH19RxFhlW'
806663 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, DONE, , , 9SD0C9DZ-9289-4A09-mWKH19RxFhlW, ba8e4a3b-7a1c-4377-a390-68dd74725d79]
806666 [main] INFO  kkm.UnitTests - Status: DONE
806667 [main] INFO  kkm.UnitTests - fiscGateErrorCode: 
806667 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: 
826755 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.23/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%229SD0C9DZ-9289-4A09-mWKH19RxFhlW%22%20&size=500
826825 [main] INFO  kkm.UnitTests - Response message : {"took":14,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":27.819683,"hits":[{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"u27Ze3MBtD96ebe8-p3S","_score":27.819683,"_source":{"@timestamp":"2020-07-23T13:25:50.992Z","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"host":{"name":"44fcff07405a"},"json":{"spanId":"411b476e25803802","spanExportable":"true","ts":"2020-07-23T13:25:50.991+00:00","caller_line_number":84,"thread":"scheduling-1","X-B3-TraceId":"411b476e25803802","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","traceId":"411b476e25803802","level":"INFO","caller_file_name":"KkmCommutatorService.java","X-VSK-ReceiptKeys":[{"systemCode":"ADINSURE","entityCode":"Payment","srcID":"9SD0C9DZ-9289-4A09-mWKH19RxFhlW"}],"msg":"ReadyForSendingReceiptKeys selected ","method":"getReadyForSendingReceiptKeys","X-Span-Export":"true","X-B3-SpanId":"411b476e25803802"},"log":{"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"},"offset":40873073},"message":"{\"ts\":\"2020-07-23T13:25:50.991+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"411b476e25803802\",\"spanId\":\"411b476e25803802\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"411b476e25803802\",\"X-B3-TraceId\":\"411b476e25803802\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-mWKH19RxFhlW\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","docker":{"container":{"labels":{"Description":"KKM Commutator Service","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_swarm_task":"","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","Version":"97","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"agent":{"version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072"},"ecs":{"version":"1.0.1"},"stream":"stdout"}}]}}
826956 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = 'NOFILIAL'
826983 [main] INFO  kkm.UnitTests - End test

826986 [main] INFO  kkm.UnitTests - Starting test: KKM_DB6()
827121 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-VRypBwm8EwdV', '2432675619', '2019-07-12 00:00:00.000', '7710026574', '0031');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-VRypBwm8EwdV','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-VRypBwm8EwdV', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-VRypBwm8EwdV', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-VRypBwm8EwdV'

update alertPeriod set finishTime = '00:00:00' where FilialCode = '0031'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0031'
update fiscalCheck set filialCode = '0031' where srcId = '9SD0C9DZ-9289-4A09-VRypBwm8EwdV'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-VRypBwm8EwdV'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-VRypBwm8EwdV'
918168 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-VRypBwm8EwdV'
918168 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-VRypBwm8EwdV, null]
918172 [main] INFO  kkm.UnitTests - Status: null
918172 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
918172 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
938176 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.23/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
938249 [main] INFO  kkm.UnitTests - Response message : {"took":21,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1466,"relation":"eq"},"max_score":3.6662145,"hits":[{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"gRH9eHMBfrYj4vM9uv2E","_score":3.6662145,"_source":{"@timestamp":"2020-07-23T00:05:50.393Z","stream":"stdout","message":"{\"ts\":\"2020-07-23T00:05:50.393+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"2cfb4888bd7ad0dd\",\"spanId\":\"2cfb4888bd7ad0dd\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"2cfb4888bd7ad0dd\",\"X-B3-TraceId\":\"2cfb4888bd7ad0dd\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"log":{"offset":21598689,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"host":{"name":"96fa6ced97b1"},"agent":{"version":"7.3.1","type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391"}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"sRH7eHMBfrYj4vM9A38s","_score":3.6662145,"_source":{"@timestamp":"2020-07-23T00:02:49.763Z","message":"{\"ts\":\"2020-07-23T00:02:49.763+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"04876de683850c19\",\"spanId\":\"04876de683850c19\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"04876de683850c19\",\"X-B3-TraceId\":\"04876de683850c19\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","host":{"name":"96fa6ced97b1"},"agent":{"ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1","type":"filebeat"},"docker":{"container":{"labels":{"com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"log":{"offset":21535009,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"stream":"stdout","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"aBICeXMBfrYj4vM9VilL","_score":3.6662145,"_source":{"@timestamp":"2020-07-23T00:10:50.055Z","message":"{\"ts\":\"2020-07-23T00:10:50.055+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"a002feb455881916\",\"spanId\":\"a002feb455881916\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"a002feb455881916\",\"X-B3-TraceId\":\"a002feb455881916\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"ecs":{"version":"1.0.1"},"log":{"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"},"offset":21710704},"stream":"stdout","container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97"}}},"host":{"name":"96fa6ced97b1"},"agent":{"type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1"}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"fxL-eHMBfrYj4vM9rAW_","_score":3.6662145,"_source":{"@timestamp":"2020-07-23T00:06:50.159Z","docker":{"container":{"labels":{"com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3"}}},"host":{"name":"96fa6ced97b1"},"agent":{"hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1","type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5"},"message":"{\"ts\":\"2020-07-23T00:06:50.159+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"e22fce49f7f2b5f1\",\"spanId\":\"e22fce49f7f2b5f1\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"e22fce49f7f2b5f1\",\"X-B3-TraceId\":\"e22fce49f7f2b5f1\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","stream":"stdout","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"log":{"offset":21623596,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"GBIAeXMBfrYj4vM9gRWJ","_score":3.6662145,"_source":{"@timestamp":"2020-07-23T00:08:50.436Z","message":"{\"ts\":\"2020-07-23T00:08:50.436+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"beebe6d90c9d9ef3\",\"spanId\":\"beebe6d90c9d9ef3\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"beebe6d90c9d9ef3\",\"X-B3-TraceId\":\"beebe6d90c9d9ef3\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"agent":{"type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1"},"log":{"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"},"offset":21667152},"stream":"stdout","host":{"name":"96fa6ced97b1"}}}]}}
938380 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0031'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0031'
938412 [main] INFO  kkm.UnitTests - End test

938417 [main] INFO  kkm.UnitTests - Starting test: KKM_DB7()
938550 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-zIqsegveiOg1', '6497707475', '2019-07-12 00:00:00.000', '7725327863', '0067');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-zIqsegveiOg1','Фамилия Имя Отчество', '7725327863', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-zIqsegveiOg1', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-zIqsegveiOg1', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-zIqsegveiOg1'

update alertPeriod set finishTime = '00:00:00' where FilialCode = '0067'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0067'
update fiscalCheck set filialCode = '0067' where srcId = '9SD0C9DZ-9289-4A09-zIqsegveiOg1'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-zIqsegveiOg1'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-zIqsegveiOg1'
1029484 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-zIqsegveiOg1'
1029485 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-zIqsegveiOg1, null]
1029489 [main] INFO  kkm.UnitTests - Status: null
1029490 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
1029490 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
1049494 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.23/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
1049610 [main] INFO  kkm.UnitTests - Response message : {"took":3,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1468,"relation":"eq"},"max_score":3.6662276,"hits":[{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"gRH9eHMBfrYj4vM9uv2E","_score":3.6662276,"_source":{"@timestamp":"2020-07-23T00:05:50.393Z","stream":"stdout","message":"{\"ts\":\"2020-07-23T00:05:50.393+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"2cfb4888bd7ad0dd\",\"spanId\":\"2cfb4888bd7ad0dd\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"2cfb4888bd7ad0dd\",\"X-B3-TraceId\":\"2cfb4888bd7ad0dd\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"log":{"offset":21598689,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"host":{"name":"96fa6ced97b1"},"agent":{"version":"7.3.1","type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391"}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"sRH7eHMBfrYj4vM9A38s","_score":3.6662276,"_source":{"@timestamp":"2020-07-23T00:02:49.763Z","message":"{\"ts\":\"2020-07-23T00:02:49.763+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"04876de683850c19\",\"spanId\":\"04876de683850c19\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"04876de683850c19\",\"X-B3-TraceId\":\"04876de683850c19\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","host":{"name":"96fa6ced97b1"},"agent":{"ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1","type":"filebeat"},"docker":{"container":{"labels":{"com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"log":{"offset":21535009,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"stream":"stdout","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"aBICeXMBfrYj4vM9VilL","_score":3.6662276,"_source":{"@timestamp":"2020-07-23T00:10:50.055Z","message":"{\"ts\":\"2020-07-23T00:10:50.055+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"a002feb455881916\",\"spanId\":\"a002feb455881916\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"a002feb455881916\",\"X-B3-TraceId\":\"a002feb455881916\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"ecs":{"version":"1.0.1"},"log":{"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"},"offset":21710704},"stream":"stdout","container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97"}}},"host":{"name":"96fa6ced97b1"},"agent":{"type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1"}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"fxL-eHMBfrYj4vM9rAW_","_score":3.6662276,"_source":{"@timestamp":"2020-07-23T00:06:50.159Z","docker":{"container":{"labels":{"com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3"}}},"host":{"name":"96fa6ced97b1"},"agent":{"hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1","type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5"},"message":"{\"ts\":\"2020-07-23T00:06:50.159+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"e22fce49f7f2b5f1\",\"spanId\":\"e22fce49f7f2b5f1\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"e22fce49f7f2b5f1\",\"X-B3-TraceId\":\"e22fce49f7f2b5f1\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","stream":"stdout","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"log":{"offset":21623596,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"GBIAeXMBfrYj4vM9gRWJ","_score":3.6662276,"_source":{"@timestamp":"2020-07-23T00:08:50.436Z","message":"{\"ts\":\"2020-07-23T00:08:50.436+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"beebe6d90c9d9ef3\",\"spanId\":\"beebe6d90c9d9ef3\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"beebe6d90c9d9ef3\",\"X-B3-TraceId\":\"beebe6d90c9d9ef3\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"agent":{"type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1"},"log":{"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"},"offset":21667152},"stream":"stdout","host":{"name":"96fa6ced97b1"}}}]}}
1049746 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0067'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0067'
1049771 [main] INFO  kkm.UnitTests - End test

1049774 [main] INFO  kkm.UnitTests - Starting test: KKM_DB8()
1049903 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-Ys5RLkc60C2H', '9748666201', '2019-07-12 00:00:00.000', '7710026574', 'NOFILIAL');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-Ys5RLkc60C2H','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-Ys5RLkc60C2H', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-Ys5RLkc60C2H', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-Ys5RLkc60C2H'

update alertPeriod set finishTime = '00:00:00' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '00:00:00' where FilialCode = 'NOFILIAL'
update fiscalCheck set filialCode = 'NOFILIAL' where srcId = '9SD0C9DZ-9289-4A09-Ys5RLkc60C2H'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-Ys5RLkc60C2H'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-Ys5RLkc60C2H'
1140889 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-Ys5RLkc60C2H'
1140889 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-Ys5RLkc60C2H, null]
1140892 [main] INFO  kkm.UnitTests - Status: null
1140893 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
1140893 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
1160898 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.23/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
1160954 [main] INFO  kkm.UnitTests - Response message : {"took":3,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1470,"relation":"eq"},"max_score":3.6661174,"hits":[{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"gRH9eHMBfrYj4vM9uv2E","_score":3.6661174,"_source":{"@timestamp":"2020-07-23T00:05:50.393Z","stream":"stdout","message":"{\"ts\":\"2020-07-23T00:05:50.393+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"2cfb4888bd7ad0dd\",\"spanId\":\"2cfb4888bd7ad0dd\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"2cfb4888bd7ad0dd\",\"X-B3-TraceId\":\"2cfb4888bd7ad0dd\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"log":{"offset":21598689,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"host":{"name":"96fa6ced97b1"},"agent":{"version":"7.3.1","type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391"}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"sRH7eHMBfrYj4vM9A38s","_score":3.6661174,"_source":{"@timestamp":"2020-07-23T00:02:49.763Z","message":"{\"ts\":\"2020-07-23T00:02:49.763+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"04876de683850c19\",\"spanId\":\"04876de683850c19\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"04876de683850c19\",\"X-B3-TraceId\":\"04876de683850c19\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","host":{"name":"96fa6ced97b1"},"agent":{"ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1","type":"filebeat"},"docker":{"container":{"labels":{"com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"log":{"offset":21535009,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"stream":"stdout","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"aBICeXMBfrYj4vM9VilL","_score":3.6661174,"_source":{"@timestamp":"2020-07-23T00:10:50.055Z","message":"{\"ts\":\"2020-07-23T00:10:50.055+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"a002feb455881916\",\"spanId\":\"a002feb455881916\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"a002feb455881916\",\"X-B3-TraceId\":\"a002feb455881916\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"ecs":{"version":"1.0.1"},"log":{"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"},"offset":21710704},"stream":"stdout","container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97"}}},"host":{"name":"96fa6ced97b1"},"agent":{"type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1"}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"fxL-eHMBfrYj4vM9rAW_","_score":3.6661174,"_source":{"@timestamp":"2020-07-23T00:06:50.159Z","docker":{"container":{"labels":{"com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3"}}},"host":{"name":"96fa6ced97b1"},"agent":{"hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1","type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5"},"message":"{\"ts\":\"2020-07-23T00:06:50.159+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"e22fce49f7f2b5f1\",\"spanId\":\"e22fce49f7f2b5f1\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"e22fce49f7f2b5f1\",\"X-B3-TraceId\":\"e22fce49f7f2b5f1\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","stream":"stdout","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"log":{"offset":21623596,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"GBIAeXMBfrYj4vM9gRWJ","_score":3.6661174,"_source":{"@timestamp":"2020-07-23T00:08:50.436Z","message":"{\"ts\":\"2020-07-23T00:08:50.436+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"beebe6d90c9d9ef3\",\"spanId\":\"beebe6d90c9d9ef3\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"beebe6d90c9d9ef3\",\"X-B3-TraceId\":\"beebe6d90c9d9ef3\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"agent":{"type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1"},"log":{"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"},"offset":21667152},"stream":"stdout","host":{"name":"96fa6ced97b1"}}}]}}
1161084 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = 'NOFILIAL'
1161109 [main] INFO  kkm.UnitTests - End test

1161113 [main] INFO  kkm.UnitTests - Starting test: KKM_SendMessageWasCanceled()
1164026 [main] INFO  kkm.UnitTests - End test

1164029 [main] INFO  kkm.UnitTests - Starting test: KKM_CanceleNotFound()
1164070 [main] INFO  kkm.UnitTests - End test

1164072 [main] INFO  kkm.UnitTests - Starting test: KKM_makeAndCancelCheckCashier()
1407256 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/esb-test-2020.07.23/_search?q=%20message:%20%22CID=d4d09d43-6648-414b-bb2e-b65d608510d32%22%20
1407720 [main] INFO  kkm.UnitTests - Response message : {"took":410,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":8,"relation":"eq"},"max_score":58.602024,"hits":[{"_index":"esb-test-2020.07.23","_type":"_doc","_id":"rnHfe3MBtD96ebe8wy4V","_score":58.602024,"_source":{"level":"trace","@timestamp":"2020-07-23T13:32:08.884Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST request  Operation 'CancelReceipt' was call with body: 72c76874-5bdd-492c-8505-be6c9fd4566a | exid=ID-esb-test01-40739-1595408253463-71-121114 CID=d4d09d43-6648-414b-bb2e-b65d608510d32","thread":"qtp1489557672-107374","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"37973","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-23T16:32:08,884","input":{"type":"log"},"offset":348403280,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.23","_type":"_doc","_id":"UHHfe3MBtD96ebe8_VHU","_score":56.284073,"_source":{"level":"trace","@timestamp":"2020-07-23T13:32:08.930Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST response Operation 'CancelReceipt' was complete with body: CancelReceiptResponse{correlationId='null', checkId='72c76874-5bdd-492c-8505-be6c9fd4566a', canceledCheckId='fd728e75-c57b-4302-959d-66079ffcc1df', error=null} | exid=ID-esb-test01-40739-1595408253463-71-121114 CID=d4d09d43-6648-414b-bb2e-b65d608510d32","thread":"qtp1489557672-107374","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"37973","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-23T16:32:08,930","input":{"type":"log"},"offset":348407389,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.23","_type":"_doc","_id":"rHHfe3MBtD96ebe8wy4V","_score":55.192524,"_source":{"level":"debug","@timestamp":"2020-07-23T13:32:08.884Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST request  Operation 'CancelReceipt' was call with headers: {breadcrumbId=ID-esb-test01-40739-1595408253463-71-121113, JMSCorrelationID=d4d09d43-6648-414b-bb2e-b65d608510d32, operationName=CancelReceipt, X-VSK-CorrelationId=d4d09d43-6648-414b-bb2e-b65d608510d32} | exid=ID-esb-test01-40739-1595408253463-71-121114 CID=d4d09d43-6648-414b-bb2e-b65d608510d32","thread":"qtp1489557672-107374","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"37973","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-23T16:32:08,884","input":{"type":"log"},"offset":348402797,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.23","_type":"_doc","_id":"sHHfe3MBtD96ebe8wy4V","_score":52.803097,"_source":{"level":"debug","@timestamp":"2020-07-23T13:32:08.884Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'CancelReceipt' calling REST service  with headers: {breadcrumbId=ID-esb-test01-40739-1595408253463-71-121113, CamelHttpMethod=PUT, JMSCorrelationID=d4d09d43-6648-414b-bb2e-b65d608510d32, operationName=CancelReceipt, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/72c76874-5bdd-492c-8505-be6c9fd4566a/cancel, X-VSK-CorrelationId=d4d09d43-6648-414b-bb2e-b65d608510d32} | exId=ID-esb-test01-40739-1595408253463-71-121116 CID=d4d09d43-6648-414b-bb2e-b65d608510d32","thread":"thread #4094 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"37973","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-23T16:32:08,884","input":{"type":"log"},"offset":348403594,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.23","_type":"_doc","_id":"snHfe3MBtD96ebe8wy4V","_score":51.52836,"_source":{"level":"trace","@timestamp":"2020-07-23T13:32:08.884Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'CancelReceipt' calling REST service  with headers: {breadcrumbId=ID-esb-test01-40739-1595408253463-71-121113, CamelHttpMethod=PUT, JMSCorrelationID=d4d09d43-6648-414b-bb2e-b65d608510d32, operationName=CancelReceipt, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/72c76874-5bdd-492c-8505-be6c9fd4566a/cancel, X-VSK-CorrelationId=d4d09d43-6648-414b-bb2e-b65d608510d32} | exId=ID-esb-test01-40739-1595408253463-71-121116 CID=d4d09d43-6648-414b-bb2e-b65d608510d32 |\n 72c76874-5bdd-492c-8505-be6c9fd4566a","thread":"thread #4094 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"37973","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"},"flags":["multiline"]},"@version":"1","environment":"test","timestamp":"2020-07-23T16:32:08,884","input":{"type":"log"},"offset":348404202,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.23","_type":"_doc","_id":"tHHfe3MBtD96ebe8wy4V","_score":48.595455,"_source":{"level":"debug","@timestamp":"2020-07-23T13:32:08.929Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'CancelReceipt' service responded with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-40739-1595408253463-71-121113, CamelHttpMethod=PUT, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Type=application/json;charset=utf-8, Date=Thu, 23 Jul 2020 13:32:08 GMT, JMSCorrelationID=d4d09d43-6648-414b-bb2e-b65d608510d32, operationName=CancelReceipt, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/72c76874-5bdd-492c-8505-be6c9fd4566a/cancel, X-VSK-CorrelationId=d4d09d43-6648-414b-bb2e-b65d608510d32} | exid=ID-esb-test01-40739-1595408253463-71-121116 CID=d4d09d43-6648-414b-bb2e-b65d608510d32","thread":"thread #4094 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"37973","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-23T16:32:08,929","input":{"type":"log"},"offset":348404850,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.23","_type":"_doc","_id":"uHHfe3MBtD96ebe8wy4V","_score":48.595455,"_source":{"level":"debug","@timestamp":"2020-07-23T13:32:08.930Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST response Operation 'CancelReceipt' was complete with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-40739-1595408253463-71-121113, CamelHttpMethod=PUT, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Type=application/json;charset=utf-8, Date=Thu, 23 Jul 2020 13:32:08 GMT, JMSCorrelationID=d4d09d43-6648-414b-bb2e-b65d608510d32, operationName=CancelReceipt, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/72c76874-5bdd-492c-8505-be6c9fd4566a/cancel, X-VSK-CorrelationId=d4d09d43-6648-414b-bb2e-b65d608510d32} | exid=ID-esb-test01-40739-1595408253463-71-121114 CID=d4d09d43-6648-414b-bb2e-b65d608510d32","thread":"qtp1489557672-107374","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"37973","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-23T16:32:08,930","input":{"type":"log"},"offset":348406567,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.23","_type":"_doc","_id":"tXHfe3MBtD96ebe8wy4V","_score":47.513695,"_source":{"level":"trace","@timestamp":"2020-07-23T13:32:08.929Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'CancelReceipt' service responded with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-40739-1595408253463-71-121113, CamelHttpMethod=PUT, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Type=application/json;charset=utf-8, Date=Thu, 23 Jul 2020 13:32:08 GMT, JMSCorrelationID=d4d09d43-6648-414b-bb2e-b65d608510d32, operationName=CancelReceipt, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/72c76874-5bdd-492c-8505-be6c9fd4566a/cancel, X-VSK-CorrelationId=d4d09d43-6648-414b-bb2e-b65d608510d32} | exid=ID-esb-test01-40739-1595408253463-71-121116 CID=d4d09d43-6648-414b-bb2e-b65d608510d32 |\n {\"checkId\":\"72c76874-5bdd-492c-8505-be6c9fd4566a\",\"canceledCheckId\":\"fd728e75-c57b-4302-959d-66079ffcc1df\"}","thread":"thread #4094 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"37973","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"},"flags":["multiline"]},"@version":"1","environment":"test","timestamp":"2020-07-23T16:32:08,929","input":{"type":"log"},"offset":348405653,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}}]}}
1407721 [main] INFO  kkm.UnitTests - End test

1407725 [main] INFO  kkm.UnitTests - Starting test: KKM_SIPheckStatus()
1410223 [main] INFO  kkm.UnitTests - End test

1410226 [main] INFO  kkm.UnitTests - Starting test: KKM_SendMessageNotFound()
1410259 [main] INFO  kkm.UnitTests - End test

1410262 [main] INFO  kkm.UnitTests - Starting test: KKM_PostCorrectionReceipt_negative()
1410350 [main] INFO  kkm.UnitTests - End test

1410353 [main] INFO  kkm.UnitTests - Starting test: KKM_PostCorrectionReceipt()
1413124 [main] INFO  kkm.UnitTests - End test

