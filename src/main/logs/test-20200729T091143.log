199  [main] INFO  kkm.UnitTests - Starting test: KKM_makeCheckNoCashier()
3793 [main] INFO  kkm.UnitTests - End test

3805 [main] INFO  kkm.UnitTests - Starting test: KKM_SendMessageEmail()
276717 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/esb-test-2020.07.29/_search?q=%20message:%20%22CID=6fb6ea2a-418f-43c5-a068-83f52eb790ea11%22%20
276812 [main] INFO  kkm.UnitTests - Response message : {"took":4,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":8,"relation":"eq"},"max_score":35.920574,"hits":[{"_index":"esb-test-2020.07.29","_type":"_doc","_id":"OVb8mHMBtD96ebe8nZGC","_score":35.920574,"_source":{"level":"trace","@timestamp":"2020-07-29T05:12:19.625Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST response Operation 'SendMessage' was complete with body: ReceiptResponse{correlationId='null', checkId='d1b712d2-d9df-4596-a0e1-b9f506938f24', error=null} | exid=ID-esb-test01-39552-1595922638059-71-8072 CID=6fb6ea2a-418f-43c5-a068-83f52eb790ea11","thread":"qtp1413042234-26078","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38357","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-29T08:12:19,625","input":{"type":"log"},"offset":686906,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.29","_type":"_doc","_id":"IFb8mHMBtD96ebe8YnUI","_score":35.840088,"_source":{"level":"trace","@timestamp":"2020-07-29T05:12:19.600Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST request  Operation 'SendMessage' was call with body: SendMessageRequest{checkId='d1b712d2-d9df-4596-a0e1-b9f506938f24', messageType='email', messageAddress='EPolikarpova@VSK.RU'} | exid=ID-esb-test01-39552-1595922638059-71-8072 CID=6fb6ea2a-418f-43c5-a068-83f52eb790ea11","thread":"qtp1413042234-26078","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38357","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-29T08:12:19,600","input":{"type":"log"},"offset":682560,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.29","_type":"_doc","_id":"JVb8mHMBtD96ebe8YnUO","_score":34.97798,"_source":{"level":"debug","@timestamp":"2020-07-29T05:12:19.600Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST request  Operation 'SendMessage' was call with headers: {breadcrumbId=ID-esb-test01-39552-1595922638059-71-8071, JMSCorrelationID=6fb6ea2a-418f-43c5-a068-83f52eb790ea11, operationName=SendMessage, X-VSK-CorrelationId=6fb6ea2a-418f-43c5-a068-83f52eb790ea11} | exid=ID-esb-test01-39552-1595922638059-71-8072 CID=6fb6ea2a-418f-43c5-a068-83f52eb790ea11","thread":"qtp1413042234-26078","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38357","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-29T08:12:19,600","input":{"type":"log"},"offset":682082,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.29","_type":"_doc","_id":"JFb8mHMBtD96ebe8YnUN","_score":33.653336,"_source":{"level":"debug","@timestamp":"2020-07-29T05:12:19.602Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'SendMessage' calling REST service  with headers: {breadcrumbId=ID-esb-test01-39552-1595922638059-71-8071, CamelHttpMethod=GET, JMSCorrelationID=6fb6ea2a-418f-43c5-a068-83f52eb790ea11, operationName=SendMessage, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/d1b712d2-d9df-4596-a0e1-b9f506938f24/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=6fb6ea2a-418f-43c5-a068-83f52eb790ea11} | exId=ID-esb-test01-39552-1595922638059-71-8074 CID=6fb6ea2a-418f-43c5-a068-83f52eb790ea11","thread":"thread #4068 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38357","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-29T08:12:19,602","input":{"type":"log"},"offset":682960,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.29","_type":"_doc","_id":"Ilb8mHMBtD96ebe8YnUL","_score":33.653336,"_source":{"level":"trace","@timestamp":"2020-07-29T05:12:19.602Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'SendMessage' calling REST service  with headers: {breadcrumbId=ID-esb-test01-39552-1595922638059-71-8071, CamelHttpMethod=GET, JMSCorrelationID=6fb6ea2a-418f-43c5-a068-83f52eb790ea11, operationName=SendMessage, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/d1b712d2-d9df-4596-a0e1-b9f506938f24/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=6fb6ea2a-418f-43c5-a068-83f52eb790ea11} | exId=ID-esb-test01-39552-1595922638059-71-8074 CID=6fb6ea2a-418f-43c5-a068-83f52eb790ea11 |\n ","thread":"thread #4068 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38357","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"},"flags":["multiline"]},"@version":"1","environment":"test","timestamp":"2020-07-29T08:12:19,602","input":{"type":"log"},"offset":683591,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.29","_type":"_doc","_id":"IVb8mHMBtD96ebe8YnUK","_score":31.530516,"_source":{"level":"debug","@timestamp":"2020-07-29T05:12:19.625Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'SendMessage' service responded with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-39552-1595922638059-71-8071, CamelHttpMethod=GET, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Disposition=inline;filename=f.txt, Content-Type=application/json;charset=utf-8, Date=Wed, 29 Jul 2020 05:12:19 GMT, JMSCorrelationID=6fb6ea2a-418f-43c5-a068-83f52eb790ea11, operationName=SendMessage, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/d1b712d2-d9df-4596-a0e1-b9f506938f24/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=6fb6ea2a-418f-43c5-a068-83f52eb790ea11} | exid=ID-esb-test01-39552-1595922638059-71-8074 CID=6fb6ea2a-418f-43c5-a068-83f52eb790ea11","thread":"thread #4068 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38357","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-29T08:12:19,625","input":{"type":"log"},"offset":684226,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.29","_type":"_doc","_id":"Jlb8mHMBtD96ebe8YnUO","_score":31.530516,"_source":{"level":"debug","@timestamp":"2020-07-29T05:12:19.625Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST response Operation 'SendMessage' was complete with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-39552-1595922638059-71-8071, CamelHttpMethod=GET, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Disposition=inline;filename=f.txt, Content-Type=application/json;charset=utf-8, Date=Wed, 29 Jul 2020 05:12:19 GMT, JMSCorrelationID=6fb6ea2a-418f-43c5-a068-83f52eb790ea11, operationName=SendMessage, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/d1b712d2-d9df-4596-a0e1-b9f506938f24/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=6fb6ea2a-418f-43c5-a068-83f52eb790ea11} | exid=ID-esb-test01-39552-1595922638059-71-8072 CID=6fb6ea2a-418f-43c5-a068-83f52eb790ea11","thread":"qtp1413042234-26078","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38357","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-29T08:12:19,625","input":{"type":"log"},"offset":686018,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.29","_type":"_doc","_id":"I1b8mHMBtD96ebe8YnUM","_score":31.041006,"_source":{"level":"trace","@timestamp":"2020-07-29T05:12:19.625Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'SendMessage' service responded with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-39552-1595922638059-71-8071, CamelHttpMethod=GET, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Disposition=inline;filename=f.txt, Content-Type=application/json;charset=utf-8, Date=Wed, 29 Jul 2020 05:12:19 GMT, JMSCorrelationID=6fb6ea2a-418f-43c5-a068-83f52eb790ea11, operationName=SendMessage, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/d1b712d2-d9df-4596-a0e1-b9f506938f24/messages/email/EPolikarpova@VSK.RU, X-VSK-CorrelationId=6fb6ea2a-418f-43c5-a068-83f52eb790ea11} | exid=ID-esb-test01-39552-1595922638059-71-8074 CID=6fb6ea2a-418f-43c5-a068-83f52eb790ea11 |\n {\"checkId\":\"d1b712d2-d9df-4596-a0e1-b9f506938f24\"}","thread":"thread #4068 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38357","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"},"flags":["multiline"]},"@version":"1","environment":"test","timestamp":"2020-07-29T08:12:19,625","input":{"type":"log"},"offset":685095,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}}]}}
276813 [main] INFO  kkm.UnitTests - End test

276814 [main] INFO  kkm.UnitTests - Starting test: KKM_WAcheckStatus()
278642 [main] INFO  kkm.UnitTests - End test

278644 [main] INFO  kkm.UnitTests - Starting test: KKM_getStatus()
281455 [main] INFO  kkm.UnitTests - End test

281456 [main] INFO  kkm.UnitTests - Starting test: KKM_CanceledAlredy()
284433 [main] INFO  kkm.UnitTests - End test

284438 [main] INFO  kkm.UnitTests - Starting test: KKM_getDocCustomer()
284715 [main] INFO  kkm.UnitTests - End test

284716 [main] INFO  kkm.UnitTests - Starting test: KKM_makeCheckCashier()
289168 [main] INFO  kkm.UnitTests - End test

289173 [main] INFO  kkm.UnitTests - Starting test: KKM_DB1()
289455 [main] INFO  kkm.UnitTests - Script is: SELECT TOP 1 * FROM ProcessStatus Where fiscGateCheckStatusCode = 'ERROR'
289459 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000902849
289461 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000902849
290030 [main] INFO  kkm.UnitTests - update dbo.Customer set inn = '1' where srcID = 'ЖПлато_000902849'
update ProcessStatus set fiscGateCheckStatusCode = null where srcID = 'ЖПлато_000902849'
select * from ProcessStatus where srcID = 'ЖПлато_000902849'
290032 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, null, VALIDATION_ERROR, ЖПлато_000902849]
290036 [main] INFO  kkm.UnitTests - Status is: [AXAPTA, PaymentOrder, null, VALIDATION_ERROR, ЖПлато_000902849]
350407 [main] INFO  kkm.UnitTests - select * from ProcessStatus where srcID = 'ЖПлато_000902849'
350408 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, ERROR, VALIDATION_ERROR, ЖПлато_000902849]
410417 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.29/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%22ЖПлато_000902849%22%20&size=500
410501 [main] INFO  kkm.UnitTests - Response message : {"took":11,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":11.334874,"hits":[{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"JVcAmXMBtD96ebe8eJcL","_score":11.334874,"_source":{"@timestamp":"2020-07-29T05:16:50.049Z","container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e"},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","Description":"KKM Commutator Service","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","Version":"97","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_task":""}}},"log":{"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"},"offset":30145281},"stream":"stdout","message":"{\"ts\":\"2020-07-29T05:16:50.048+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"cb7c52db974dad7d\",\"spanId\":\"cb7c52db974dad7d\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"cb7c52db974dad7d\",\"X-B3-TraceId\":\"cb7c52db974dad7d\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000902849\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","agent":{"version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072"},"json":{"ts":"2020-07-29T05:16:50.048+00:00","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","thread":"scheduling-1","caller_file_name":"KkmCommutatorService.java","spanId":"cb7c52db974dad7d","X-B3-TraceId":"cb7c52db974dad7d","spanExportable":"true","X-Span-Export":"true","X-B3-SpanId":"cb7c52db974dad7d","X-VSK-ReceiptKeys":[{"srcID":"ЖПлато_000902849","systemCode":"AXAPTA","entityCode":"PaymentOrder"}],"level":"INFO","method":"getReadyForSendingReceiptKeys","caller_line_number":84,"traceId":"cb7c52db974dad7d","msg":"ReadyForSendingReceiptKeys selected "},"input":{"type":"container"},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"}}}]}}
410502 [main] INFO  kkm.UnitTests - End test

410505 [main] INFO  kkm.UnitTests - Starting test: KKM_DB2()
410705 [main] INFO  kkm.UnitTests - Script is: SELECT TOP 1 * FROM ProcessStatus Where fiscGateCheckStatusCode = 'DONE'
410705 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000898541
410708 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000898541
411419 [main] INFO  kkm.UnitTests - update alertPeriod set finishTime = '00:00:00' where FilialCode = '--filialCode--'
update alertPeriod set startTime = '00:00:00' where FilialCode = '--filialCode--'
update customer set Phone = '70000000000' where srcID = 'ЖПлато_000898541'
update customer set email = '' where srcId = 'ЖПлато_000898541'
update processStatus set fiscGateCheckStatusCode = null where srcID = 'ЖПлато_000898541'
select * from processStatus where srcID = 'ЖПлато_000898541'
411420 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, null, nothing, ЖПлато_000898541]
411422 [main] INFO  kkm.UnitTests - Status is: [AXAPTA, PaymentOrder, null, nothing, ЖПлато_000898541]
471742 [main] INFO  kkm.UnitTests - select * from ProcessStatus where srcID = 'ЖПлато_000898541'
471742 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, DONE, nothing, ЖПлато_000898541]
531748 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.29/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%22ЖПлато_000898541%22%20&size=500
531808 [main] INFO  kkm.UnitTests - Response message : {"took":5,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":10.605002,"hits":[{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"AlgCmXMBtD96ebe8UAbN","_score":10.605002,"_source":{"@timestamp":"2020-07-29T05:18:49.933Z","message":"{\"ts\":\"2020-07-29T05:18:49.929+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"6a836b18d2b937be\",\"spanId\":\"6a836b18d2b937be\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"6a836b18d2b937be\",\"X-B3-TraceId\":\"6a836b18d2b937be\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000898541\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","agent":{"type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1"},"host":{"name":"44fcff07405a"},"json":{"X-B3-TraceId":"6a836b18d2b937be","ts":"2020-07-29T05:18:49.929+00:00","level":"INFO","spanId":"6a836b18d2b937be","X-Span-Export":"true","X-VSK-ReceiptKeys":[{"entityCode":"PaymentOrder","srcID":"ЖПлато_000898541","systemCode":"AXAPTA"}],"traceId":"6a836b18d2b937be","spanExportable":"true","X-B3-SpanId":"6a836b18d2b937be","msg":"ReadyForSendingReceiptKeys selected ","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_file_name":"KkmCommutatorService.java","thread":"scheduling-1","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys","caller_line_number":84},"log":{"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"},"offset":30213154},"stream":"stdout","input":{"type":"container"},"container":{"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_task":"","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","Version":"97","com_docker_swarm_service_name":"kkm-commutator_service","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator"}}},"ecs":{"version":"1.0.1"}}}]}}
531809 [main] INFO  kkm.UnitTests - End test

531811 [main] INFO  kkm.UnitTests - Starting test: KKM_DB3()
531970 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-tq3BjpruWYuu', '2063698449', '2019-07-12 00:00:00.000', '7710026574', '0031');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-tq3BjpruWYuu','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-tq3BjpruWYuu', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-tq3BjpruWYuu', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-tq3BjpruWYuu'

update alertPeriod set finishTime = '23:59:59' where FilialCode = '0031'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0031'
update fiscalCheck set filialCode = '0031' where srcId = '9SD0C9DZ-9289-4A09-tq3BjpruWYuu'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-tq3BjpruWYuu'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-tq3BjpruWYuu'
643298 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-tq3BjpruWYuu'
643298 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, DONE, , , 9SD0C9DZ-9289-4A09-tq3BjpruWYuu, 33b84481-71ca-4582-90c2-7b6ac3993a36]
643302 [main] INFO  kkm.UnitTests - Status: DONE
643303 [main] INFO  kkm.UnitTests - fiscGateErrorCode: 
643303 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: 
663445 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.29/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%229SD0C9DZ-9289-4A09-tq3BjpruWYuu%22%20&size=500
663512 [main] INFO  kkm.UnitTests - Response message : {"took":13,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":21.030249,"hits":[{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"U1gFmXMBtD96ebe8DGQU","_score":21.030249,"_source":{"@timestamp":"2020-07-29T05:21:49.840Z","message":"{\"ts\":\"2020-07-29T05:21:49.840+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"b72368b00dd51e24\",\"spanId\":\"b72368b00dd51e24\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"b72368b00dd51e24\",\"X-B3-TraceId\":\"b72368b00dd51e24\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-zWgItx8X13DA\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-KXFvh4RjXSoe\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-tq3BjpruWYuu\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-DhYdWkCfszER\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-8lqwvLz5moMW\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-jRHJdxCYKi2q\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","Version":"97","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","Description":"KKM Commutator Service"}}},"host":{"name":"44fcff07405a"},"json":{"level":"INFO","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_file_name":"KkmCommutatorService.java","caller_line_number":84,"spanExportable":"true","X-VSK-ReceiptKeys":[{"systemCode":"ADINSURE","entityCode":"Payment","srcID":"9SD0C9DZ-9289-4A09-zWgItx8X13DA"},{"systemCode":"ADINSURE","entityCode":"Payment","srcID":"9SD0C9DZ-9289-4A09-KXFvh4RjXSoe"},{"entityCode":"Payment","srcID":"9SD0C9DZ-9289-4A09-tq3BjpruWYuu","systemCode":"ADINSURE"},{"srcID":"9SD0C9DZ-9289-4A09-DhYdWkCfszER","systemCode":"ADINSURE","entityCode":"Payment"},{"systemCode":"ADINSURE","entityCode":"Payment","srcID":"9SD0C9DZ-9289-4A09-8lqwvLz5moMW"},{"systemCode":"ADINSURE","entityCode":"Payment","srcID":"9SD0C9DZ-9289-4A09-jRHJdxCYKi2q"}],"msg":"ReadyForSendingReceiptKeys selected ","method":"getReadyForSendingReceiptKeys","thread":"scheduling-1","spanId":"b72368b00dd51e24","X-B3-TraceId":"b72368b00dd51e24","ts":"2020-07-29T05:21:49.840+00:00","X-Span-Export":"true","X-B3-SpanId":"b72368b00dd51e24","traceId":"b72368b00dd51e24"},"log":{"offset":30316013,"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"}},"stream":"stdout","input":{"type":"container"},"container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e"},"ecs":{"version":"1.0.1"},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"}}}]}}
663674 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0031'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0031'
663699 [main] INFO  kkm.UnitTests - End test

663702 [main] INFO  kkm.UnitTests - Starting test: KKM_DB4()
663868 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-roNbyrIwkeoP', '1870760769', '2019-07-12 00:00:00.000', '7725327863', '0067');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-roNbyrIwkeoP','Фамилия Имя Отчество', '7725327863', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-roNbyrIwkeoP', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-roNbyrIwkeoP', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-roNbyrIwkeoP'

update alertPeriod set finishTime = '23:59:59' where FilialCode = '0067'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0067'
update fiscalCheck set filialCode = '0067' where srcId = '9SD0C9DZ-9289-4A09-roNbyrIwkeoP'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-roNbyrIwkeoP'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-roNbyrIwkeoP'
775039 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-roNbyrIwkeoP'
775039 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, FAIL, BAD_REQUEST, Bad request: {
  "errors": [
    "Передача данных автомата недоступна для указанной группы"
  ]
}, 9SD0C9DZ-9289-4A09-roNbyrIwkeoP, 4173507b-268f-4876-9583-7068b6c33318]
775041 [main] INFO  kkm.UnitTests - Status: FAIL
775041 [main] INFO  kkm.UnitTests - fiscGateErrorCode: BAD_REQUEST
775041 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: Bad request: {
  "errors": [
    "Передача данных автомата недоступна для указанной группы"
  ]
}
795526 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.29/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%229SD0C9DZ-9289-4A09-roNbyrIwkeoP%22%20&size=500
795594 [main] INFO  kkm.UnitTests - Response message : {"took":12,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":24.693995,"hits":[{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"4lgGmXMBtD96ebe85oqW","_score":24.693995,"_source":{"@timestamp":"2020-07-29T05:23:51.152Z","message":"{\"ts\":\"2020-07-29T05:23:51.152+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"4db749467f6ee366\",\"spanId\":\"4db749467f6ee366\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"4db749467f6ee366\",\"X-B3-TraceId\":\"4db749467f6ee366\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-sQl1eU6nIJX0\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-roNbyrIwkeoP\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","host":{"name":"44fcff07405a"},"json":{"logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","level":"INFO","X-B3-SpanId":"4db749467f6ee366","X-VSK-ReceiptKeys":[{"systemCode":"ADINSURE","entityCode":"Payment","srcID":"9SD0C9DZ-9289-4A09-sQl1eU6nIJX0"},{"entityCode":"Payment","srcID":"9SD0C9DZ-9289-4A09-roNbyrIwkeoP","systemCode":"ADINSURE"}],"thread":"scheduling-1","spanExportable":"true","X-B3-TraceId":"4db749467f6ee366","spanId":"4db749467f6ee366","X-Span-Export":"true","msg":"ReadyForSendingReceiptKeys selected ","ts":"2020-07-29T05:23:51.152+00:00","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys","caller_file_name":"KkmCommutatorService.java","caller_line_number":84,"traceId":"4db749467f6ee366"},"docker":{"container":{"labels":{"com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","Version":"97","com_docker_swarm_task":""}}},"ecs":{"version":"1.0.1"},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"},"log":{"offset":30561782,"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"}},"stream":"stdout","input":{"type":"container"},"container":{"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}}}}]}}
795749 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0067'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0067'
795773 [main] INFO  kkm.UnitTests - End test

795774 [main] INFO  kkm.UnitTests - Starting test: KKM_DB5()
795910 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-PaYPVyCQJc7w', '5768551729', '2019-07-12 00:00:00.000', '7710026574', 'NOFILIAL');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-PaYPVyCQJc7w','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-PaYPVyCQJc7w', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-PaYPVyCQJc7w', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-PaYPVyCQJc7w'

update alertPeriod set finishTime = '23:59:59' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '00:00:00' where FilialCode = 'NOFILIAL'
update fiscalCheck set filialCode = 'NOFILIAL' where srcId = '9SD0C9DZ-9289-4A09-PaYPVyCQJc7w'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-PaYPVyCQJc7w'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-PaYPVyCQJc7w'
906994 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-PaYPVyCQJc7w'
906995 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, DONE, , , 9SD0C9DZ-9289-4A09-PaYPVyCQJc7w, 89286ea6-c8e5-4001-a478-774ccfa1a150]
906999 [main] INFO  kkm.UnitTests - Status: DONE
906999 [main] INFO  kkm.UnitTests - fiscGateErrorCode: 
906999 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: 
927123 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.29/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%229SD0C9DZ-9289-4A09-PaYPVyCQJc7w%22%20&size=500
927244 [main] INFO  kkm.UnitTests - Response message : {"took":17,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":24.265236,"hits":[{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"71gImXMBtD96ebe8tbrI","_score":24.265236,"_source":{"@timestamp":"2020-07-29T05:25:49.623Z","agent":{"ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat"},"stream":"stdout","message":"{\"ts\":\"2020-07-29T05:25:49.622+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"b8809d217236539b\",\"spanId\":\"b8809d217236539b\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"b8809d217236539b\",\"X-B3-TraceId\":\"b8809d217236539b\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-agYkdhgenqRB\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-PaYPVyCQJc7w\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","input":{"type":"container"},"host":{"name":"44fcff07405a"},"json":{"logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","level":"INFO","spanId":"b8809d217236539b","X-Span-Export":"true","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys","X-B3-TraceId":"b8809d217236539b","msg":"ReadyForSendingReceiptKeys selected ","ts":"2020-07-29T05:25:49.622+00:00","traceId":"b8809d217236539b","spanExportable":"true","X-B3-SpanId":"b8809d217236539b","X-VSK-ReceiptKeys":[{"systemCode":"ADINSURE","entityCode":"Payment","srcID":"9SD0C9DZ-9289-4A09-agYkdhgenqRB"},{"entityCode":"Payment","srcID":"9SD0C9DZ-9289-4A09-PaYPVyCQJc7w","systemCode":"ADINSURE"}],"caller_file_name":"KkmCommutatorService.java","caller_line_number":84,"thread":"scheduling-1"},"log":{"offset":30669797,"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"}},"container":{"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","Description":"KKM Commutator Service","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","Version":"97","com_docker_swarm_task":"","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9"}}},"ecs":{"version":"1.0.1"}}}]}}
927419 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = 'NOFILIAL'
927443 [main] INFO  kkm.UnitTests - End test

927444 [main] INFO  kkm.UnitTests - Starting test: KKM_DB6()
927607 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-W5D2Sy6W32BB', '2929927625', '2019-07-12 00:00:00.000', '7710026574', '0031');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-W5D2Sy6W32BB','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-W5D2Sy6W32BB', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-W5D2Sy6W32BB', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-W5D2Sy6W32BB'

update alertPeriod set finishTime = '00:00:00' where FilialCode = '0031'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0031'
update fiscalCheck set filialCode = '0031' where srcId = '9SD0C9DZ-9289-4A09-W5D2Sy6W32BB'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-W5D2Sy6W32BB'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-W5D2Sy6W32BB'
1038583 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-W5D2Sy6W32BB'
1038583 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-W5D2Sy6W32BB, null]
1038584 [main] INFO  kkm.UnitTests - Status: null
1038585 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
1038585 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
1058587 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.29/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
1059143 [main] INFO  kkm.UnitTests - Response message : {"took":506,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":329,"relation":"eq"},"max_score":3.6655083,"hits":[{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"hS3fl3MBtD96ebe8LDJ-","_score":3.6655083,"_source":{"@timestamp":"2020-07-29T00:00:49.181Z","log":{"offset":23142671,"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"}},"input":{"type":"container"},"container":{"name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919"},"docker":{"container":{"labels":{"com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","com_docker_swarm_service_name":"kkm-commutator_service","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9"}}},"host":{"name":"44fcff07405a"},"agent":{"version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072"},"json":{"logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys","spanExportable":"true","X-B3-TraceId":"b53687d72a31bf84","msg":"ReadyForSendingReceiptKeys is EMPTY","level":"INFO","X-B3-SpanId":"b53687d72a31bf84","ts":"2020-07-29T00:00:49.179+00:00","caller_file_name":"KkmCommutatorService.java","caller_line_number":82,"thread":"scheduling-1","X-Span-Export":"true","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","traceId":"b53687d72a31bf84","spanId":"b53687d72a31bf84"},"stream":"stdout","message":"{\"ts\":\"2020-07-29T00:00:49.179+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"b53687d72a31bf84\",\"spanId\":\"b53687d72a31bf84\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"b53687d72a31bf84\",\"X-B3-TraceId\":\"b53687d72a31bf84\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","ecs":{"version":"1.0.1"}}},{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"qDDvl3MBtD96ebe8r_Z6","_score":3.6655083,"_source":{"@timestamp":"2020-07-29T00:18:49.723Z","log":{"offset":23539049,"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"}},"stream":"stdout","input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","Version":"97","com_docker_swarm_task":"","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","Description":"KKM Commutator Service","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e"}}},"host":{"name":"44fcff07405a"},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"},"message":"{\"ts\":\"2020-07-29T00:18:49.722+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"f166301c5d4a856f\",\"spanId\":\"f166301c5d4a856f\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"f166301c5d4a856f\",\"X-B3-TraceId\":\"f166301c5d4a856f\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","container":{"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"json":{"logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","X-Span-Export":"true","level":"INFO","caller_line_number":82,"traceId":"f166301c5d4a856f","spanId":"f166301c5d4a856f","method":"getReadyForSendingReceiptKeys","thread":"scheduling-1","spanExportable":"true","X-B3-TraceId":"f166301c5d4a856f","msg":"ReadyForSendingReceiptKeys is EMPTY","ts":"2020-07-29T00:18:49.722+00:00","caller_file_name":"KkmCommutatorService.java","X-B3-SpanId":"f166301c5d4a856f"}}},{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"sDDql3MBtD96ebe8MQ4S","_score":3.6655083,"_source":{"@timestamp":"2020-07-29T00:12:50.291Z","message":"{\"ts\":\"2020-07-29T00:12:50.291+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"725f7f784afd6230\",\"spanId\":\"725f7f784afd6230\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"725f7f784afd6230\",\"X-B3-TraceId\":\"725f7f784afd6230\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_stack_namespace":"kkm-commutator","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","Description":"KKM Commutator Service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task":""}}},"host":{"name":"44fcff07405a"},"ecs":{"version":"1.0.1"},"log":{"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"},"offset":23404318},"stream":"stdout","input":{"type":"container"},"container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e"},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"},"json":{"X-B3-SpanId":"725f7f784afd6230","msg":"ReadyForSendingReceiptKeys is EMPTY","caller_file_name":"KkmCommutatorService.java","thread":"scheduling-1","spanId":"725f7f784afd6230","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys","spanExportable":"true","X-B3-TraceId":"725f7f784afd6230","ts":"2020-07-29T00:12:50.291+00:00","level":"INFO","traceId":"725f7f784afd6230","caller_line_number":82,"X-Span-Export":"true"}}},{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"uTDsl3MBtD96ebe8BR3e","_score":3.6655083,"_source":{"@timestamp":"2020-07-29T00:14:49.595Z","host":{"name":"44fcff07405a"},"agent":{"version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072"},"json":{"ts":"2020-07-29T00:14:49.595+00:00","X-Span-Export":"true","caller_file_name":"KkmCommutatorService.java","traceId":"47d1e3613cdcfeeb","spanExportable":"true","X-B3-SpanId":"47d1e3613cdcfeeb","msg":"ReadyForSendingReceiptKeys is EMPTY","level":"INFO","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys","caller_line_number":82,"thread":"scheduling-1","X-B3-TraceId":"47d1e3613cdcfeeb","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","spanId":"47d1e3613cdcfeeb"},"stream":"stdout","message":"{\"ts\":\"2020-07-29T00:14:49.595+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"47d1e3613cdcfeeb\",\"spanId\":\"47d1e3613cdcfeeb\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"47d1e3613cdcfeeb\",\"X-B3-TraceId\":\"47d1e3613cdcfeeb\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","Version":"97","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","Description":"KKM Commutator Service","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e"}}},"ecs":{"version":"1.0.1"},"log":{"offset":23447408,"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"}}}},{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"SjDtl3MBtD96ebe82oir","_score":3.6655083,"_source":{"@timestamp":"2020-07-29T00:16:49.402Z","stream":"stdout","agent":{"id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a"},"json":{"X-B3-TraceId":"1209e1ec268a17ee","ts":"2020-07-29T00:16:49.402+00:00","level":"INFO","method":"getReadyForSendingReceiptKeys","caller_line_number":82,"X-Span-Export":"true","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","X-B3-SpanId":"1209e1ec268a17ee","thread":"scheduling-1","msg":"ReadyForSendingReceiptKeys is EMPTY","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_file_name":"KkmCommutatorService.java","traceId":"1209e1ec268a17ee","spanId":"1209e1ec268a17ee","spanExportable":"true"},"host":{"name":"44fcff07405a"},"log":{"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"},"offset":23490944},"message":"{\"ts\":\"2020-07-29T00:16:49.402+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"1209e1ec268a17ee\",\"spanId\":\"1209e1ec268a17ee\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"1209e1ec268a17ee\",\"X-B3-TraceId\":\"1209e1ec268a17ee\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","Version":"97","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"}}}]}}
1059322 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0031'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0031'
1059350 [main] INFO  kkm.UnitTests - End test

1059351 [main] INFO  kkm.UnitTests - Starting test: KKM_DB7()
1059513 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-qnv44xjUv6ji', '4983102777', '2019-07-12 00:00:00.000', '7725327863', '0067');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-qnv44xjUv6ji','Фамилия Имя Отчество', '7725327863', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-qnv44xjUv6ji', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-qnv44xjUv6ji', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-qnv44xjUv6ji'

update alertPeriod set finishTime = '00:00:00' where FilialCode = '0067'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0067'
update fiscalCheck set filialCode = '0067' where srcId = '9SD0C9DZ-9289-4A09-qnv44xjUv6ji'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-qnv44xjUv6ji'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-qnv44xjUv6ji'
1170746 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-qnv44xjUv6ji'
1170747 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-qnv44xjUv6ji, null]
1170748 [main] INFO  kkm.UnitTests - Status: null
1170748 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
1170748 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
1190750 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.29/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
1190876 [main] INFO  kkm.UnitTests - Response message : {"took":6,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":331,"relation":"eq"},"max_score":3.6650221,"hits":[{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"hS3fl3MBtD96ebe8LDJ-","_score":3.6650221,"_source":{"@timestamp":"2020-07-29T00:00:49.181Z","log":{"offset":23142671,"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"}},"input":{"type":"container"},"container":{"name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919"},"docker":{"container":{"labels":{"com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","com_docker_swarm_service_name":"kkm-commutator_service","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9"}}},"host":{"name":"44fcff07405a"},"agent":{"version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072"},"json":{"logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys","spanExportable":"true","X-B3-TraceId":"b53687d72a31bf84","msg":"ReadyForSendingReceiptKeys is EMPTY","level":"INFO","X-B3-SpanId":"b53687d72a31bf84","ts":"2020-07-29T00:00:49.179+00:00","caller_file_name":"KkmCommutatorService.java","caller_line_number":82,"thread":"scheduling-1","X-Span-Export":"true","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","traceId":"b53687d72a31bf84","spanId":"b53687d72a31bf84"},"stream":"stdout","message":"{\"ts\":\"2020-07-29T00:00:49.179+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"b53687d72a31bf84\",\"spanId\":\"b53687d72a31bf84\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"b53687d72a31bf84\",\"X-B3-TraceId\":\"b53687d72a31bf84\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","ecs":{"version":"1.0.1"}}},{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"qDDvl3MBtD96ebe8r_Z6","_score":3.6650221,"_source":{"@timestamp":"2020-07-29T00:18:49.723Z","log":{"offset":23539049,"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"}},"stream":"stdout","input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","Version":"97","com_docker_swarm_task":"","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","Description":"KKM Commutator Service","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e"}}},"host":{"name":"44fcff07405a"},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"},"message":"{\"ts\":\"2020-07-29T00:18:49.722+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"f166301c5d4a856f\",\"spanId\":\"f166301c5d4a856f\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"f166301c5d4a856f\",\"X-B3-TraceId\":\"f166301c5d4a856f\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","container":{"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"json":{"logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","X-Span-Export":"true","level":"INFO","caller_line_number":82,"traceId":"f166301c5d4a856f","spanId":"f166301c5d4a856f","method":"getReadyForSendingReceiptKeys","thread":"scheduling-1","spanExportable":"true","X-B3-TraceId":"f166301c5d4a856f","msg":"ReadyForSendingReceiptKeys is EMPTY","ts":"2020-07-29T00:18:49.722+00:00","caller_file_name":"KkmCommutatorService.java","X-B3-SpanId":"f166301c5d4a856f"}}},{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"sDDql3MBtD96ebe8MQ4S","_score":3.6650221,"_source":{"@timestamp":"2020-07-29T00:12:50.291Z","message":"{\"ts\":\"2020-07-29T00:12:50.291+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"725f7f784afd6230\",\"spanId\":\"725f7f784afd6230\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"725f7f784afd6230\",\"X-B3-TraceId\":\"725f7f784afd6230\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_stack_namespace":"kkm-commutator","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","Description":"KKM Commutator Service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task":""}}},"host":{"name":"44fcff07405a"},"ecs":{"version":"1.0.1"},"log":{"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"},"offset":23404318},"stream":"stdout","input":{"type":"container"},"container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e"},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"},"json":{"X-B3-SpanId":"725f7f784afd6230","msg":"ReadyForSendingReceiptKeys is EMPTY","caller_file_name":"KkmCommutatorService.java","thread":"scheduling-1","spanId":"725f7f784afd6230","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys","spanExportable":"true","X-B3-TraceId":"725f7f784afd6230","ts":"2020-07-29T00:12:50.291+00:00","level":"INFO","traceId":"725f7f784afd6230","caller_line_number":82,"X-Span-Export":"true"}}},{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"uTDsl3MBtD96ebe8BR3e","_score":3.6650221,"_source":{"@timestamp":"2020-07-29T00:14:49.595Z","host":{"name":"44fcff07405a"},"agent":{"version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072"},"json":{"ts":"2020-07-29T00:14:49.595+00:00","X-Span-Export":"true","caller_file_name":"KkmCommutatorService.java","traceId":"47d1e3613cdcfeeb","spanExportable":"true","X-B3-SpanId":"47d1e3613cdcfeeb","msg":"ReadyForSendingReceiptKeys is EMPTY","level":"INFO","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys","caller_line_number":82,"thread":"scheduling-1","X-B3-TraceId":"47d1e3613cdcfeeb","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","spanId":"47d1e3613cdcfeeb"},"stream":"stdout","message":"{\"ts\":\"2020-07-29T00:14:49.595+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"47d1e3613cdcfeeb\",\"spanId\":\"47d1e3613cdcfeeb\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"47d1e3613cdcfeeb\",\"X-B3-TraceId\":\"47d1e3613cdcfeeb\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","Version":"97","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","Description":"KKM Commutator Service","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e"}}},"ecs":{"version":"1.0.1"},"log":{"offset":23447408,"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"}}}},{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"SjDtl3MBtD96ebe82oir","_score":3.6650221,"_source":{"@timestamp":"2020-07-29T00:16:49.402Z","stream":"stdout","agent":{"id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a"},"json":{"X-B3-TraceId":"1209e1ec268a17ee","ts":"2020-07-29T00:16:49.402+00:00","level":"INFO","method":"getReadyForSendingReceiptKeys","caller_line_number":82,"X-Span-Export":"true","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","X-B3-SpanId":"1209e1ec268a17ee","thread":"scheduling-1","msg":"ReadyForSendingReceiptKeys is EMPTY","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_file_name":"KkmCommutatorService.java","traceId":"1209e1ec268a17ee","spanId":"1209e1ec268a17ee","spanExportable":"true"},"host":{"name":"44fcff07405a"},"log":{"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"},"offset":23490944},"message":"{\"ts\":\"2020-07-29T00:16:49.402+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"1209e1ec268a17ee\",\"spanId\":\"1209e1ec268a17ee\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"1209e1ec268a17ee\",\"X-B3-TraceId\":\"1209e1ec268a17ee\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","Version":"97","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"}}}]}}
1191040 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0067'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0067'
1191063 [main] INFO  kkm.UnitTests - End test

1191064 [main] INFO  kkm.UnitTests - Starting test: KKM_DB8()
1191208 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-JBtXGwCj1OeU', '8974775503', '2019-07-12 00:00:00.000', '7710026574', 'NOFILIAL');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-JBtXGwCj1OeU','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-JBtXGwCj1OeU', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-JBtXGwCj1OeU', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-JBtXGwCj1OeU'

update alertPeriod set finishTime = '00:00:00' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '00:00:00' where FilialCode = 'NOFILIAL'
update fiscalCheck set filialCode = 'NOFILIAL' where srcId = '9SD0C9DZ-9289-4A09-JBtXGwCj1OeU'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-JBtXGwCj1OeU'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-JBtXGwCj1OeU'
1302340 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-JBtXGwCj1OeU'
1302341 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-JBtXGwCj1OeU, null]
1302345 [main] INFO  kkm.UnitTests - Status: null
1302345 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
1302346 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
1322348 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.29/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
1322402 [main] INFO  kkm.UnitTests - Response message : {"took":2,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":333,"relation":"eq"},"max_score":3.6645412,"hits":[{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"hS3fl3MBtD96ebe8LDJ-","_score":3.6645412,"_source":{"@timestamp":"2020-07-29T00:00:49.181Z","log":{"offset":23142671,"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"}},"input":{"type":"container"},"container":{"name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919"},"docker":{"container":{"labels":{"com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","com_docker_swarm_service_name":"kkm-commutator_service","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9"}}},"host":{"name":"44fcff07405a"},"agent":{"version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072"},"json":{"logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys","spanExportable":"true","X-B3-TraceId":"b53687d72a31bf84","msg":"ReadyForSendingReceiptKeys is EMPTY","level":"INFO","X-B3-SpanId":"b53687d72a31bf84","ts":"2020-07-29T00:00:49.179+00:00","caller_file_name":"KkmCommutatorService.java","caller_line_number":82,"thread":"scheduling-1","X-Span-Export":"true","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","traceId":"b53687d72a31bf84","spanId":"b53687d72a31bf84"},"stream":"stdout","message":"{\"ts\":\"2020-07-29T00:00:49.179+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"b53687d72a31bf84\",\"spanId\":\"b53687d72a31bf84\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"b53687d72a31bf84\",\"X-B3-TraceId\":\"b53687d72a31bf84\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","ecs":{"version":"1.0.1"}}},{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"qDDvl3MBtD96ebe8r_Z6","_score":3.6645412,"_source":{"@timestamp":"2020-07-29T00:18:49.723Z","log":{"offset":23539049,"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"}},"stream":"stdout","input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","Version":"97","com_docker_swarm_task":"","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","Description":"KKM Commutator Service","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e"}}},"host":{"name":"44fcff07405a"},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"},"message":"{\"ts\":\"2020-07-29T00:18:49.722+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"f166301c5d4a856f\",\"spanId\":\"f166301c5d4a856f\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"f166301c5d4a856f\",\"X-B3-TraceId\":\"f166301c5d4a856f\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","container":{"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"json":{"logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","X-Span-Export":"true","level":"INFO","caller_line_number":82,"traceId":"f166301c5d4a856f","spanId":"f166301c5d4a856f","method":"getReadyForSendingReceiptKeys","thread":"scheduling-1","spanExportable":"true","X-B3-TraceId":"f166301c5d4a856f","msg":"ReadyForSendingReceiptKeys is EMPTY","ts":"2020-07-29T00:18:49.722+00:00","caller_file_name":"KkmCommutatorService.java","X-B3-SpanId":"f166301c5d4a856f"}}},{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"sDDql3MBtD96ebe8MQ4S","_score":3.6645412,"_source":{"@timestamp":"2020-07-29T00:12:50.291Z","message":"{\"ts\":\"2020-07-29T00:12:50.291+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"725f7f784afd6230\",\"spanId\":\"725f7f784afd6230\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"725f7f784afd6230\",\"X-B3-TraceId\":\"725f7f784afd6230\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_stack_namespace":"kkm-commutator","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","Description":"KKM Commutator Service","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task":""}}},"host":{"name":"44fcff07405a"},"ecs":{"version":"1.0.1"},"log":{"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"},"offset":23404318},"stream":"stdout","input":{"type":"container"},"container":{"image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e"},"agent":{"hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc"},"json":{"X-B3-SpanId":"725f7f784afd6230","msg":"ReadyForSendingReceiptKeys is EMPTY","caller_file_name":"KkmCommutatorService.java","thread":"scheduling-1","spanId":"725f7f784afd6230","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys","spanExportable":"true","X-B3-TraceId":"725f7f784afd6230","ts":"2020-07-29T00:12:50.291+00:00","level":"INFO","traceId":"725f7f784afd6230","caller_line_number":82,"X-Span-Export":"true"}}},{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"uTDsl3MBtD96ebe8BR3e","_score":3.6645412,"_source":{"@timestamp":"2020-07-29T00:14:49.595Z","host":{"name":"44fcff07405a"},"agent":{"version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a","id":"e4ad1055-9ebd-4797-8e83-b74a213a4072"},"json":{"ts":"2020-07-29T00:14:49.595+00:00","X-Span-Export":"true","caller_file_name":"KkmCommutatorService.java","traceId":"47d1e3613cdcfeeb","spanExportable":"true","X-B3-SpanId":"47d1e3613cdcfeeb","msg":"ReadyForSendingReceiptKeys is EMPTY","level":"INFO","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys","caller_line_number":82,"thread":"scheduling-1","X-B3-TraceId":"47d1e3613cdcfeeb","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","spanId":"47d1e3613cdcfeeb"},"stream":"stdout","message":"{\"ts\":\"2020-07-29T00:14:49.595+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"47d1e3613cdcfeeb\",\"spanId\":\"47d1e3613cdcfeeb\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"47d1e3613cdcfeeb\",\"X-B3-TraceId\":\"47d1e3613cdcfeeb\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","Version":"97","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","Description":"KKM Commutator Service","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e"}}},"ecs":{"version":"1.0.1"},"log":{"offset":23447408,"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"}}}},{"_index":"kkm-commutator-test-2020.07.29","_type":"_doc","_id":"SjDtl3MBtD96ebe82oir","_score":3.6645412,"_source":{"@timestamp":"2020-07-29T00:16:49.402Z","stream":"stdout","agent":{"id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a"},"json":{"X-B3-TraceId":"1209e1ec268a17ee","ts":"2020-07-29T00:16:49.402+00:00","level":"INFO","method":"getReadyForSendingReceiptKeys","caller_line_number":82,"X-Span-Export":"true","class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","X-B3-SpanId":"1209e1ec268a17ee","thread":"scheduling-1","msg":"ReadyForSendingReceiptKeys is EMPTY","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_file_name":"KkmCommutatorService.java","traceId":"1209e1ec268a17ee","spanId":"1209e1ec268a17ee","spanExportable":"true"},"host":{"name":"44fcff07405a"},"log":{"file":{"path":"/var/lib/docker/containers/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919/dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919-json.log"},"offset":23490944},"message":"{\"ts\":\"2020-07-29T00:16:49.402+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"1209e1ec268a17ee\",\"spanId\":\"1209e1ec268a17ee\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"1209e1ec268a17ee\",\"X-B3-TraceId\":\"1209e1ec268a17ee\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"dbafdac905a7d93f760aebfc04aaeca8053b6fb2ffab62d382ba83492a254919","name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"mell1zgqaxfs52lz4o568c33e","com_docker_swarm_task_name":"kkm-commutator_service.1.mell1zgqaxfs52lz4o568c33e","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","Version":"97","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"}}}]}}
1322588 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = 'NOFILIAL'
1322610 [main] INFO  kkm.UnitTests - End test

1322611 [main] INFO  kkm.UnitTests - Starting test: KKM_SendMessageWasCanceled()
1325896 [main] INFO  kkm.UnitTests - End test

1325897 [main] INFO  kkm.UnitTests - Starting test: KKM_CanceleNotFound()
1326116 [main] INFO  kkm.UnitTests - End test

1326117 [main] INFO  kkm.UnitTests - Starting test: KKM_makeAndCancelCheckCashier()
1568702 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/esb-test-2020.07.29/_search?q=%20message:%20%22CID=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2%22%20
1568776 [main] INFO  kkm.UnitTests - Response message : {"took":12,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":8,"relation":"eq"},"max_score":40.19761,"hits":[{"_index":"esb-test-2020.07.29","_type":"_doc","_id":"9FkQmXMBtD96ebe8Bssm","_score":40.19761,"_source":{"level":"trace","@timestamp":"2020-07-29T05:33:51.652Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST request  Operation 'CancelReceipt' was call with body: a71828e2-b473-486f-8012-740632871ce8 | exid=ID-esb-test01-39552-1595922638059-71-9492 CID=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2","thread":"qtp1413042234-56052","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38357","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-29T08:33:51,652","input":{"type":"log"},"offset":2640632,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.29","_type":"_doc","_id":"-1kQmXMBtD96ebe8QNCB","_score":38.989902,"_source":{"level":"trace","@timestamp":"2020-07-29T05:33:51.687Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST response Operation 'CancelReceipt' was complete with body: CancelReceiptResponse{correlationId='null', checkId='a71828e2-b473-486f-8012-740632871ce8', canceledCheckId='5eb1dd33-dca3-4bfb-a83c-e451251fb631', error=null} | exid=ID-esb-test01-39552-1595922638059-71-9492 CID=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2","thread":"qtp1413042234-56052","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38357","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-29T08:33:51,687","input":{"type":"log"},"offset":2644719,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.29","_type":"_doc","_id":"81kQmXMBtD96ebe8Bssm","_score":38.41286,"_source":{"level":"debug","@timestamp":"2020-07-29T05:33:51.652Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST request  Operation 'CancelReceipt' was call with headers: {breadcrumbId=ID-esb-test01-39552-1595922638059-71-9491, JMSCorrelationID=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2, operationName=CancelReceipt, X-VSK-CorrelationId=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2} | exid=ID-esb-test01-39552-1595922638059-71-9492 CID=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2","thread":"qtp1413042234-56052","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38357","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-29T08:33:51,652","input":{"type":"log"},"offset":2640153,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.29","_type":"_doc","_id":"9VkQmXMBtD96ebe8Bssm","_score":37.130634,"_source":{"level":"debug","@timestamp":"2020-07-29T05:33:51.653Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'CancelReceipt' calling REST service  with headers: {breadcrumbId=ID-esb-test01-39552-1595922638059-71-9491, CamelHttpMethod=PUT, JMSCorrelationID=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2, operationName=CancelReceipt, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/a71828e2-b473-486f-8012-740632871ce8/cancel, X-VSK-CorrelationId=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2} | exId=ID-esb-test01-39552-1595922638059-71-9494 CID=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2","thread":"thread #4085 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38357","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-29T08:33:51,653","input":{"type":"log"},"offset":2640944,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.29","_type":"_doc","_id":"9lkQmXMBtD96ebe8Bssm","_score":36.43565,"_source":{"level":"trace","@timestamp":"2020-07-29T05:33:51.653Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'CancelReceipt' calling REST service  with headers: {breadcrumbId=ID-esb-test01-39552-1595922638059-71-9491, CamelHttpMethod=PUT, JMSCorrelationID=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2, operationName=CancelReceipt, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/a71828e2-b473-486f-8012-740632871ce8/cancel, X-VSK-CorrelationId=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2} | exId=ID-esb-test01-39552-1595922638059-71-9494 CID=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2 |\n a71828e2-b473-486f-8012-740632871ce8","thread":"thread #4085 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38357","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"},"flags":["multiline"]},"@version":"1","environment":"test","timestamp":"2020-07-29T08:33:51,653","input":{"type":"log"},"offset":2641548,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.29","_type":"_doc","_id":"91kQmXMBtD96ebe8Bssm","_score":34.80692,"_source":{"level":"debug","@timestamp":"2020-07-29T05:33:51.687Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'CancelReceipt' service responded with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-39552-1595922638059-71-9491, CamelHttpMethod=PUT, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Type=application/json;charset=utf-8, Date=Wed, 29 Jul 2020 05:33:51 GMT, JMSCorrelationID=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2, operationName=CancelReceipt, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/a71828e2-b473-486f-8012-740632871ce8/cancel, X-VSK-CorrelationId=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2} | exid=ID-esb-test01-39552-1595922638059-71-9494 CID=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2","thread":"thread #4085 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38357","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-29T08:33:51,687","input":{"type":"log"},"offset":2642192,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.29","_type":"_doc","_id":"-VkQmXMBtD96ebe8Bssm","_score":34.80692,"_source":{"level":"debug","@timestamp":"2020-07-29T05:33:51.687Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: REST response Operation 'CancelReceipt' was complete with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-39552-1595922638059-71-9491, CamelHttpMethod=PUT, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Type=application/json;charset=utf-8, Date=Wed, 29 Jul 2020 05:33:51 GMT, JMSCorrelationID=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2, operationName=CancelReceipt, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/a71828e2-b473-486f-8012-740632871ce8/cancel, X-VSK-CorrelationId=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2} | exid=ID-esb-test01-39552-1595922638059-71-9492 CID=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2","thread":"qtp1413042234-56052","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38357","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},"@version":"1","environment":"test","timestamp":"2020-07-29T08:33:51,687","input":{"type":"log"},"offset":2643901,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}},{"_index":"esb-test-2020.07.29","_type":"_doc","_id":"-FkQmXMBtD96ebe8Bssm","_score":34.19548,"_source":{"level":"trace","@timestamp":"2020-07-29T05:33:51.687Z","prospector":{"type":"log"},"package":"servicemix.esb.kkm","message":"KkmService: 'CancelReceipt' service responded with headers: {Accept=application/json; charset=utf-8, breadcrumbId=ID-esb-test01-39552-1595922638059-71-9491, CamelHttpMethod=PUT, CamelHttpResponseCode=200, CamelHttpResponseText=, Content-Type=application/json;charset=utf-8, Date=Wed, 29 Jul 2020 05:33:51 GMT, JMSCorrelationID=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2, operationName=CancelReceipt, Transfer-Encoding=chunked, UnitariusServiceUri=http://kkm-dev:9192/master-system/api/v1/receipts/a71828e2-b473-486f-8012-740632871ce8/cancel, X-VSK-CorrelationId=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2} | exid=ID-esb-test01-39552-1595922638059-71-9494 CID=b0c688bd-4b0d-4599-81a5-d58e5301dd2b2 |\n {\"checkId\":\"a71828e2-b473-486f-8012-740632871ce8\",\"canceledCheckId\":\"5eb1dd33-dca3-4bfb-a83c-e451251fb631\"}","thread":"thread #4085 - seda://kkmRestAPI","beat":{"version":"6.8.10","hostname":"esb-test01","name":"esb-test01"},"bundleid":"38357","log":{"file":{"path":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"},"flags":["multiline"]},"@version":"1","environment":"test","timestamp":"2020-07-29T08:33:51,687","input":{"type":"log"},"offset":2642991,"application":"esb","host":{"name":"esb-test01"},"tags":["beats_input_codec_plain_applied"],"source":"/opt/apache-servicemix-6.1.4/instances/esb001/data/log/esb001.log"}}]}}
1568777 [main] INFO  kkm.UnitTests - End test

1568780 [main] INFO  kkm.UnitTests - Starting test: KKM_SIPheckStatus()
1571426 [main] INFO  kkm.UnitTests - End test

1571428 [main] INFO  kkm.UnitTests - Starting test: KKM_SendMessageNotFound()
1571466 [main] INFO  kkm.UnitTests - End test

1571468 [main] INFO  kkm.UnitTests - Starting test: KKM_PostCorrectionReceipt_negative()
1571575 [main] INFO  kkm.UnitTests - End test

1571577 [main] INFO  kkm.UnitTests - Starting test: KKM_PostCorrectionReceipt()
1574375 [main] INFO  kkm.UnitTests - End test

