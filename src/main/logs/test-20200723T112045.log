168  [main] INFO  kkm.UnitTests - Starting test: KKM_DB6()
1029 [main] INFO  kkm.UnitTests - Script is: --Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-V9VKCDNNRuu2', '7291997136', '2019-07-12 00:00:00.000', '7710026574', '0031');
--
--Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-V9VKCDNNRuu2','Фамилия Имя Отчество', '7710026574', '71000000000' );
--
--Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-V9VKCDNNRuu2', '1522756', 'INCOME');
--
--Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-V9VKCDNNRuu2', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');
--
--insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
--select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
--from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
--where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-V9VKCDNNRuu2'
--
--
--update alertPeriod set finishTime = '00:00:00' where FilialCode = '0031'
--
--update alertPeriod set startTime = '00:00:00' where FilialCode = '0031'
--
--update fiscalCheck set filialCode = '0031' where srcId = '9SD0C9DZ-9289-4A09-V9VKCDNNRuu2'
--
--update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-V9VKCDNNRuu2'
--




Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-V9VKCDNNRuu2', '7291997136', '2019-07-12 00:00:00.000', '7710026574', '0031');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-V9VKCDNNRuu2','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-V9VKCDNNRuu2', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-V9VKCDNNRuu2', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-V9VKCDNNRuu2'

update alertPeriod set finishTime = '00:00:00' where FilialCode = '0031'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0031'
update fiscalCheck set filialCode = '0031' where srcId = '9SD0C9DZ-9289-4A09-V9VKCDNNRuu2'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-V9VKCDNNRuu2'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-V9VKCDNNRuu2'
92239 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-V9VKCDNNRuu2'
92262 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-V9VKCDNNRuu2, null]
92279 [main] INFO  kkm.UnitTests - null
92280 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
92280 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
122387 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.23/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
122550 [main] INFO  kkm.UnitTests - Response message : {"took":13,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1101,"relation":"eq"},"max_score":3.6130707,"hits":[{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"gRH9eHMBfrYj4vM9uv2E","_score":3.6130707,"_source":{"@timestamp":"2020-07-23T00:05:50.393Z","stream":"stdout","message":"{\"ts\":\"2020-07-23T00:05:50.393+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"2cfb4888bd7ad0dd\",\"spanId\":\"2cfb4888bd7ad0dd\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"2cfb4888bd7ad0dd\",\"X-B3-TraceId\":\"2cfb4888bd7ad0dd\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"log":{"offset":21598689,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"host":{"name":"96fa6ced97b1"},"agent":{"version":"7.3.1","type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391"}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"sRH7eHMBfrYj4vM9A38s","_score":3.6130707,"_source":{"@timestamp":"2020-07-23T00:02:49.763Z","message":"{\"ts\":\"2020-07-23T00:02:49.763+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"04876de683850c19\",\"spanId\":\"04876de683850c19\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"04876de683850c19\",\"X-B3-TraceId\":\"04876de683850c19\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","host":{"name":"96fa6ced97b1"},"agent":{"ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1","type":"filebeat"},"docker":{"container":{"labels":{"com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"log":{"offset":21535009,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"stream":"stdout","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"aBICeXMBfrYj4vM9VilL","_score":3.6130707,"_source":{"@timestamp":"2020-07-23T00:10:50.055Z","message":"{\"ts\":\"2020-07-23T00:10:50.055+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"a002feb455881916\",\"spanId\":\"a002feb455881916\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"a002feb455881916\",\"X-B3-TraceId\":\"a002feb455881916\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"ecs":{"version":"1.0.1"},"log":{"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"},"offset":21710704},"stream":"stdout","container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97"}}},"host":{"name":"96fa6ced97b1"},"agent":{"type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1"}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"fxL-eHMBfrYj4vM9rAW_","_score":3.6130707,"_source":{"@timestamp":"2020-07-23T00:06:50.159Z","docker":{"container":{"labels":{"com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3"}}},"host":{"name":"96fa6ced97b1"},"agent":{"hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1","type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5"},"message":"{\"ts\":\"2020-07-23T00:06:50.159+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"e22fce49f7f2b5f1\",\"spanId\":\"e22fce49f7f2b5f1\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"e22fce49f7f2b5f1\",\"X-B3-TraceId\":\"e22fce49f7f2b5f1\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","stream":"stdout","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"log":{"offset":21623596,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"GBIAeXMBfrYj4vM9gRWJ","_score":3.6130707,"_source":{"@timestamp":"2020-07-23T00:08:50.436Z","message":"{\"ts\":\"2020-07-23T00:08:50.436+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"beebe6d90c9d9ef3\",\"spanId\":\"beebe6d90c9d9ef3\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"beebe6d90c9d9ef3\",\"X-B3-TraceId\":\"beebe6d90c9d9ef3\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"agent":{"type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1"},"log":{"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"},"offset":21667152},"stream":"stdout","host":{"name":"96fa6ced97b1"}}}]}}
122678 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0031'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0031'
122733 [main] INFO  kkm.UnitTests - End test

122738 [main] INFO  kkm.UnitTests - Starting test: KKM_DB1()
122874 [main] INFO  kkm.UnitTests - Script is: SELECT TOP 1 * FROM ProcessStatus Where fiscGateCheckStatusCode = 'ERROR'
122875 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000902849
122876 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000902849
123706 [main] INFO  kkm.UnitTests - update dbo.Customer set inn = '1' where srcID = 'ЖПлато_000902849'
update ProcessStatus set fiscGateCheckStatusCode = null where srcID = 'ЖПлато_000902849'
select * from ProcessStatus where srcID = 'ЖПлато_000902849'
123708 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, null, 400, ЖПлато_000902849]
123713 [main] INFO  kkm.UnitTests - Status is: [AXAPTA, PaymentOrder, null, 400, ЖПлато_000902849]
183994 [main] INFO  kkm.UnitTests - select * from ProcessStatus where srcID = 'ЖПлато_000902849'
183995 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, null, 400, ЖПлато_000902849]
184004 [main] INFO  kkm.UnitTests - End test

184022 [main] INFO  kkm.UnitTests - Starting test: KKM_DB8()
184143 [main] INFO  kkm.UnitTests - Script is: --Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-DMKNlclfVKge', '9860505043', '2019-07-12 00:00:00.000', '7710026574', 'NOFILIAL');
--
--Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-DMKNlclfVKge','Фамилия Имя Отчество', '7710026574', '71000000000' );
--
--Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-DMKNlclfVKge', '1522756', 'INCOME');
--
--Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-DMKNlclfVKge', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');
--
--insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
--select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
--from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
--where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-DMKNlclfVKge'
--
--
--update alertPeriod set finishTime = '00:00:00' where FilialCode = 'NOFILIAL'
--
--update alertPeriod set startTime = '00:00:00' where FilialCode = 'NOFILIAL'
--
--update fiscalCheck set filialCode = 'NOFILIAL' where srcId = '9SD0C9DZ-9289-4A09-DMKNlclfVKge'
--
--update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-DMKNlclfVKge'
--




Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-DMKNlclfVKge', '9860505043', '2019-07-12 00:00:00.000', '7710026574', 'NOFILIAL');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-DMKNlclfVKge','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-DMKNlclfVKge', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-DMKNlclfVKge', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-DMKNlclfVKge'

update alertPeriod set finishTime = '00:00:00' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '00:00:00' where FilialCode = 'NOFILIAL'
update fiscalCheck set filialCode = 'NOFILIAL' where srcId = '9SD0C9DZ-9289-4A09-DMKNlclfVKge'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-DMKNlclfVKge'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-DMKNlclfVKge'
275036 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-DMKNlclfVKge'
275037 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-DMKNlclfVKge, null]
275038 [main] INFO  kkm.UnitTests - null
275038 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
275038 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
305043 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.23/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
305101 [main] INFO  kkm.UnitTests - Response message : {"took":3,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1104,"relation":"eq"},"max_score":3.6142366,"hits":[{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"gRH9eHMBfrYj4vM9uv2E","_score":3.6142366,"_source":{"@timestamp":"2020-07-23T00:05:50.393Z","stream":"stdout","message":"{\"ts\":\"2020-07-23T00:05:50.393+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"2cfb4888bd7ad0dd\",\"spanId\":\"2cfb4888bd7ad0dd\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"2cfb4888bd7ad0dd\",\"X-B3-TraceId\":\"2cfb4888bd7ad0dd\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"log":{"offset":21598689,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"host":{"name":"96fa6ced97b1"},"agent":{"version":"7.3.1","type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391"}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"sRH7eHMBfrYj4vM9A38s","_score":3.6142366,"_source":{"@timestamp":"2020-07-23T00:02:49.763Z","message":"{\"ts\":\"2020-07-23T00:02:49.763+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"04876de683850c19\",\"spanId\":\"04876de683850c19\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"04876de683850c19\",\"X-B3-TraceId\":\"04876de683850c19\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","host":{"name":"96fa6ced97b1"},"agent":{"ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1","type":"filebeat"},"docker":{"container":{"labels":{"com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"log":{"offset":21535009,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"stream":"stdout","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"aBICeXMBfrYj4vM9VilL","_score":3.6142366,"_source":{"@timestamp":"2020-07-23T00:10:50.055Z","message":"{\"ts\":\"2020-07-23T00:10:50.055+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"a002feb455881916\",\"spanId\":\"a002feb455881916\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"a002feb455881916\",\"X-B3-TraceId\":\"a002feb455881916\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"ecs":{"version":"1.0.1"},"log":{"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"},"offset":21710704},"stream":"stdout","container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97"}}},"host":{"name":"96fa6ced97b1"},"agent":{"type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1"}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"fxL-eHMBfrYj4vM9rAW_","_score":3.6142366,"_source":{"@timestamp":"2020-07-23T00:06:50.159Z","docker":{"container":{"labels":{"com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3"}}},"host":{"name":"96fa6ced97b1"},"agent":{"hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1","type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5"},"message":"{\"ts\":\"2020-07-23T00:06:50.159+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"e22fce49f7f2b5f1\",\"spanId\":\"e22fce49f7f2b5f1\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"e22fce49f7f2b5f1\",\"X-B3-TraceId\":\"e22fce49f7f2b5f1\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","stream":"stdout","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"log":{"offset":21623596,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"GBIAeXMBfrYj4vM9gRWJ","_score":3.6142366,"_source":{"@timestamp":"2020-07-23T00:08:50.436Z","message":"{\"ts\":\"2020-07-23T00:08:50.436+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"beebe6d90c9d9ef3\",\"spanId\":\"beebe6d90c9d9ef3\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"beebe6d90c9d9ef3\",\"X-B3-TraceId\":\"beebe6d90c9d9ef3\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"agent":{"type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1"},"log":{"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"},"offset":21667152},"stream":"stdout","host":{"name":"96fa6ced97b1"}}}]}}
305241 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = 'NOFILIAL'
305280 [main] INFO  kkm.UnitTests - End test

305284 [main] INFO  kkm.UnitTests - Starting test: KKM_DB3()
305423 [main] INFO  kkm.UnitTests - Script is: --Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-UZ2RBImOujg0', '4997262622', '2019-07-12 00:00:00.000', '7710026574', '0031');
--
--Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-UZ2RBImOujg0','Фамилия Имя Отчество', '7710026574', '71000000000' );
--
--Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-UZ2RBImOujg0', '1522756', 'INCOME');
--
--Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-UZ2RBImOujg0', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');
--
--insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
--select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
--from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
--where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-UZ2RBImOujg0'
--
--
--update alertPeriod set finishTime = '23:59:59' where FilialCode = '0031'
--
--update alertPeriod set startTime = '00:00:00' where FilialCode = '0031'
--
--update fiscalCheck set filialCode = '0031' where srcId = '9SD0C9DZ-9289-4A09-UZ2RBImOujg0'
--
--update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-UZ2RBImOujg0'
--




Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-UZ2RBImOujg0', '4997262622', '2019-07-12 00:00:00.000', '7710026574', '0031');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-UZ2RBImOujg0','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-UZ2RBImOujg0', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-UZ2RBImOujg0', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-UZ2RBImOujg0'

update alertPeriod set finishTime = '23:59:59' where FilialCode = '0031'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0031'
update fiscalCheck set filialCode = '0031' where srcId = '9SD0C9DZ-9289-4A09-UZ2RBImOujg0'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-UZ2RBImOujg0'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-UZ2RBImOujg0'
396093 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-UZ2RBImOujg0'
396094 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, DONE, , , 9SD0C9DZ-9289-4A09-UZ2RBImOujg0, e1d2f0ca-ca7b-4c03-9a2c-a170fbc82e42]
396097 [main] INFO  kkm.UnitTests - DONE
396097 [main] INFO  kkm.UnitTests - fiscGateErrorCode: 
396097 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: 
396207 [main] INFO  kkm.UnitTests - End test

396216 [main] INFO  kkm.UnitTests - Starting test: KKM_DB4()
396345 [main] INFO  kkm.UnitTests - Script is: --Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-4zmrCbZNYcKx', '4609692678', '2019-07-12 00:00:00.000', '7725327863', '0067');
--
--Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-4zmrCbZNYcKx','Фамилия Имя Отчество', '7725327863', '71000000000' );
--
--Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-4zmrCbZNYcKx', '1522756', 'INCOME');
--
--Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-4zmrCbZNYcKx', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');
--
--insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
--select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
--from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
--where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-4zmrCbZNYcKx'
--
--
--update alertPeriod set finishTime = '23:59:59' where FilialCode = '0067'
--
--update alertPeriod set startTime = '00:00:00' where FilialCode = '0067'
--
--update fiscalCheck set filialCode = '0067' where srcId = '9SD0C9DZ-9289-4A09-4zmrCbZNYcKx'
--
--update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-4zmrCbZNYcKx'
--




Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-4zmrCbZNYcKx', '4609692678', '2019-07-12 00:00:00.000', '7725327863', '0067');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-4zmrCbZNYcKx','Фамилия Имя Отчество', '7725327863', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-4zmrCbZNYcKx', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-4zmrCbZNYcKx', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-4zmrCbZNYcKx'

update alertPeriod set finishTime = '23:59:59' where FilialCode = '0067'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0067'
update fiscalCheck set filialCode = '0067' where srcId = '9SD0C9DZ-9289-4A09-4zmrCbZNYcKx'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-4zmrCbZNYcKx'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-4zmrCbZNYcKx'
487387 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-4zmrCbZNYcKx'
487388 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, SENDED, , , 9SD0C9DZ-9289-4A09-4zmrCbZNYcKx, bad9c5f6-c43d-4664-bafb-6c718097abf0]
487391 [main] INFO  kkm.UnitTests - SENDED
487392 [main] INFO  kkm.UnitTests - fiscGateErrorCode: 
487392 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: 
487457 [main] INFO  kkm.UnitTests - End test

487465 [main] INFO  kkm.UnitTests - Starting test: KKM_DB2()
487622 [main] INFO  kkm.UnitTests - Script is: SELECT TOP 1 * FROM ProcessStatus Where fiscGateCheckStatusCode = 'DONE'
487622 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000898541
487626 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000898541
488136 [main] INFO  kkm.UnitTests - update alertPeriod set finishTime = '00:00:00' where FilialCode = '--filialCode--'
update alertPeriod set startTime = '00:00:00' where FilialCode = '--filialCode--'
update customer set Phone = '70000000000' where srcID = 'ЖПлато_000898541'
update customer set email = '' where srcId = 'ЖПлато_000898541'
update processStatus set fiscGateCheckStatusCode = null where srcID = 'ЖПлато_000898541'
select * from processStatus where srcID = 'ЖПлато_000898541'
488137 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, null, nothing, ЖПлато_000898541]
488140 [main] INFO  kkm.UnitTests - Status is: [AXAPTA, PaymentOrder, null, nothing, ЖПлато_000898541]
548443 [main] INFO  kkm.UnitTests - select * from ProcessStatus where srcID = 'ЖПлато_000898541'
548443 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, SENDED, nothing, ЖПлато_000898541]
608451 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.23/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%22ЖПлато_000898541%22%20&size=500
608552 [main] INFO  kkm.UnitTests - Response message : {"took":8,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":11.806723,"hits":[{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"6-OUenMBtD96ebe8GMWs","_score":11.806723,"_source":{"@timestamp":"2020-07-23T07:29:50.181Z","log":{"offset":31625793,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"input":{"type":"container"},"agent":{"id":"e4ad1055-9ebd-4797-8e83-b74a213a4072","version":"7.3.1","type":"filebeat","ephemeral_id":"a7e14d42-94af-47f2-a1e3-c27c2fc455cc","hostname":"44fcff07405a"},"message":"{\"ts\":\"2020-07-23T07:29:50.180+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"2b794883727bed5a\",\"spanId\":\"2b794883727bed5a\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"2b794883727bed5a\",\"X-B3-TraceId\":\"2b794883727bed5a\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000898541\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_task":"","Version":"97"}}},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"host":{"name":"44fcff07405a"},"json":{"ts":"2020-07-23T07:29:50.180+00:00","X-VSK-ReceiptKeys":[{"systemCode":"AXAPTA","entityCode":"PaymentOrder","srcID":"ЖПлато_000898541"}],"class":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","method":"getReadyForSendingReceiptKeys","traceId":"2b794883727bed5a","level":"INFO","caller_line_number":84,"spanExportable":"true","X-B3-SpanId":"2b794883727bed5a","X-B3-TraceId":"2b794883727bed5a","msg":"ReadyForSendingReceiptKeys selected ","logger":"ru.vsk.integration.kkmcommutator.KkmCommutatorService","caller_file_name":"KkmCommutatorService.java","thread":"scheduling-1","spanId":"2b794883727bed5a","X-Span-Export":"true"},"stream":"stdout"}}]}}
608553 [main] INFO  kkm.UnitTests - End test

608556 [main] INFO  kkm.UnitTests - Starting test: KKM_DB5()
608687 [main] INFO  kkm.UnitTests - Script is: --Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ', '8693250670', '2019-07-12 00:00:00.000', '7710026574', 'NOFILIAL');
--
--Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ','Фамилия Имя Отчество', '7710026574', '71000000000' );
--
--Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ', '1522756', 'INCOME');
--
--Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');
--
--insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
--select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
--from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
--where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ'
--
--
--update alertPeriod set finishTime = '23:59:59' where FilialCode = 'NOFILIAL'
--
--update alertPeriod set startTime = '00:00:00' where FilialCode = 'NOFILIAL'
--
--update fiscalCheck set filialCode = 'NOFILIAL' where srcId = '9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ'
--
--update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ'
--




Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ', '8693250670', '2019-07-12 00:00:00.000', '7710026574', 'NOFILIAL');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ'

update alertPeriod set finishTime = '23:59:59' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '00:00:00' where FilialCode = 'NOFILIAL'
update fiscalCheck set filialCode = 'NOFILIAL' where srcId = '9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ'
699935 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ'
699936 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, DONE, , , 9SD0C9DZ-9289-4A09-rJ0RYpIc2ciQ, eed9fdd7-97d7-4ad8-b87c-01f12c75070c]
699939 [main] INFO  kkm.UnitTests - DONE
699939 [main] INFO  kkm.UnitTests - fiscGateErrorCode: 
699940 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: 
700044 [main] INFO  kkm.UnitTests - End test

700050 [main] INFO  kkm.UnitTests - Starting test: KKM_DB7()
700185 [main] INFO  kkm.UnitTests - Script is: --Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-glcByEfhkd1v', '4687424958', '2019-07-12 00:00:00.000', '7725327863', '0067');
--
--Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-glcByEfhkd1v','Фамилия Имя Отчество', '7725327863', '71000000000' );
--
--Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-glcByEfhkd1v', '1522756', 'INCOME');
--
--Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
--values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-glcByEfhkd1v', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');
--
--insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
--select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
--from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
--where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-glcByEfhkd1v'
--
--
--update alertPeriod set finishTime = '00:00:00' where FilialCode = '0067'
--
--update alertPeriod set startTime = '00:00:00' where FilialCode = '0067'
--
--update fiscalCheck set filialCode = '0067' where srcId = '9SD0C9DZ-9289-4A09-glcByEfhkd1v'
--
--update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-glcByEfhkd1v'
--




Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-glcByEfhkd1v', '4687424958', '2019-07-12 00:00:00.000', '7725327863', '0067');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-glcByEfhkd1v','Фамилия Имя Отчество', '7725327863', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-glcByEfhkd1v', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-glcByEfhkd1v', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-glcByEfhkd1v'

update alertPeriod set finishTime = '00:00:00' where FilialCode = '0067'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0067'
update fiscalCheck set filialCode = '0067' where srcId = '9SD0C9DZ-9289-4A09-glcByEfhkd1v'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-glcByEfhkd1v'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-glcByEfhkd1v'
791105 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-glcByEfhkd1v'
791106 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-glcByEfhkd1v, null]
791109 [main] INFO  kkm.UnitTests - null
791109 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
791109 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
821113 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-test-2020.07.23/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
821169 [main] INFO  kkm.UnitTests - Response message : {"took":2,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1113,"relation":"eq"},"max_score":3.623024,"hits":[{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"gRH9eHMBfrYj4vM9uv2E","_score":3.623024,"_source":{"@timestamp":"2020-07-23T00:05:50.393Z","stream":"stdout","message":"{\"ts\":\"2020-07-23T00:05:50.393+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"2cfb4888bd7ad0dd\",\"spanId\":\"2cfb4888bd7ad0dd\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"2cfb4888bd7ad0dd\",\"X-B3-TraceId\":\"2cfb4888bd7ad0dd\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"log":{"offset":21598689,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"host":{"name":"96fa6ced97b1"},"agent":{"version":"7.3.1","type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391"}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"sRH7eHMBfrYj4vM9A38s","_score":3.623024,"_source":{"@timestamp":"2020-07-23T00:02:49.763Z","message":"{\"ts\":\"2020-07-23T00:02:49.763+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"04876de683850c19\",\"spanId\":\"04876de683850c19\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"04876de683850c19\",\"X-B3-TraceId\":\"04876de683850c19\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","host":{"name":"96fa6ced97b1"},"agent":{"ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1","type":"filebeat"},"docker":{"container":{"labels":{"com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"log":{"offset":21535009,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}},"stream":"stdout","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"aBICeXMBfrYj4vM9VilL","_score":3.623024,"_source":{"@timestamp":"2020-07-23T00:10:50.055Z","message":"{\"ts\":\"2020-07-23T00:10:50.055+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"a002feb455881916\",\"spanId\":\"a002feb455881916\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"a002feb455881916\",\"X-B3-TraceId\":\"a002feb455881916\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"ecs":{"version":"1.0.1"},"log":{"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"},"offset":21710704},"stream":"stdout","container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97"}}},"host":{"name":"96fa6ced97b1"},"agent":{"type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1"}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"fxL-eHMBfrYj4vM9rAW_","_score":3.623024,"_source":{"@timestamp":"2020-07-23T00:06:50.159Z","docker":{"container":{"labels":{"com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3"}}},"host":{"name":"96fa6ced97b1"},"agent":{"hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1","type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5"},"message":"{\"ts\":\"2020-07-23T00:06:50.159+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"e22fce49f7f2b5f1\",\"spanId\":\"e22fce49f7f2b5f1\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"e22fce49f7f2b5f1\",\"X-B3-TraceId\":\"e22fce49f7f2b5f1\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","stream":"stdout","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"log":{"offset":21623596,"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"}}}},{"_index":"kkm-commutator-test-2020.07.23","_type":"_doc","_id":"GBIAeXMBfrYj4vM9gRWJ","_score":3.623024,"_source":{"@timestamp":"2020-07-23T00:08:50.436Z","message":"{\"ts\":\"2020-07-23T00:08:50.436+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"beebe6d90c9d9ef3\",\"spanId\":\"beebe6d90c9d9ef3\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"beebe6d90c9d9ef3\",\"X-B3-TraceId\":\"beebe6d90c9d9ef3\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","input":{"type":"container"},"container":{"id":"e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31","name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.xxp3ce2xu0x5mz8j5okn2nkz3","Description":"KKM Commutator Service","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task_id":"xxp3ce2xu0x5mz8j5okn2nkz3","Version":"97","com_docker_swarm_service_id":"7sy4bxg3vjd3qexelmqu7dul9","com_docker_swarm_node_id":"rdhag2o7wwmqoenobm498lkb8"}}},"ecs":{"version":"1.0.1"},"agent":{"type":"filebeat","ephemeral_id":"0fe59679-2e75-446f-bf5a-d3d540dd3ec5","hostname":"96fa6ced97b1","id":"1b249d74-28a0-4e1d-b8f8-952cfe9d8391","version":"7.3.1"},"log":{"file":{"path":"/var/lib/docker/containers/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31/e9efbdc2e769fa9c2ba54f6edef35e9c36bd3e503d3dbb3f78dcd89ff255aa31-json.log"},"offset":21667152},"stream":"stdout","host":{"name":"96fa6ced97b1"}}}]}}
821311 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0067'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0067'
821343 [main] INFO  kkm.UnitTests - End test

