167  [main] INFO  kkm.UnitTests - Starting test: KKM_DB1()
2800 [main] INFO  kkm.UnitTests - Script is: SELECT TOP 1 * FROM ProcessStatus Where fiscGateCheckStatusCode = 'ERROR'
2808 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000898622
2814 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000898622
3231 [main] INFO  kkm.UnitTests - update dbo.Customer set inn = '1' where srcID = 'ЖПлато_000898622'
update ProcessStatus set fiscGateCheckStatusCode = null where srcID = 'ЖПлато_000898622'
select * from ProcessStatus where srcID = 'ЖПлато_000898622'
3231 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, null, VALIDATION_ERROR, ЖПлато_000898622]
3234 [main] INFO  kkm.UnitTests - Status is: [AXAPTA, PaymentOrder, null, VALIDATION_ERROR, ЖПлато_000898622]
63488 [main] INFO  kkm.UnitTests - select * from ProcessStatus where srcID = 'ЖПлато_000898622'
63489 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, ERROR, VALIDATION_ERROR, ЖПлато_000898622]
123636 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-stage-2020.07.24/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%22ЖПлато_000898622%22%20&size=500
123920 [main] INFO  kkm.UnitTests - Response message : {"took":161,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":12.288383,"hits":[{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"A8Rtf3MBfrYj4vM941ee","_score":12.288383,"_source":{"@timestamp":"2020-07-24T06:06:09.095Z","message":"{\"ts\":\"2020-07-24T06:06:09.093+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"358b833597423eb1\",\"spanId\":\"358b833597423eb1\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"358b833597423eb1\",\"X-B3-TraceId\":\"358b833597423eb1\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000898622\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","input":{"type":"container"},"container":{"id":"696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5","name":"kkm-commutator_service.1.rsbhpo3kr9y2xy2cwv2x95c8v","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"host":{"name":"25805977eece"},"agent":{"type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1"},"log":{"offset":6065520,"file":{"path":"/var/lib/docker/containers/696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5/696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5-json.log"}},"stream":"stdout","docker":{"container":{"labels":{"com_docker_swarm_task":"","com_docker_swarm_task_id":"rsbhpo3kr9y2xy2cwv2x95c8v","com_docker_swarm_task_name":"kkm-commutator_service.1.rsbhpo3kr9y2xy2cwv2x95c8v","Description":"KKM Commutator Service","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","Version":"97","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd"}}},"ecs":{"version":"1.0.1"}}}]}}
123925 [main] INFO  kkm.UnitTests - End test

123930 [main] INFO  kkm.UnitTests - Starting test: KKM_DB2()
124085 [main] INFO  kkm.UnitTests - Script is: SELECT TOP 1 * FROM ProcessStatus Where fiscGateCheckStatusCode = 'DONE'
124085 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000898541
124087 [main] INFO  kkm.UnitTests - srcID is: ЖПлато_000898541
124575 [main] INFO  kkm.UnitTests - update alertPeriod set finishTime = '00:00:00' where FilialCode = '--filialCode--'
update alertPeriod set startTime = '00:00:00' where FilialCode = '--filialCode--'
update customer set Phone = '70000000000' where srcID = 'ЖПлато_000898541'
update customer set email = '' where srcId = 'ЖПлато_000898541'
update processStatus set fiscGateCheckStatusCode = null where srcID = 'ЖПлато_000898541'
select * from processStatus where srcID = 'ЖПлато_000898541'
124576 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, null, nothing, ЖПлато_000898541]
124581 [main] INFO  kkm.UnitTests - Status is: [AXAPTA, PaymentOrder, null, nothing, ЖПлато_000898541]
184837 [main] INFO  kkm.UnitTests - select * from ProcessStatus where srcID = 'ЖПлато_000898541'
184837 [main] INFO  kkm.UnitTests - Table String info is: [AXAPTA, PaymentOrder, SENDED, nothing, ЖПлато_000898541]
244840 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-stage-2020.07.24/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%22ЖПлато_000898541%22%20&size=500
245140 [main] INFO  kkm.UnitTests - Response message : {"took":247,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":11.564329,"hits":[{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"vsVvf3MBfrYj4vM9uOVs","_score":11.564329,"_source":{"@timestamp":"2020-07-24T06:08:09.058Z","docker":{"container":{"labels":{"com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_id":"rsbhpo3kr9y2xy2cwv2x95c8v","com_docker_swarm_task_name":"kkm-commutator_service.1.rsbhpo3kr9y2xy2cwv2x95c8v","Description":"KKM Commutator Service","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","Version":"97","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd"}}},"host":{"name":"25805977eece"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"container":{"id":"696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5","name":"kkm-commutator_service.1.rsbhpo3kr9y2xy2cwv2x95c8v","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"log":{"offset":6169244,"file":{"path":"/var/lib/docker/containers/696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5/696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5-json.log"}},"stream":"stdout","message":"{\"ts\":\"2020-07-24T06:08:09.057+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"ac9295396100359c\",\"spanId\":\"ac9295396100359c\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"ac9295396100359c\",\"X-B3-TraceId\":\"ac9295396100359c\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"AXAPTA\",\"entityCode\":\"PaymentOrder\",\"srcID\":\"ЖПлато_000898541\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","input":{"type":"container"}}}]}}
245143 [main] INFO  kkm.UnitTests - End test

245147 [main] INFO  kkm.UnitTests - Starting test: KKM_DB3()
245277 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-vTweXpo5xl9T', '1271373941', '2019-07-12 00:00:00.000', '7710026574', '0031');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-vTweXpo5xl9T','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-vTweXpo5xl9T', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-vTweXpo5xl9T', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-vTweXpo5xl9T'

update alertPeriod set finishTime = '23:59:59' where FilialCode = '0031'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0031'
update fiscalCheck set filialCode = '0031' where srcId = '9SD0C9DZ-9289-4A09-vTweXpo5xl9T'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-vTweXpo5xl9T'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-vTweXpo5xl9T'
356354 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-vTweXpo5xl9T'
356355 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, DONE, , , 9SD0C9DZ-9289-4A09-vTweXpo5xl9T, f69403a2-585e-4f90-ab4e-563fa49b5666]
356360 [main] INFO  kkm.UnitTests - Status: DONE
356361 [main] INFO  kkm.UnitTests - fiscGateErrorCode: 
356361 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: 
376551 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-stage-2020.07.24/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%229SD0C9DZ-9289-4A09-vTweXpo5xl9T%22%20&size=500
376619 [main] INFO  kkm.UnitTests - Response message : {"took":16,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":17.942884,"hits":[{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"Jsdxf3MBfrYj4vM9jTJC","_score":17.942884,"_source":{"@timestamp":"2020-07-24T06:10:09.224Z","agent":{"version":"7.3.1","type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876"},"container":{"id":"696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5","name":"kkm-commutator_service.1.rsbhpo3kr9y2xy2cwv2x95c8v","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"log":{"offset":6289855,"file":{"path":"/var/lib/docker/containers/696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5/696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5-json.log"}},"stream":"stdout","input":{"type":"container"},"docker":{"container":{"labels":{"Version":"97","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_id":"rsbhpo3kr9y2xy2cwv2x95c8v","com_docker_swarm_task_name":"kkm-commutator_service.1.rsbhpo3kr9y2xy2cwv2x95c8v","Description":"KKM Commutator Service","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n"}}},"ecs":{"version":"1.0.1"},"host":{"name":"25805977eece"},"message":"{\"ts\":\"2020-07-24T06:10:09.223+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"3ccc1616044bc401\",\"spanId\":\"3ccc1616044bc401\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"3ccc1616044bc401\",\"X-B3-TraceId\":\"3ccc1616044bc401\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-4igMiAhUxvGi\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-kBkmUSuwbJuI\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-LamuYlCh1vFX\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-I2Nj1n4jpFpQ\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-GbUnx5FNICMm\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-VJW9le71GaKQ\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-vTweXpo5xl9T\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-xauVlorBodFf\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-kNjXS80McKz3\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-vMBoqM8IwlQ5\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}"}}]}}
376743 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0031'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0031'
376769 [main] INFO  kkm.UnitTests - End test

376771 [main] INFO  kkm.UnitTests - Starting test: KKM_DB4()
376887 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-0q3Y6z4wdYdR', '0776461042', '2019-07-12 00:00:00.000', '7725327863', '0067');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-0q3Y6z4wdYdR','Фамилия Имя Отчество', '7725327863', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-0q3Y6z4wdYdR', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-0q3Y6z4wdYdR', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-0q3Y6z4wdYdR'

update alertPeriod set finishTime = '23:59:59' where FilialCode = '0067'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0067'
update fiscalCheck set filialCode = '0067' where srcId = '9SD0C9DZ-9289-4A09-0q3Y6z4wdYdR'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-0q3Y6z4wdYdR'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-0q3Y6z4wdYdR'
487813 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-0q3Y6z4wdYdR'
487814 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, FAIL, BAD_REQUEST, Bad request: {
  "errors": [
    "Передача данных автомата недоступна для указанной группы"
  ]
}, 9SD0C9DZ-9289-4A09-0q3Y6z4wdYdR, 991b5dac-a523-44fa-a217-51b340f6dc5e]
487817 [main] INFO  kkm.UnitTests - Status: FAIL
487817 [main] INFO  kkm.UnitTests - fiscGateErrorCode: BAD_REQUEST
487817 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: Bad request: {
  "errors": [
    "Передача данных автомата недоступна для указанной группы"
  ]
}
508190 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-stage-2020.07.24/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%229SD0C9DZ-9289-4A09-0q3Y6z4wdYdR%22%20&size=500
508247 [main] INFO  kkm.UnitTests - Response message : {"took":6,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":27.517803,"hits":[{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"uchzf3MBfrYj4vM9Ygce","_score":27.517803,"_source":{"@timestamp":"2020-07-24T06:12:09.117Z","agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"ecs":{"version":"1.0.1"},"message":"{\"ts\":\"2020-07-24T06:12:09.117+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"dddf0332af69275d\",\"spanId\":\"dddf0332af69275d\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"dddf0332af69275d\",\"X-B3-TraceId\":\"dddf0332af69275d\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-fBVMmr0uK5mN\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-0q3Y6z4wdYdR\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","log":{"offset":6651349,"file":{"path":"/var/lib/docker/containers/696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5/696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5-json.log"}},"input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_task_name":"kkm-commutator_service.1.rsbhpo3kr9y2xy2cwv2x95c8v","Description":"KKM Commutator Service","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_id":"rsbhpo3kr9y2xy2cwv2x95c8v","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","Version":"97","com_docker_stack_namespace":"kkm-commutator"}}},"stream":"stdout","container":{"id":"696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5","name":"kkm-commutator_service.1.rsbhpo3kr9y2xy2cwv2x95c8v","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"host":{"name":"25805977eece"}}}]}}
508389 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0067'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0067'
508414 [main] INFO  kkm.UnitTests - End test

508418 [main] INFO  kkm.UnitTests - Starting test: KKM_DB5()
508538 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-o49IaR8tifOy', '7994257016', '2019-07-12 00:00:00.000', '7710026574', 'NOFILIAL');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-o49IaR8tifOy','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-o49IaR8tifOy', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-o49IaR8tifOy', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-o49IaR8tifOy'

update alertPeriod set finishTime = '23:59:59' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '00:00:00' where FilialCode = 'NOFILIAL'
update fiscalCheck set filialCode = 'NOFILIAL' where srcId = '9SD0C9DZ-9289-4A09-o49IaR8tifOy'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-o49IaR8tifOy'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-o49IaR8tifOy'
619642 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-o49IaR8tifOy'
619643 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, DONE, , , 9SD0C9DZ-9289-4A09-o49IaR8tifOy, 0b03d94d-d27c-4e62-99c7-b8e9235b37fc]
619648 [main] INFO  kkm.UnitTests - Status: DONE
619648 [main] INFO  kkm.UnitTests - fiscGateErrorCode: 
619648 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: 
639825 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-stage-2020.07.24/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20AND%20%229SD0C9DZ-9289-4A09-o49IaR8tifOy%22%20&size=500
639941 [main] INFO  kkm.UnitTests - Response message : {"took":32,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":27.098589,"hits":[{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"3sl1f3MBfrYj4vM9Ngbw","_score":27.098589,"_source":{"@timestamp":"2020-07-24T06:14:09.242Z","log":{"offset":6795809,"file":{"path":"/var/lib/docker/containers/696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5/696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5-json.log"}},"stream":"stdout","message":"{\"ts\":\"2020-07-24T06:14:09.242+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":84,\"thread\":\"scheduling-1\",\"traceId\":\"725f9a130a42f1a5\",\"spanId\":\"725f9a130a42f1a5\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"725f9a130a42f1a5\",\"X-B3-TraceId\":\"725f9a130a42f1a5\",\"X-VSK-ReceiptKeys\":[{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-o49IaR8tifOy\"},{\"systemCode\":\"ADINSURE\",\"entityCode\":\"Payment\",\"srcID\":\"9SD0C9DZ-9289-4A09-8DosufumonW3\"}],\"msg\":\"ReadyForSendingReceiptKeys selected \"}","container":{"id":"696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5","name":"kkm-commutator_service.1.rsbhpo3kr9y2xy2cwv2x95c8v","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"ecs":{"version":"1.0.1"},"host":{"name":"25805977eece"},"input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_id":"rsbhpo3kr9y2xy2cwv2x95c8v","com_docker_swarm_task_name":"kkm-commutator_service.1.rsbhpo3kr9y2xy2cwv2x95c8v","Description":"KKM Commutator Service","Version":"97","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd"}}},"agent":{"type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1"}}}]}}
640070 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = 'NOFILIAL'
640094 [main] INFO  kkm.UnitTests - End test

640095 [main] INFO  kkm.UnitTests - Starting test: KKM_DB6()
640214 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-RZEcjVcWKREa', '1448885519', '2019-07-12 00:00:00.000', '7710026574', '0031');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-RZEcjVcWKREa','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-RZEcjVcWKREa', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-RZEcjVcWKREa', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-RZEcjVcWKREa'

update alertPeriod set finishTime = '00:00:00' where FilialCode = '0031'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0031'
update fiscalCheck set filialCode = '0031' where srcId = '9SD0C9DZ-9289-4A09-RZEcjVcWKREa'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-RZEcjVcWKREa'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-RZEcjVcWKREa'
751177 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-RZEcjVcWKREa'
751178 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-RZEcjVcWKREa, null]
751182 [main] INFO  kkm.UnitTests - Status: null
751182 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
751183 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
771192 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-stage-2020.07.24/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
771330 [main] INFO  kkm.UnitTests - Response message : {"took":75,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":750,"relation":"eq"},"max_score":5.5125375,"hits":[{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"dpn-fnMBfrYj4vM9rllb","_score":5.5125375,"_source":{"@timestamp":"2020-07-24T04:04:41.968Z","stream":"stdout","log":{"offset":774733,"file":{"path":"/var/lib/docker/containers/e18f19a7cd33e89c860e1b31f01e648f7fdd65d6fb2c9c5dfe19bfdc4d76b28b/e18f19a7cd33e89c860e1b31f01e648f7fdd65d6fb2c9c5dfe19bfdc4d76b28b-json.log"}},"input":{"type":"container"},"container":{"id":"e18f19a7cd33e89c860e1b31f01e648f7fdd65d6fb2c9c5dfe19bfdc4d76b28b","name":"kkm-commutator_service.1.oblpq9bam4o7ngzg5rjg15phn","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_task_name":"kkm-commutator_service.1.oblpq9bam4o7ngzg5rjg15phn","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_task_id":"oblpq9bam4o7ngzg5rjg15phn","Description":"KKM Commutator Service","Version":"97","com_docker_swarm_task":"","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_stack_namespace":"kkm-commutator"}}},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"message":"{\"ts\":\"2020-07-24T04:04:41.968+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","ecs":{"version":"1.0.1"},"host":{"name":"25805977eece"}}},{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"-5j8fnMBfrYj4vM9efoG","_score":5.5125375,"_source":{"@timestamp":"2020-07-24T04:02:17.266Z","stream":"stdout","container":{"name":"kkm-commutator_service.1.la3yz63wepu5zi890sitccied","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"b29b9e0a968b9ae2c134fa4060a78acf0f9676ca149c24cce79feea01424eff6"},"docker":{"container":{"labels":{"com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","com_docker_swarm_task_id":"la3yz63wepu5zi890sitccied","Description":"KKM Commutator Service","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_name":"kkm-commutator_service.1.la3yz63wepu5zi890sitccied","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","Version":"97"}}},"ecs":{"version":"1.0.1"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"log":{"offset":774751,"file":{"path":"/var/lib/docker/containers/b29b9e0a968b9ae2c134fa4060a78acf0f9676ca149c24cce79feea01424eff6/b29b9e0a968b9ae2c134fa4060a78acf0f9676ca149c24cce79feea01424eff6-json.log"}},"message":"{\"ts\":\"2020-07-24T04:02:17.266+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","input":{"type":"container"},"host":{"name":"25805977eece"}}},{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"GJoAf3MBfrYj4vM941xh","_score":5.5125375,"_source":{"@timestamp":"2020-07-24T04:07:06.471Z","ecs":{"version":"1.0.1"},"host":{"name":"25805977eece"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"message":"{\"ts\":\"2020-07-24T04:07:06.471+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","log":{"offset":774748,"file":{"path":"/var/lib/docker/containers/14db796fc0ebe5f229c572d061248713b2c0933a2584bc427b3efbf02090b8ea/14db796fc0ebe5f229c572d061248713b2c0933a2584bc427b3efbf02090b8ea-json.log"}},"stream":"stdout","container":{"id":"14db796fc0ebe5f229c572d061248713b2c0933a2584bc427b3efbf02090b8ea","name":"kkm-commutator_service.1.5ab7hm5uettvefpahnh7oqnwr","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_name":"kkm-commutator_service","Description":"KKM Commutator Service","com_docker_swarm_task_name":"kkm-commutator_service.1.5ab7hm5uettvefpahnh7oqnwr","com_docker_swarm_task_id":"5ab7hm5uettvefpahnh7oqnwr","Version":"97","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":""}}}}},{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"HZoDf3MBfrYj4vM9GNjS","_score":5.5125375,"_source":{"@timestamp":"2020-07-24T04:09:31.943Z","message":"{\"ts\":\"2020-07-24T04:09:31.942+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","input":{"type":"container"},"container":{"name":"kkm-commutator_service.1.rsbhpo3kr9y2xy2cwv2x95c8v","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5"},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_id":"rsbhpo3kr9y2xy2cwv2x95c8v","com_docker_swarm_task_name":"kkm-commutator_service.1.rsbhpo3kr9y2xy2cwv2x95c8v","Version":"97","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd"}}},"host":{"name":"25805977eece"},"stream":"stdout","ecs":{"version":"1.0.1"},"agent":{"type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1"},"log":{"file":{"path":"/var/lib/docker/containers/696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5/696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5-json.log"},"offset":774747}}},{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"N24ifnMBfrYj4vM9fdVq","_score":3.7856863,"_source":{"@timestamp":"2020-07-24T00:04:09.050Z","input":{"type":"container"},"container":{"id":"8acdbd0e1f6da341879ba61aee84362cfeb386a81e0889176ea90009cea717a3","name":"kkm-commutator_service.1.eqt37is64rgqgyp486kpbqida","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","Description":"KKM Commutator Service","Version":"97","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_task_id":"eqt37is64rgqgyp486kpbqida","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.eqt37is64rgqgyp486kpbqida"}}},"ecs":{"version":"1.0.1"},"agent":{"hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792"},"message":"{\"ts\":\"2020-07-24T00:04:09.050+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"e10f9e688e02e50d\",\"spanId\":\"e10f9e688e02e50d\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"e10f9e688e02e50d\",\"X-B3-TraceId\":\"e10f9e688e02e50d\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","log":{"file":{"path":"/var/lib/docker/containers/8acdbd0e1f6da341879ba61aee84362cfeb386a81e0889176ea90009cea717a3/8acdbd0e1f6da341879ba61aee84362cfeb386a81e0889176ea90009cea717a3-json.log"},"offset":583459},"stream":"stdout","host":{"name":"25805977eece"}}}]}}
771455 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0031'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0031'
771480 [main] INFO  kkm.UnitTests - End test

771481 [main] INFO  kkm.UnitTests - Starting test: KKM_DB7()
771597 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-g4JohKpMDIgX', '1738742514', '2019-07-12 00:00:00.000', '7725327863', '0067');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-g4JohKpMDIgX','Фамилия Имя Отчество', '7725327863', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-g4JohKpMDIgX', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-g4JohKpMDIgX', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-g4JohKpMDIgX'

update alertPeriod set finishTime = '00:00:00' where FilialCode = '0067'
update alertPeriod set startTime = '00:00:00' where FilialCode = '0067'
update fiscalCheck set filialCode = '0067' where srcId = '9SD0C9DZ-9289-4A09-g4JohKpMDIgX'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-g4JohKpMDIgX'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-g4JohKpMDIgX'
882419 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-g4JohKpMDIgX'
882420 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-g4JohKpMDIgX, null]
882424 [main] INFO  kkm.UnitTests - Status: null
882424 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
882424 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
902427 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-stage-2020.07.24/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
902487 [main] INFO  kkm.UnitTests - Response message : {"took":5,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":756,"relation":"eq"},"max_score":5.50935,"hits":[{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"dpn-fnMBfrYj4vM9rllb","_score":5.50935,"_source":{"@timestamp":"2020-07-24T04:04:41.968Z","stream":"stdout","log":{"offset":774733,"file":{"path":"/var/lib/docker/containers/e18f19a7cd33e89c860e1b31f01e648f7fdd65d6fb2c9c5dfe19bfdc4d76b28b/e18f19a7cd33e89c860e1b31f01e648f7fdd65d6fb2c9c5dfe19bfdc4d76b28b-json.log"}},"input":{"type":"container"},"container":{"id":"e18f19a7cd33e89c860e1b31f01e648f7fdd65d6fb2c9c5dfe19bfdc4d76b28b","name":"kkm-commutator_service.1.oblpq9bam4o7ngzg5rjg15phn","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_task_name":"kkm-commutator_service.1.oblpq9bam4o7ngzg5rjg15phn","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_task_id":"oblpq9bam4o7ngzg5rjg15phn","Description":"KKM Commutator Service","Version":"97","com_docker_swarm_task":"","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_stack_namespace":"kkm-commutator"}}},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"message":"{\"ts\":\"2020-07-24T04:04:41.968+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","ecs":{"version":"1.0.1"},"host":{"name":"25805977eece"}}},{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"-5j8fnMBfrYj4vM9efoG","_score":5.50935,"_source":{"@timestamp":"2020-07-24T04:02:17.266Z","stream":"stdout","container":{"name":"kkm-commutator_service.1.la3yz63wepu5zi890sitccied","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"b29b9e0a968b9ae2c134fa4060a78acf0f9676ca149c24cce79feea01424eff6"},"docker":{"container":{"labels":{"com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","com_docker_swarm_task_id":"la3yz63wepu5zi890sitccied","Description":"KKM Commutator Service","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_name":"kkm-commutator_service.1.la3yz63wepu5zi890sitccied","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","Version":"97"}}},"ecs":{"version":"1.0.1"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"log":{"offset":774751,"file":{"path":"/var/lib/docker/containers/b29b9e0a968b9ae2c134fa4060a78acf0f9676ca149c24cce79feea01424eff6/b29b9e0a968b9ae2c134fa4060a78acf0f9676ca149c24cce79feea01424eff6-json.log"}},"message":"{\"ts\":\"2020-07-24T04:02:17.266+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","input":{"type":"container"},"host":{"name":"25805977eece"}}},{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"GJoAf3MBfrYj4vM941xh","_score":5.50935,"_source":{"@timestamp":"2020-07-24T04:07:06.471Z","ecs":{"version":"1.0.1"},"host":{"name":"25805977eece"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"message":"{\"ts\":\"2020-07-24T04:07:06.471+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","log":{"offset":774748,"file":{"path":"/var/lib/docker/containers/14db796fc0ebe5f229c572d061248713b2c0933a2584bc427b3efbf02090b8ea/14db796fc0ebe5f229c572d061248713b2c0933a2584bc427b3efbf02090b8ea-json.log"}},"stream":"stdout","container":{"id":"14db796fc0ebe5f229c572d061248713b2c0933a2584bc427b3efbf02090b8ea","name":"kkm-commutator_service.1.5ab7hm5uettvefpahnh7oqnwr","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_name":"kkm-commutator_service","Description":"KKM Commutator Service","com_docker_swarm_task_name":"kkm-commutator_service.1.5ab7hm5uettvefpahnh7oqnwr","com_docker_swarm_task_id":"5ab7hm5uettvefpahnh7oqnwr","Version":"97","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":""}}}}},{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"HZoDf3MBfrYj4vM9GNjS","_score":5.50935,"_source":{"@timestamp":"2020-07-24T04:09:31.943Z","message":"{\"ts\":\"2020-07-24T04:09:31.942+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","input":{"type":"container"},"container":{"name":"kkm-commutator_service.1.rsbhpo3kr9y2xy2cwv2x95c8v","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5"},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_id":"rsbhpo3kr9y2xy2cwv2x95c8v","com_docker_swarm_task_name":"kkm-commutator_service.1.rsbhpo3kr9y2xy2cwv2x95c8v","Version":"97","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd"}}},"host":{"name":"25805977eece"},"stream":"stdout","ecs":{"version":"1.0.1"},"agent":{"type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1"},"log":{"file":{"path":"/var/lib/docker/containers/696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5/696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5-json.log"},"offset":774747}}},{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"N24ifnMBfrYj4vM9fdVq","_score":3.7836888,"_source":{"@timestamp":"2020-07-24T00:04:09.050Z","input":{"type":"container"},"container":{"id":"8acdbd0e1f6da341879ba61aee84362cfeb386a81e0889176ea90009cea717a3","name":"kkm-commutator_service.1.eqt37is64rgqgyp486kpbqida","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","Description":"KKM Commutator Service","Version":"97","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_task_id":"eqt37is64rgqgyp486kpbqida","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.eqt37is64rgqgyp486kpbqida"}}},"ecs":{"version":"1.0.1"},"agent":{"hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792"},"message":"{\"ts\":\"2020-07-24T00:04:09.050+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"e10f9e688e02e50d\",\"spanId\":\"e10f9e688e02e50d\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"e10f9e688e02e50d\",\"X-B3-TraceId\":\"e10f9e688e02e50d\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","log":{"file":{"path":"/var/lib/docker/containers/8acdbd0e1f6da341879ba61aee84362cfeb386a81e0889176ea90009cea717a3/8acdbd0e1f6da341879ba61aee84362cfeb386a81e0889176ea90009cea717a3-json.log"},"offset":583459},"stream":"stdout","host":{"name":"25805977eece"}}}]}}
902621 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = '0067'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = '0067'
902649 [main] INFO  kkm.UnitTests - End test

902650 [main] INFO  kkm.UnitTests - Starting test: KKM_DB8()
902769 [main] INFO  kkm.UnitTests - Script is: Insert into FiscalCheck(SystemCode,EntityCode,srcID,CorrelationID,Date,OrganizationInn, FilialCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-1gAUvtJSrPOR', '1853064887', '2019-07-12 00:00:00.000', '7710026574', 'NOFILIAL');

Insert into Customer(SystemCode,EntityCode,srcID, FullName,INN, Phone)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-1gAUvtJSrPOR','Фамилия Имя Отчество', '7710026574', '71000000000' );

Insert into Payment(SystemCode,EntityCode,srcID,Amount,PaymentTypeCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-1gAUvtJSrPOR', '1522756', 'INCOME');

Insert into Position(SystemCode,EntityCode,srcID,"Number",Name,Price,Quantity,TaxCode)
values( 'ADINSURE', 'Payment', '9SD0C9DZ-9289-4A09-1gAUvtJSrPOR', '123456', 'Страховая премия № 100000000', '1234', '1234', 'VAT20');

insert into ProcessStatus(SystemCode, EntityCode, srcID, fiscGateCorrelationID)
select top 1 f.SystemCode, f.EntityCode, f.srcID, CorrelationID
from FiscalCheck as f left join ProcessStatus as p on p.SystemCode = f.SystemCode and p.EntityCode = f.EntityCode and p.srcID = f.srcID
where p.EntityCode is null and f.srcID = '9SD0C9DZ-9289-4A09-1gAUvtJSrPOR'

update alertPeriod set finishTime = '00:00:00' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '00:00:00' where FilialCode = 'NOFILIAL'
update fiscalCheck set filialCode = 'NOFILIAL' where srcId = '9SD0C9DZ-9289-4A09-1gAUvtJSrPOR'
update processStatus set fiscGateCheckStatusCode = null where srcId = '9SD0C9DZ-9289-4A09-1gAUvtJSrPOR'
select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-1gAUvtJSrPOR'
1013663 [main] INFO  kkm.UnitTests - select * from processStatus where srcID = '9SD0C9DZ-9289-4A09-1gAUvtJSrPOR'
1013664 [main] INFO  kkm.UnitTests - Table String info is: [ADINSURE, Payment, null, null, null, 9SD0C9DZ-9289-4A09-1gAUvtJSrPOR, null]
1013669 [main] INFO  kkm.UnitTests - Status: null
1013669 [main] INFO  kkm.UnitTests - fiscGateErrorCode: null
1013669 [main] INFO  kkm.UnitTests - fiscGateErrorMessage: null
1033672 [main] INFO  kkm.UnitTests - URL is : http://elog.vsk.ru:9200/kkm-commutator-stage-2020.07.24/_search?q=%20message:%20%22ReadyForSendingReceiptKeys%22%20&size=5
1033730 [main] INFO  kkm.UnitTests - Response message : {"took":2,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":760,"relation":"eq"},"max_score":5.507403,"hits":[{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"dpn-fnMBfrYj4vM9rllb","_score":5.507403,"_source":{"@timestamp":"2020-07-24T04:04:41.968Z","stream":"stdout","log":{"offset":774733,"file":{"path":"/var/lib/docker/containers/e18f19a7cd33e89c860e1b31f01e648f7fdd65d6fb2c9c5dfe19bfdc4d76b28b/e18f19a7cd33e89c860e1b31f01e648f7fdd65d6fb2c9c5dfe19bfdc4d76b28b-json.log"}},"input":{"type":"container"},"container":{"id":"e18f19a7cd33e89c860e1b31f01e648f7fdd65d6fb2c9c5dfe19bfdc4d76b28b","name":"kkm-commutator_service.1.oblpq9bam4o7ngzg5rjg15phn","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_task_name":"kkm-commutator_service.1.oblpq9bam4o7ngzg5rjg15phn","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_task_id":"oblpq9bam4o7ngzg5rjg15phn","Description":"KKM Commutator Service","Version":"97","com_docker_swarm_task":"","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_stack_namespace":"kkm-commutator"}}},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"message":"{\"ts\":\"2020-07-24T04:04:41.968+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","ecs":{"version":"1.0.1"},"host":{"name":"25805977eece"}}},{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"-5j8fnMBfrYj4vM9efoG","_score":5.507403,"_source":{"@timestamp":"2020-07-24T04:02:17.266Z","stream":"stdout","container":{"name":"kkm-commutator_service.1.la3yz63wepu5zi890sitccied","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"b29b9e0a968b9ae2c134fa4060a78acf0f9676ca149c24cce79feea01424eff6"},"docker":{"container":{"labels":{"com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","com_docker_swarm_task_id":"la3yz63wepu5zi890sitccied","Description":"KKM Commutator Service","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task_name":"kkm-commutator_service.1.la3yz63wepu5zi890sitccied","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","Version":"97"}}},"ecs":{"version":"1.0.1"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"log":{"offset":774751,"file":{"path":"/var/lib/docker/containers/b29b9e0a968b9ae2c134fa4060a78acf0f9676ca149c24cce79feea01424eff6/b29b9e0a968b9ae2c134fa4060a78acf0f9676ca149c24cce79feea01424eff6-json.log"}},"message":"{\"ts\":\"2020-07-24T04:02:17.266+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","input":{"type":"container"},"host":{"name":"25805977eece"}}},{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"GJoAf3MBfrYj4vM941xh","_score":5.507403,"_source":{"@timestamp":"2020-07-24T04:07:06.471Z","ecs":{"version":"1.0.1"},"host":{"name":"25805977eece"},"agent":{"ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat"},"message":"{\"ts\":\"2020-07-24T04:07:06.471+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","log":{"offset":774748,"file":{"path":"/var/lib/docker/containers/14db796fc0ebe5f229c572d061248713b2c0933a2584bc427b3efbf02090b8ea/14db796fc0ebe5f229c572d061248713b2c0933a2584bc427b3efbf02090b8ea-json.log"}},"stream":"stdout","container":{"id":"14db796fc0ebe5f229c572d061248713b2c0933a2584bc427b3efbf02090b8ea","name":"kkm-commutator_service.1.5ab7hm5uettvefpahnh7oqnwr","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"input":{"type":"container"},"docker":{"container":{"labels":{"com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_service_name":"kkm-commutator_service","Description":"KKM Commutator Service","com_docker_swarm_task_name":"kkm-commutator_service.1.5ab7hm5uettvefpahnh7oqnwr","com_docker_swarm_task_id":"5ab7hm5uettvefpahnh7oqnwr","Version":"97","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":""}}}}},{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"HZoDf3MBfrYj4vM9GNjS","_score":5.507403,"_source":{"@timestamp":"2020-07-24T04:09:31.943Z","message":"{\"ts\":\"2020-07-24T04:09:31.942+00:00\",\"logger\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"level\":\"DEBUG\",\"class\":\"springfox.documentation.spring.web.plugins.DefaultRequestHandlerCombiner\",\"method\":\"combine\",\"caller_file_name\":\"DefaultRequestHandlerCombiner.java\",\"caller_line_number\":52,\"thread\":\"main\",\"msg\":\"Adding key: [/ReadyForSendingReceiptKeys], WebMvcRequestHandler{key=RequestHandlerKey{pathMappings=[/ReadyForSendingReceiptKeys], supportedMethods=[GET], supportedMediaTypes=[], producibleMediaTypes=[]}}\"}","input":{"type":"container"},"container":{"name":"kkm-commutator_service.1.rsbhpo3kr9y2xy2cwv2x95c8v","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"},"id":"696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5"},"docker":{"container":{"labels":{"Description":"KKM Commutator Service","com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","com_docker_swarm_task":"","com_docker_swarm_task_id":"rsbhpo3kr9y2xy2cwv2x95c8v","com_docker_swarm_task_name":"kkm-commutator_service.1.rsbhpo3kr9y2xy2cwv2x95c8v","Version":"97","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd"}}},"host":{"name":"25805977eece"},"stream":"stdout","ecs":{"version":"1.0.1"},"agent":{"type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792","hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1"},"log":{"file":{"path":"/var/lib/docker/containers/696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5/696decc37adac746af7423b1d52ab3ff74d5b769a00508f73851e84f69a9fbd5-json.log"},"offset":774747}}},{"_index":"kkm-commutator-stage-2020.07.24","_type":"_doc","_id":"N24ifnMBfrYj4vM9fdVq","_score":3.7824874,"_source":{"@timestamp":"2020-07-24T00:04:09.050Z","input":{"type":"container"},"container":{"id":"8acdbd0e1f6da341879ba61aee84362cfeb386a81e0889176ea90009cea717a3","name":"kkm-commutator_service.1.eqt37is64rgqgyp486kpbqida","image":{"name":"nexus.vsk.ru:8183/vsk/kkm-commutator:97@sha256:d7fe200be876de577493ecaf034656903ed1743d311447433a9e080df2bf87fe"}},"docker":{"container":{"labels":{"com_docker_swarm_service_id":"vzf1p3l7jfjimzgsk4k4shq6n","com_docker_swarm_service_name":"kkm-commutator_service","Description":"KKM Commutator Service","Version":"97","com_docker_swarm_node_id":"ygqa2daq7eosrz5hy95q8qotd","com_docker_swarm_task_id":"eqt37is64rgqgyp486kpbqida","com_docker_stack_namespace":"kkm-commutator","com_docker_swarm_task":"","com_docker_swarm_task_name":"kkm-commutator_service.1.eqt37is64rgqgyp486kpbqida"}}},"ecs":{"version":"1.0.1"},"agent":{"hostname":"25805977eece","id":"b42b3136-a942-47e4-a9fc-eaddc4fbe876","version":"7.3.1","type":"filebeat","ephemeral_id":"d557a4cf-a231-4f25-a77d-53dd56bac792"},"message":"{\"ts\":\"2020-07-24T00:04:09.050+00:00\",\"logger\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"level\":\"INFO\",\"class\":\"ru.vsk.integration.kkmcommutator.KkmCommutatorService\",\"method\":\"getReadyForSendingReceiptKeys\",\"caller_file_name\":\"KkmCommutatorService.java\",\"caller_line_number\":82,\"thread\":\"scheduling-1\",\"traceId\":\"e10f9e688e02e50d\",\"spanId\":\"e10f9e688e02e50d\",\"spanExportable\":\"true\",\"X-Span-Export\":\"true\",\"X-B3-SpanId\":\"e10f9e688e02e50d\",\"X-B3-TraceId\":\"e10f9e688e02e50d\",\"msg\":\"ReadyForSendingReceiptKeys is EMPTY\"}","log":{"file":{"path":"/var/lib/docker/containers/8acdbd0e1f6da341879ba61aee84362cfeb386a81e0889176ea90009cea717a3/8acdbd0e1f6da341879ba61aee84362cfeb386a81e0889176ea90009cea717a3-json.log"},"offset":583459},"stream":"stdout","host":{"name":"25805977eece"}}}]}}
1033859 [main] INFO  kkm.UnitTests - Script is: update alertPeriod set finishTime = '--18:59:59--' where FilialCode = 'NOFILIAL'
update alertPeriod set startTime = '--09:00:00--' where FilialCode = 'NOFILIAL'
1033883 [main] INFO  kkm.UnitTests - End test

